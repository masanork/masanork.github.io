<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 600">
  <defs>
    <style>
      .box { fill: #fff; stroke: #333; stroke-width: 2; }
      .layer { fill: #f0f4f8; stroke: #8da2fb; stroke-width: 2; rx: 8; }
      .layer-label { font-family: sans-serif; font-weight: bold; font-size: 14px; fill: #555; }
      .item { fill: #fff; stroke: #ccc; stroke-width: 1; rx: 4; }
      .item-label { font-family: sans-serif; font-size: 12px; fill: #333; }
      .arrow { stroke: #e65100; stroke-width: 2; marker-end: url(#arrowhead); }
      .hash-arrow { stroke: #4caf50; stroke-width: 2; stroke-dasharray: 4; marker-end: url(#arrowhead-green); }
      .sig-box { fill: #fff3e0; stroke: #ff9800; stroke-width: 2; rx: 4; }
      .blob-box { fill: #e8f5e9; stroke: #4caf50; stroke-width: 1; rx: 4; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#e65100" />
    </marker>
    <marker id="arrowhead-green" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#4caf50" />
    </marker>
  </defs>

  <!-- HTML Container (Layer 4) -->
  <rect x="20" y="20" width="760" height="560" class="box" stroke-dasharray="5,5" />
  <text x="40" y="45" class="layer-label" font-size="16">Web/A HTML Container (.html)</text>

  <!-- Layer 4: Presentation -->
  <g transform="translate(40, 70)">
    <rect x="0" y="0" width="720" height="120" class="layer" stroke="#ffcc80" />
    <text x="10" y="25" class="layer-label">Layer 4: Presentation (Ephemeral)</text>
    
    <rect x="20" y="40" width="200" height="60" class="item" />
    <text x="30" y="65" class="item-label">HTML / CSS / JS</text>
    <text x="30" y="85" class="item-label" fill="#888">(UI & Logic)</text>

    <!-- Manifest Manager -->
    <g transform="translate(240, 40)">
      <rect x="0" y="0" width="460" height="60" class="blob-box" />
      <text x="10" y="20" class="item-label" font-weight="bold">ManifestManager (Blobs)</text>
      <text x="10" y="40" class="item-label" font-size="10">Fonts, Images, JSON, WASM (Gzipped/Base64)</text>
      <!-- Blobs -->
      <rect x="280" y="10" width="40" height="40" fill="#c8e6c9" stroke="none" rx="2" />
      <text x="285" y="35" font-size="10">.ttf</text>
      <rect x="330" y="10" width="40" height="40" fill="#c8e6c9" stroke="none" rx="2" />
      <text x="335" y="35" font-size="10">.json</text>
      <rect x="380" y="10" width="40" height="40" fill="#c8e6c9" stroke="none" rx="2" />
      <text x="385" y="35" font-size="10">.wasm</text>
    </g>
  </g>

  <!-- Layer 3: Context -->
  <g transform="translate(40, 210)">
    <rect x="0" y="0" width="720" height="130" class="layer" stroke="#ce93d8" />
    <text x="10" y="25" class="layer-label">Layer 3: Context (Audit Trail)</text>

    <!-- PHC -->
    <g transform="translate(20, 40)">
      <rect x="0" y="0" width="380" height="70" class="item" />
      <text x="10" y="20" class="item-label" font-weight="bold">Prunable Hash Chain (PHC)</text>
      <text x="10" y="40" class="item-label" font-size="10">&lt;script id="weba-context-chain"&gt;</text>
      
      <!-- Chain Links -->
      <g transform="translate(150, 15)">
         <rect x="0" y="0" width="40" height="40" fill="#e1bee7" stroke="#333" rx="2" />
         <text x="5" y="25" font-size="10">Gen</text>
         <path d="M45,20 L65,20" stroke="#666" marker-end="url(#arrowhead)" />
         
         <rect x="70" y="0" width="40" height="40" fill="#f3e5f5" stroke="#999" stroke-dasharray="2,2" rx="2" />
         <text x="75" y="25" font-size="10" fill="#999">Pruned</text>
         <path d="M115,20 L135,20" stroke="#666" marker-end="url(#arrowhead)" />

         <rect x="140" y="0" width="40" height="40" fill="#e1bee7" stroke="#333" rx="2" />
         <text x="145" y="25" font-size="10">Latest</text>
      </g>
    </g>

    <!-- Trust Store -->
    <g transform="translate(420, 40)">
      <rect x="0" y="0" width="280" height="70" class="item" />
      <text x="10" y="20" class="item-label" font-weight="bold">Trust Store (Offline)</text>
      <text x="10" y="40" class="item-label" font-size="10">&lt;script id="weba-trust-store"&gt;</text>
      <text x="10" y="60" class="item-label" font-size="10">DID Docs, CRLs, Timestamps</text>
    </g>
  </g>

  <!-- Layer 2: Payload -->
  <g transform="translate(40, 360)">
    <rect x="0" y="0" width="400" height="100" class="layer" stroke="#90caf9" />
    <text x="10" y="25" class="layer-label">Layer 2: Payload (Immutable Fact)</text>

    <rect x="20" y="40" width="360" height="40" class="sig-box" />
    <text x="30" y="65" class="item-label">Verified Credential (Content Signature)</text>
  </g>

  <!-- Layer 4 Signature (Footer) -->
  <g transform="translate(480, 400)">
    <rect x="0" y="0" width="280" height="60" class="sig-box" stroke="#d32f2f" fill="#ffebee" />
    <text x="10" y="25" class="item-label" font-weight="bold">Layer 4: Container Signature</text>
    <text x="10" y="45" class="item-label" font-size="10">Signs Hash(Full HTML)</text>
  </g>

  <!-- Relationships -->
  <!-- L4 Sig signs the whole HTML -->
  <path d="M620,400 L620,380 L780,380 L780,50 L760,50" class="hash-arrow" fill="none" />
  
  <!-- PHC Genesis points to L2 -->
  <path d="M210,270 L210,360" class="hash-arrow" stroke-dasharray="2,2" />
  <text x="215" y="320" font-size="10" fill="#4caf50">Genesis Hash</text>

  <!-- Manifest points to Blobs (internal logic) -->
  
</svg>
