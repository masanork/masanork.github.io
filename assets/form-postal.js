var I=["北海道","青森県","岩手県","宮城県","秋田県","山形県","福島県","茨城県","栃木県","群馬県","埼玉県","千葉県","東京都","神奈川県","新潟県","富山県","石川県","福井県","山梨県","長野県","岐阜県","静岡県","愛知県","三重県","滋賀県","京都府","大阪府","兵庫県","奈良県","和歌山県","鳥取県","島根県","岡山県","広島県","山口県","徳島県","香川県","愛媛県","高知県","福岡県","佐賀県","長崎県","熊本県","大分県","宮崎県","鹿児島県","沖縄県"];class K{data={};initialized=!1;async loadFromBase64(B){try{let h=atob(B),q=new Uint8Array(h.length);for(let v=0;v<h.length;v++)q[v]=h.charCodeAt(v);let G;if(q[0]===31&&q[1]===139)if(typeof DecompressionStream!=="undefined"){let v=new DecompressionStream("gzip"),A=new Blob([q]).stream().pipeThrough(v);G=await new Response(A).text()}else throw new Error("DecompressionStream not supported");else G=new TextDecoder().decode(q);this.data=JSON.parse(G),this.initialized=!0,console.log("\uD83D\uDCEE Postal lookup initialized:",Object.keys(this.data).length,"prefixes")}catch(h){console.error("Failed to load postal data:",h)}}async autoInit(){let B=document.getElementById("weba-postal-data");if(B&&B.textContent)await this.loadFromBase64(B.textContent.trim());else console.warn("No postal data found in document")}lookup(B){if(!this.initialized)return null;let h=B.replace(/[^0-9]/g,"");if(h.length!==7)return null;let q=h.substring(0,3),G=h.substring(3),v=this.data[q];if(!v)return null;let A=v.t.find(([H])=>H===G);if(!A)return null;return{zip:h,pref:I[v.p-1],city:A[1],town:A[2]}}suggest(B,h=50){if(!this.initialized)return[];let q=B.replace(/[^0-9]/g,"");if(q.length<3)return[];let G=q.substring(0,3),v=q.substring(3),A=[],H=this.data[G];if(H){for(let[J,M,N]of H.t)if(!v||J.startsWith(v)){if(A.push({zip:G+J,pref:I[H.p-1],city:M,town:N}),A.length>=h)return A}}return A}getPrefixCandidates(B){if(!this.initialized)return[];let h=B.replace(/[^0-9]/g,"");if(h.length!==3)return[];let q=this.data[h];if(!q)return[];return q.t.map(([G,v,A])=>({zip:h+G,pref:I[q.p-1],city:v,town:A}))}isReady(){return this.initialized}}var O=new K;export{O as postalLookup,K as PostalLookup};
