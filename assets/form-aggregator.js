var bX=Object.create;var{getPrototypeOf:gX,defineProperty:o8,getOwnPropertyNames:yX}=Object;var hX=Object.prototype.hasOwnProperty;var C8=($,Z,X)=>{X=$!=null?bX(gX($)):{};let J=Z||!$||!$.__esModule?o8(X,"default",{value:$,enumerable:!0}):X;for(let q of yX($))if(!hX.call(J,q))o8(J,q,{get:()=>$[q],enumerable:!0});return J};var mX=($,Z)=>()=>(Z||$((Z={exports:{}}).exports,Z),Z.exports);var n4=($,Z)=>{for(var X in Z)o8($,X,{get:Z[X],enumerable:!0,configurable:!0,set:(J)=>Z[X]=()=>J})};var i8=($,Z)=>()=>($&&(Z=$($=0)),Z);var uX=(($)=>typeof require!=="undefined"?require:typeof Proxy!=="undefined"?new Proxy($,{get:(Z,X)=>(typeof require!=="undefined"?require:Z)[X]}):$)(function($){if(typeof require!=="undefined")return require.apply(this,arguments);throw Error('Dynamic require of "'+$+'" is not supported')});var N8=mX((YQ,$$)=>{$$.exports=function $(Z){if(typeof Z==="number"&&isNaN(Z))throw new Error("NaN is not allowed");if(typeof Z==="number"&&!isFinite(Z))throw new Error("Infinity is not allowed");if(Z===null||typeof Z!=="object")return JSON.stringify(Z);if(Z.toJSON instanceof Function)return $(Z.toJSON());if(Array.isArray(Z))return`[${Z.reduce((q,G,Q)=>{return`${q}${Q===0?"":","}${$(G===void 0||typeof G==="symbol"?null:G)}`},"")}]`;return`{${Object.keys(Z).sort().reduce((J,q)=>{if(Z[q]===void 0||typeof Z[q]==="symbol")return J;let G=J.length===0?"":",";return`${J}${G}${$(q)}:${$(Z[q])}`},"")}}`}});function $8($){let Z=R.__externref_table_alloc();return R.__wbindgen_externrefs.set(Z,$),Z}function X0($,Z){return $=$>>>0,p0().subarray($/1,$/1+Z)}function u0($,Z){return $=$>>>0,nX($,Z)}function p0(){if(Z8===null||Z8.byteLength===0)Z8=new Uint8Array(R.memory.buffer);return Z8}function e0($,Z){try{return $.apply(this,Z)}catch(X){let J=$8(X);R.__wbindgen_exn_store(J)}}function X8($){return $===void 0||$===null}function h($,Z){let X=Z($.length*1,1)>>>0;return p0().set($,X/1),y=$.length,X}function J8($,Z,X){if(X===void 0){let Y=q8.encode($),U=Z(Y.length,1)>>>0;return p0().subarray(U,U+Y.length).set(Y),y=Y.length,U}let J=$.length,q=Z(J,1)>>>0,G=p0(),Q=0;for(;Q<J;Q++){let Y=$.charCodeAt(Q);if(Y>127)break;G[q+Q]=Y}if(Q!==J){if(Q!==0)$=$.slice(Q);q=X(q,J,J=Q+$.length*3,1)>>>0;let Y=p0().subarray(q+Q,q+J),U=q8.encodeInto($,Y);Q+=U.written,q=X(q,J,Q,1)>>>0}return y=Q,q}function t($){let Z=R.__wbindgen_externrefs.get($);return R.__externref_table_dealloc($),Z}function nX($,Z){if(r8+=Z,r8>=cX)R8=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}),R8.decode(),r8=Z;return R8.decode(p0().subarray($,$+Z))}function Z$($,Z,X,J){let q=h($,R.__wbindgen_malloc),G=y,Q=h(Z,R.__wbindgen_malloc),Y=y,U=h(X,R.__wbindgen_malloc),z=y,H=h(J,R.__wbindgen_malloc),F=y,V=R.aes_gcm_decrypt(q,G,Q,Y,U,z,H,F);if(V[3])throw t(V[2]);var D=X0(V[0],V[1]).slice();return R.__wbindgen_free(V[0],V[1]*1,1),D}function X$($,Z,X,J){let q=h($,R.__wbindgen_malloc),G=y,Q=h(Z,R.__wbindgen_malloc),Y=y,U=h(X,R.__wbindgen_malloc),z=y,H=h(J,R.__wbindgen_malloc),F=y,V=R.aes_gcm_encrypt(q,G,Q,Y,U,z,H,F);if(V[3])throw t(V[2]);var D=X0(V[0],V[1]).slice();return R.__wbindgen_free(V[0],V[1]*1,1),D}function J$($,Z,X,J,q){let G,Q;try{let z=J8($,R.__wbindgen_malloc,R.__wbindgen_realloc),H=y,F=h(Z,R.__wbindgen_malloc),V=y,D=J8(X,R.__wbindgen_malloc,R.__wbindgen_realloc),P=y,A=J8(J,R.__wbindgen_malloc,R.__wbindgen_realloc),N=y,S=J8(q,R.__wbindgen_malloc,R.__wbindgen_realloc),f=y,x=R.build_l2_envelope_wasm(z,H,F,V,D,P,A,N,S,f);var Y=x[0],U=x[1];if(x[3])throw Y=0,U=0,t(x[2]);return G=Y,Q=U,u0(Y,U)}finally{R.__wbindgen_free(G,Q,1)}}function q$($,Z){let X=h($,R.__wbindgen_malloc),J=y,q=h(Z,R.__wbindgen_malloc),G=y;return R.constant_time_equal(X,J,q,G)!==0}function Q$($,Z,X){let J,q;try{let z=J8($,R.__wbindgen_malloc,R.__wbindgen_realloc),H=y,F=h(Z,R.__wbindgen_malloc),V=y;var G=X8(X)?0:h(X,R.__wbindgen_malloc),Q=y;let D=R.decrypt_l2_envelope_wasm(z,H,F,V,G,Q);var Y=D[0],U=D[1];if(D[3])throw Y=0,U=0,t(D[2]);return J=Y,q=U,u0(Y,U)}finally{R.__wbindgen_free(J,q,1)}}function G$(){let $=R.ed25519_generate_keypair();if($[3])throw t($[2]);var Z=X0($[0],$[1]).slice();return R.__wbindgen_free($[0],$[1]*1,1),Z}function Y$($){let Z=h($,R.__wbindgen_malloc),X=y,J=R.ed25519_public_key_to_x25519_public_key(Z,X);if(J[3])throw t(J[2]);var q=X0(J[0],J[1]).slice();return R.__wbindgen_free(J[0],J[1]*1,1),q}function U$($,Z){let X=h($,R.__wbindgen_malloc),J=y,q=h(Z,R.__wbindgen_malloc),G=y,Q=R.ed25519_sign(X,J,q,G);if(Q[3])throw t(Q[2]);var Y=X0(Q[0],Q[1]).slice();return R.__wbindgen_free(Q[0],Q[1]*1,1),Y}function z$($,Z,X){let J=h($,R.__wbindgen_malloc),q=y,G=h(Z,R.__wbindgen_malloc),Q=y,Y=h(X,R.__wbindgen_malloc),U=y,z=R.ed25519_verify(J,q,G,Q,Y,U);if(z[2])throw t(z[1]);return z[0]!==0}function F$($){return R.get_padding_target_size($)>>>0}function s8(){let $,Z;try{let X=R.get_version();return $=X[0],Z=X[1],u0(X[0],X[1])}finally{R.__wbindgen_free($,Z,1)}}function H$($,Z,X,J){let q=h($,R.__wbindgen_malloc),G=y,Q=h(Z,R.__wbindgen_malloc),Y=y,U=h(X,R.__wbindgen_malloc),z=y,H=R.hkdf_sha256_wasm(q,G,Q,Y,U,z,J);if(H[3])throw t(H[2]);var F=X0(H[0],H[1]).slice();return R.__wbindgen_free(H[0],H[1]*1,1),F}function B$(){let $=R.ml_dsa_44_generate_keypair();if($[3])throw t($[2]);var Z=X0($[0],$[1]).slice();return R.__wbindgen_free($[0],$[1]*1,1),Z}function K$($,Z){let X=h($,R.__wbindgen_malloc),J=y,q=h(Z,R.__wbindgen_malloc),G=y,Q=R.ml_dsa_44_sign(X,J,q,G);if(Q[3])throw t(Q[2]);var Y=X0(Q[0],Q[1]).slice();return R.__wbindgen_free(Q[0],Q[1]*1,1),Y}function V$($,Z,X){let J=h($,R.__wbindgen_malloc),q=y,G=h(Z,R.__wbindgen_malloc),Q=y,Y=h(X,R.__wbindgen_malloc),U=y,z=R.ml_dsa_44_verify(J,q,G,Q,Y,U);if(z[2])throw t(z[1]);return z[0]!==0}function W$($,Z){let X=h($,R.__wbindgen_malloc),J=y,q=h(Z,R.__wbindgen_malloc),G=y,Q=R.ml_kem_768_decapsulate(X,J,q,G);if(Q[3])throw t(Q[2]);var Y=X0(Q[0],Q[1]).slice();return R.__wbindgen_free(Q[0],Q[1]*1,1),Y}function D$($){let Z=h($,R.__wbindgen_malloc),X=y,J=R.ml_kem_768_encapsulate(Z,X);if(J[3])throw t(J[2]);var q=X0(J[0],J[1]).slice();return R.__wbindgen_free(J[0],J[1]*1,1),q}function O$(){let $=R.ml_kem_768_generate_keypair();if($[3])throw t($[2]);var Z=X0($[0],$[1]).slice();return R.__wbindgen_free($[0],$[1]*1,1),Z}function M$(){let $=R.p256_generate_keypair();if($[3])throw t($[2]);var Z=X0($[0],$[1]).slice();return R.__wbindgen_free($[0],$[1]*1,1),Z}function P$($,Z){let X=h($,R.__wbindgen_malloc),J=y,q=h(Z,R.__wbindgen_malloc),G=y,Q=R.p256_sign(X,J,q,G);if(Q[3])throw t(Q[2]);var Y=X0(Q[0],Q[1]).slice();return R.__wbindgen_free(Q[0],Q[1]*1,1),Y}function C$($,Z,X){let J=h($,R.__wbindgen_malloc),q=y,G=h(Z,R.__wbindgen_malloc),Q=y,Y=h(X,R.__wbindgen_malloc),U=y,z=R.p256_verify(J,q,G,Q,Y,U);if(z[2])throw t(z[1]);return z[0]!==0}function N$($){let Z=h($,R.__wbindgen_malloc),X=y,J=R.sha256_wasm(Z,X);var q=X0(J[0],J[1]).slice();return R.__wbindgen_free(J[0],J[1]*1,1),q}function R$(){let $=R.x25519_generate_keypair();if($[3])throw t($[2]);var Z=X0($[0],$[1]).slice();return R.__wbindgen_free($[0],$[1]*1,1),Z}function L$($){let Z=h($,R.__wbindgen_malloc),X=y,J=R.x25519_get_public_key(Z,X);if(J[3])throw t(J[2]);var q=X0(J[0],J[1]).slice();return R.__wbindgen_free(J[0],J[1]*1,1),q}function j$($,Z){let X=h($,R.__wbindgen_malloc),J=y,q=h(Z,R.__wbindgen_malloc),G=y,Q=R.x25519_get_shared_secret(X,J,q,G);if(Q[3])throw t(Q[2]);var Y=X0(Q[0],Q[1]).slice();return R.__wbindgen_free(Q[0],Q[1]*1,1),Y}async function iX($,Z){if(typeof Response==="function"&&$ instanceof Response){if(typeof WebAssembly.instantiateStreaming==="function")try{return await WebAssembly.instantiateStreaming($,Z)}catch(J){if($.ok&&oX.has($.type)&&$.headers.get("Content-Type")!=="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",J);else throw J}let X=await $.arrayBuffer();return await WebAssembly.instantiate(X,Z)}else{let X=await WebAssembly.instantiate($,Z);if(X instanceof WebAssembly.Instance)return{instance:X,module:$};else return X}}function rX(){let $={};return $.wbg={},$.wbg.__wbg___wbindgen_is_function_8d400b8b1af978cd=function(Z){return typeof Z==="function"},$.wbg.__wbg___wbindgen_is_object_ce774f3490692386=function(Z){let X=Z;return typeof X==="object"&&X!==null},$.wbg.__wbg___wbindgen_is_string_704ef9c8fc131030=function(Z){return typeof Z==="string"},$.wbg.__wbg___wbindgen_is_undefined_f6b95eab589e0269=function(Z){return Z===void 0},$.wbg.__wbg___wbindgen_throw_dd24417ed36fc46e=function(Z,X){throw new Error(u0(Z,X))},$.wbg.__wbg_call_3020136f7a2d6e44=function(){return e0(function(Z,X,J){return Z.call(X,J)},arguments)},$.wbg.__wbg_call_abb4ff46ce38be40=function(){return e0(function(Z,X){return Z.call(X)},arguments)},$.wbg.__wbg_crypto_574e78ad8b13b65f=function(Z){return Z.crypto},$.wbg.__wbg_getRandomValues_b8f5dbd5f3995a9e=function(){return e0(function(Z,X){Z.getRandomValues(X)},arguments)},$.wbg.__wbg_length_22ac23eaec9d8053=function(Z){return Z.length},$.wbg.__wbg_msCrypto_a61aeb35a24c1329=function(Z){return Z.msCrypto},$.wbg.__wbg_new_no_args_cb138f77cf6151ee=function(Z,X){return new Function(u0(Z,X))},$.wbg.__wbg_new_with_length_aa5eaf41d35235e5=function(Z){return new Uint8Array(Z>>>0)},$.wbg.__wbg_node_905d3e251edff8a2=function(Z){return Z.node},$.wbg.__wbg_process_dc0fbacc7c1c06f7=function(Z){return Z.process},$.wbg.__wbg_prototypesetcall_dfe9b766cdc1f1fd=function(Z,X,J){Uint8Array.prototype.set.call(X0(Z,X),J)},$.wbg.__wbg_randomFillSync_ac0988aba3254290=function(){return e0(function(Z,X){Z.randomFillSync(X)},arguments)},$.wbg.__wbg_require_60cc747a6bc5215a=function(){return e0(function(){return aX.require},arguments)},$.wbg.__wbg_static_accessor_GLOBAL_769e6b65d6557335=function(){let Z=typeof global==="undefined"?null:global;return X8(Z)?0:$8(Z)},$.wbg.__wbg_static_accessor_GLOBAL_THIS_60cf02db4de8e1c1=function(){let Z=typeof globalThis==="undefined"?null:globalThis;return X8(Z)?0:$8(Z)},$.wbg.__wbg_static_accessor_SELF_08f5a74c69739274=function(){let Z=typeof self==="undefined"?null:self;return X8(Z)?0:$8(Z)},$.wbg.__wbg_static_accessor_WINDOW_a8924b26aa92d024=function(){let Z=typeof window==="undefined"?null:window;return X8(Z)?0:$8(Z)},$.wbg.__wbg_subarray_845f2f5bce7d061a=function(Z,X,J){return Z.subarray(X>>>0,J>>>0)},$.wbg.__wbg_versions_c01dfd4722a88165=function(Z){return Z.versions},$.wbg.__wbindgen_cast_2241b6af4c4b2941=function(Z,X){return u0(Z,X)},$.wbg.__wbindgen_cast_cb9088102bce6b30=function(Z,X){return X0(Z,X)},$.wbg.__wbindgen_init_externref_table=function(){let Z=R.__wbindgen_externrefs,X=Z.grow(4);Z.set(0,void 0),Z.set(X+0,void 0),Z.set(X+1,null),Z.set(X+2,!0),Z.set(X+3,!1)},$}function sX($,Z){return R=$.exports,A$.__wbindgen_wasm_module=Z,Z8=null,R.__wbindgen_start(),R}async function A$($){if(R!==void 0)return R;if(typeof $!=="undefined")if(Object.getPrototypeOf($)===Object.prototype)({module_or_path:$}=$);else console.warn("using deprecated parameters for the initialization function; pass a single object instead");if(typeof $==="undefined")$=new URL("weba_crypto_wasm_bg.wasm",import.meta.url);let Z=rX();if(typeof $==="string"||typeof Request==="function"&&$ instanceof Request||typeof URL==="function"&&$ instanceof URL)$=fetch($);let{instance:X,module:J}=await iX(await $,Z);return sX(X,J)}var R,Z8=null,R8,cX=2146435072,r8=0,q8,y=0,oX,L8;var w$=i8(()=>{R8=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});R8.decode();q8=new TextEncoder;if(!("encodeInto"in q8))q8.encodeInto=function($,Z){let X=q8.encode($);return Z.set(X),{read:$.length,written:X.length}};oX=new Set(["basic","cors","default"]);L8=A$});var I$="";var v$={};n4(v$,{win32:()=>a8,toNamespacedPath:()=>WJ,sep:()=>NJ,resolve:()=>FJ,relative:()=>VJ,posix:()=>T0,parse:()=>CJ,normalize:()=>HJ,join:()=>KJ,isAbsolute:()=>BJ,format:()=>PJ,extname:()=>MJ,dirname:()=>DJ,delimiter:()=>RJ,default:()=>zJ,basename:()=>OJ});var eX,T$,$J,ZJ,XJ,JJ,qJ=($,Z)=>()=>(Z||$((Z={exports:{}}).exports,Z),Z.exports),QJ=($,Z,X,J)=>{if(Z&&typeof Z=="object"||typeof Z=="function")for(let q of ZJ(Z))!JJ.call($,q)&&q!==X&&T$($,q,{get:()=>Z[q],enumerable:!(J=$J(Z,q))||J.enumerable});return $},GJ=($,Z,X)=>(X=$!=null?eX(XJ($)):{},QJ(Z||!$||!$.__esModule?T$(X,"default",{value:$,enumerable:!0}):X,$)),YJ,x$,e,UJ,f$=function($){return $},E$=function(){throw new Error("Not implemented")},T0,a8,zJ,FJ,HJ,BJ,KJ,VJ,WJ,DJ,OJ,MJ,PJ,CJ,NJ,RJ;var S$=i8(()=>{eX=Object.create,T$=Object.defineProperty,$J=Object.getOwnPropertyDescriptor,ZJ=Object.getOwnPropertyNames,XJ=Object.getPrototypeOf,JJ=Object.prototype.hasOwnProperty,YJ=qJ(($,Z)=>{function X(Q){if(typeof Q!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(Q))}function J(Q,Y){for(var U="",z=0,H=-1,F=0,V,D=0;D<=Q.length;++D){if(D<Q.length)V=Q.charCodeAt(D);else{if(V===47)break;V=47}if(V===47){if(!(H===D-1||F===1))if(H!==D-1&&F===2){if(U.length<2||z!==2||U.charCodeAt(U.length-1)!==46||U.charCodeAt(U.length-2)!==46){if(U.length>2){var P=U.lastIndexOf("/");if(P!==U.length-1){P===-1?(U="",z=0):(U=U.slice(0,P),z=U.length-1-U.lastIndexOf("/")),H=D,F=0;continue}}else if(U.length===2||U.length===1){U="",z=0,H=D,F=0;continue}}Y&&(U.length>0?U+="/..":U="..",z=2)}else U.length>0?U+="/"+Q.slice(H+1,D):U=Q.slice(H+1,D),z=D-H-1;H=D,F=0}else V===46&&F!==-1?++F:F=-1}return U}function q(Q,Y){var U=Y.dir||Y.root,z=Y.base||(Y.name||"")+(Y.ext||"");return U?U===Y.root?U+z:U+Q+z:z}var G={resolve:function(){for(var Q="",Y=!1,U,z=arguments.length-1;z>=-1&&!Y;z--){var H;z>=0?H=arguments[z]:(U===void 0&&(U=process.cwd()),H=U),X(H),H.length!==0&&(Q=H+"/"+Q,Y=H.charCodeAt(0)===47)}return Q=J(Q,!Y),Y?Q.length>0?"/"+Q:"/":Q.length>0?Q:"."},normalize:function(Q){if(X(Q),Q.length===0)return".";var Y=Q.charCodeAt(0)===47,U=Q.charCodeAt(Q.length-1)===47;return Q=J(Q,!Y),Q.length===0&&!Y&&(Q="."),Q.length>0&&U&&(Q+="/"),Y?"/"+Q:Q},isAbsolute:function(Q){return X(Q),Q.length>0&&Q.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var Q,Y=0;Y<arguments.length;++Y){var U=arguments[Y];X(U),U.length>0&&(Q===void 0?Q=U:Q+="/"+U)}return Q===void 0?".":G.normalize(Q)},relative:function(Q,Y){if(X(Q),X(Y),Q===Y||(Q=G.resolve(Q),Y=G.resolve(Y),Q===Y))return"";for(var U=1;U<Q.length&&Q.charCodeAt(U)===47;++U);for(var z=Q.length,H=z-U,F=1;F<Y.length&&Y.charCodeAt(F)===47;++F);for(var V=Y.length,D=V-F,P=H<D?H:D,A=-1,N=0;N<=P;++N){if(N===P){if(D>P){if(Y.charCodeAt(F+N)===47)return Y.slice(F+N+1);if(N===0)return Y.slice(F+N)}else H>P&&(Q.charCodeAt(U+N)===47?A=N:N===0&&(A=0));break}var S=Q.charCodeAt(U+N),f=Y.charCodeAt(F+N);if(S!==f)break;S===47&&(A=N)}var x="";for(N=U+A+1;N<=z;++N)(N===z||Q.charCodeAt(N)===47)&&(x.length===0?x+="..":x+="/..");return x.length>0?x+Y.slice(F+A):(F+=A,Y.charCodeAt(F)===47&&++F,Y.slice(F))},_makeLong:function(Q){return Q},dirname:function(Q){if(X(Q),Q.length===0)return".";for(var Y=Q.charCodeAt(0),U=Y===47,z=-1,H=!0,F=Q.length-1;F>=1;--F)if(Y=Q.charCodeAt(F),Y===47){if(!H){z=F;break}}else H=!1;return z===-1?U?"/":".":U&&z===1?"//":Q.slice(0,z)},basename:function(Q,Y){if(Y!==void 0&&typeof Y!="string")throw new TypeError('"ext" argument must be a string');X(Q);var U=0,z=-1,H=!0,F;if(Y!==void 0&&Y.length>0&&Y.length<=Q.length){if(Y.length===Q.length&&Y===Q)return"";var V=Y.length-1,D=-1;for(F=Q.length-1;F>=0;--F){var P=Q.charCodeAt(F);if(P===47){if(!H){U=F+1;break}}else D===-1&&(H=!1,D=F+1),V>=0&&(P===Y.charCodeAt(V)?--V===-1&&(z=F):(V=-1,z=D))}return U===z?z=D:z===-1&&(z=Q.length),Q.slice(U,z)}else{for(F=Q.length-1;F>=0;--F)if(Q.charCodeAt(F)===47){if(!H){U=F+1;break}}else z===-1&&(H=!1,z=F+1);return z===-1?"":Q.slice(U,z)}},extname:function(Q){X(Q);for(var Y=-1,U=0,z=-1,H=!0,F=0,V=Q.length-1;V>=0;--V){var D=Q.charCodeAt(V);if(D===47){if(!H){U=V+1;break}continue}z===-1&&(H=!1,z=V+1),D===46?Y===-1?Y=V:F!==1&&(F=1):Y!==-1&&(F=-1)}return Y===-1||z===-1||F===0||F===1&&Y===z-1&&Y===U+1?"":Q.slice(Y,z)},format:function(Q){if(Q===null||typeof Q!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof Q);return q("/",Q)},parse:function(Q){X(Q);var Y={root:"",dir:"",base:"",ext:"",name:""};if(Q.length===0)return Y;var U=Q.charCodeAt(0),z=U===47,H;z?(Y.root="/",H=1):H=0;for(var F=-1,V=0,D=-1,P=!0,A=Q.length-1,N=0;A>=H;--A){if(U=Q.charCodeAt(A),U===47){if(!P){V=A+1;break}continue}D===-1&&(P=!1,D=A+1),U===46?F===-1?F=A:N!==1&&(N=1):F!==-1&&(N=-1)}return F===-1||D===-1||N===0||N===1&&F===D-1&&F===V+1?D!==-1&&(V===0&&z?Y.base=Y.name=Q.slice(1,D):Y.base=Y.name=Q.slice(V,D)):(V===0&&z?(Y.name=Q.slice(1,F),Y.base=Q.slice(1,D)):(Y.name=Q.slice(V,F),Y.base=Q.slice(V,D)),Y.ext=Q.slice(F,D)),V>0?Y.dir=Q.slice(0,V-1):z&&(Y.dir="/"),Y},sep:"/",delimiter:":",win32:null,posix:null};G.posix=G,Z.exports=G}),x$=GJ(YJ()),e=x$,UJ=x$;e.parse??=E$;UJ.parse??=E$;T0={resolve:e.resolve.bind(e),normalize:e.normalize.bind(e),isAbsolute:e.isAbsolute.bind(e),join:e.join.bind(e),relative:e.relative.bind(e),toNamespacedPath:f$,dirname:e.dirname.bind(e),basename:e.basename.bind(e),extname:e.extname.bind(e),format:e.format.bind(e),parse:e.parse.bind(e),sep:"/",delimiter:":",win32:void 0,posix:void 0,_makeLong:f$},a8={sep:"\\",delimiter:";",win32:void 0,...T0,posix:T0};T0.win32=a8.win32=a8;T0.posix=T0;zJ=T0,{resolve:FJ,normalize:HJ,isAbsolute:BJ,join:KJ,relative:VJ,toNamespacedPath:WJ,dirname:DJ,basename:OJ,extname:MJ,format:PJ,parse:CJ,sep:NJ,delimiter:RJ}=T0});var X4={};n4(X4,{x25519GetSharedSecret:()=>wJ,x25519GetPublicKey:()=>j8,x25519GenerateKeyPair:()=>t8,sha256Hash:()=>bJ,p256Verify:()=>TJ,p256Sign:()=>fJ,p256GenerateKeyPair:()=>IJ,mlKem768GenerateKeyPair:()=>xJ,mlKem768Encapsulate:()=>EJ,mlKem768Decapsulate:()=>vJ,mlDsa44Verify:()=>kJ,mlDsa44Sign:()=>_J,mlDsa44GenerateKeyPair:()=>SJ,initWasmFromB64:()=>Q8,initWasm:()=>P0,hkdfSha256:()=>C0,getPaddingTargetSize:()=>$4,ed25519Verify:()=>k$,ed25519Sign:()=>_$,ed25519PublicKeyToX25519PublicKey:()=>Z4,ed25519GenerateKeyPair:()=>e8,decryptL2Envelope:()=>G8,constantTimeEqual:()=>LJ,buildL2Envelope:()=>A8,aesGcmEncrypt:()=>jJ,aesGcmDecrypt:()=>AJ});async function P0($){if(n)return;if($)await L8($);else if(typeof window!=="undefined"&&window.__WEBA_MANIFEST){let X=window.__WEBA_MANIFEST.blobs?.find((J)=>J.id==="weba-crypto-wasm");if(X){let J=document.getElementById("weba-blob-"+X.digest.split(":")[1]);if(J){let q=atob(J.textContent.trim()),G=new Uint8Array(q.length);for(let Q=0;Q<q.length;Q++)G[Q]=q.charCodeAt(Q);await L8(G),n=!0,console.log(`WASM Crypto Initialized from Manifest: ${s8()}`);return}}await Q8()}else if(typeof process!=="undefined"&&process.versions&&process.versions.node){let Z=await import("node:fs"),J=(await Promise.resolve().then(() => (S$(),v$))).join(import.meta.dirname,"wasm_bindings/weba_crypto_wasm_bg.wasm"),q=Z.readFileSync(J);await L8(q)}else try{await Q8()}catch(Z){throw new Error("WASM source must be provided in browser environment")}if(n=!0,!n)console.log(`WASM Crypto Initialized: ${s8()}`)}async function Q8(){if(n)return;let $=atob(I$),Z=new Uint8Array($.length);for(let X=0;X<$.length;X++)Z[X]=$.charCodeAt(X);await P0(Z)}function LJ($,Z){if(!n)throw new Error("WASM not initialized");return q$($,Z)}function jJ($,Z,X,J){if(!n)throw new Error("WASM not initialized");return X$($,Z,X,J)}function AJ($,Z,X,J){if(!n)throw new Error("WASM not initialized");return Z$($,Z,X,J)}function t8(){if(!n)throw new Error("WASM not initialized");let $=R$();return{privateKey:$.slice(0,32),publicKey:$.slice(32,64)}}function j8($){if(!n)throw new Error("WASM not initialized");return L$($)}function wJ($,Z){if(!n)throw new Error("WASM not initialized");return j$($,Z)}function e8(){if(!n)throw new Error("WASM not initialized");let $=G$();return{privateKey:$.slice(0,32),publicKey:$.slice(32,64)}}function _$($,Z){if(!n)throw new Error("WASM not initialized");return U$($,Z)}function k$($,Z,X){if(!n)throw new Error("WASM not initialized");return z$($,Z,X)}function IJ(){if(!n)throw new Error("WASM not initialized");let $=M$();return{privateKey:$.slice(0,32),publicKey:$.slice(32,97)}}function fJ($,Z){if(!n)throw new Error("WASM not initialized");return P$($,Z)}function TJ($,Z,X){if(!n)throw new Error("WASM not initialized");return C$($,Z,X)}function xJ(){if(!n)throw new Error("WASM not initialized");let $=O$();return{privateKey:$.slice(0,2400),publicKey:$.slice(2400,3584)}}function EJ($){if(!n)throw new Error("WASM not initialized");let Z=D$($);return{sharedSecret:Z.slice(0,32),ciphertext:Z.slice(32,1120)}}function vJ($,Z){if(!n)throw new Error("WASM not initialized");return W$($,Z)}function SJ(){if(!n)throw new Error("WASM not initialized");let $=B$();return{privateKey:$.slice(0,2560),publicKey:$.slice(2560,3872)}}function _J($,Z){if(!n)throw new Error("WASM not initialized");return K$($,Z)}function kJ($,Z,X){if(!n)throw new Error("WASM not initialized");return V$($,Z,X)}function bJ($){if(!n)throw new Error("WASM not initialized");return N$($)}function C0($,Z,X,J){if(!n)throw new Error("WASM not initialized");return H$($,Z||new Uint8Array(0),X,J)}function $4($){if(!n)throw new Error("WASM not initialized");return F$($)}function A8($,Z,X,J,q){if(!n)throw new Error("WASM not initialized");return J$($,Z,X,J,q)}function G8($,Z,X){if(!n)throw new Error("WASM not initialized");return Q$($,Z,X)}function Z4($){if(!n)throw new Error("WASM not initialized");return Y$($)}var n=!1;var d0=i8(()=>{w$()});function o4($){if(typeof DOMParser!=="undefined")return new DOMParser().parseFromString($,"text/html");if(typeof document!=="undefined"){let Z=document.implementation.createHTMLDocument("");return Z.documentElement.innerHTML=$,Z}return null}function i4($,Z){let X=o4($);if(X)return X.getElementById(Z)?.textContent??null;let J=new RegExp(`<script[^>]*id=["']${Z}["'][^>]*>([\\s\\S]*?)<\\/script>`,"i"),q=$.match(J);return q?q[1]:null}function pX($){return $.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function dX($,Z){let X=o4($);if(X)return X.querySelector(`script[type="${Z}"]`)?.textContent??null;let J=new RegExp(`<script[^>]*type=["']${pX(Z)}["'][^>]*>([\\s\\S]*?)<\\/script>`,"i"),q=$.match(J);return q?q[1]:null}function r4($){let Z=i4($,"data-layer");if(Z)try{return JSON.parse(Z)}catch{return null}let X=dX($,"application/ld+json");if(X)try{return JSON.parse(X)}catch{return null}return null}function s4($){let Z=i4($,"weba-l2-envelope");if(!Z)return null;try{return JSON.parse(Z)}catch{return null}}function lX($){let Z={},X=(J,q)=>{if(J===null||J===void 0){Z[q]=null;return}if(Array.isArray(J)){J.forEach((G,Q)=>{X(G,q?`${q}[${Q}]`:`[${Q}]`)});return}if(typeof J==="object"){Object.entries(J).forEach(([G,Q])=>{let Y=q?`${q}.${G}`:G;X(Q,Y)});return}Z[q]=J};if(X($,""),""in Z)delete Z[""];return Z}function t4($){let Z={_filename:$.filename},X=new Set(["_filename"]);if($.includeJson)X.add("_json"),Z._json=JSON.stringify($.plain);let J=lX($.plain||{});for(let q of Object.keys(J)){if($.omitKey&&$.omitKey(q))continue;X.add(q),Z[q]=J[q]}if($.sig)X.add("_l2_sig"),Z._l2_sig=JSON.stringify($.sig);return{row:Z,keys:X}}function a4($){if($===null||$===void 0)return"";let Z=String($);if(/[",\n]/.test(Z))return`"${Z.replace(/"/g,'""')}"`;return Z}function e4($,Z){let X=[];return X.push(Z.map(a4).join(",")),$.forEach((J)=>{let q=Z.map((G)=>a4(J[G])).join(",");X.push(q)}),"\uFEFF"+X.join(`
`)}var sJ=C8(N8(),1);d0();var h$=C8(N8(),1);var b$=typeof Buffer!=="undefined";function J4($){if(b$)return Buffer.from($).toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/g,"");let Z="";return $.forEach((X)=>{Z+=String.fromCharCode(X)}),btoa(Z).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/g,"")}function q4($){let X=($.length%4===0?$:$+"=".repeat(4-$.length%4)).replace(/-/g,"+").replace(/_/g,"/");if(b$)return Uint8Array.from(Buffer.from(X,"base64"));let J=atob(X),q=new Uint8Array(J.length);for(let G=0;G<J.length;G++)q[G]=J.charCodeAt(G);return q}function gJ($){if($.length===0)return new Uint8Array;let Z=[0];for(let q of $){let G="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz".indexOf(q);if(G<0)throw new Error(`Invalid base58 character: ${q}`);let Q=G;for(let Y=0;Y<Z.length;Y++){let U=Z[Y]*58+Q;Z[Y]=U&255,Q=U>>8}while(Q>0)Z.push(Q&255),Q>>=8}let X=0;for(let q of $){if(q!=="1")break;X+=1}let J=new Uint8Array(X+Z.length);for(let q=0;q<Z.length;q++)J[J.length-1-q]=Z[q];return J}function g$($){if(!$.startsWith("z"))throw new Error(`Unsupported multibase prefix in ${$}`);return gJ($.slice(1))}d0();var yJ="0.1";function y$($){return J4($)}function m$($){return q4($)}function hJ($){let Z=h$.default($);if(Z===void 0)throw new Error("Failed to canonicalize JSON");return Z}async function u$(){return await P0(),t8()}async function mJ(){return await P0(),e8()}async function p$($,Z,X,J,q){await P0();let Q=q?.userSk??(await mJ()).privateKey,Y=q?.meta?.created_at||new Date().toISOString(),U={enabled:!0,recipient_kid:J,recipient_x25519:y$(Z),recipient_pqc:q?.pqc?y$(q.pqc.recipientPublicKey):void 0,layer1_ref:X,weba_version:yJ,campaign_id:q?.meta?.campaign_id},z=q?.userKid||(q?.userSk?"user#sig-custom":"user#sig-1"),H=A8(hJ($.layer2_plain),Q,z,JSON.stringify(U),Y);return JSON.parse(H)}class d${seenNonces=new Set;store;constructor($){this.store=$}async checkAndMark($){if(this.store){if(await this.store.has($))return!1;return await this.store.add($),!0}if(this.seenNonces.has($))return!1;return this.seenNonces.add($),!0}async reset(){if(this.store)await this.store.reset();this.seenNonces.clear()}}async function l$($,Z,X){if(await P0(),$.layer2.enc!=="HPKE-v1")throw new Error(`Unsupported layer2.enc: ${$.layer2.enc}`);if(!X?.skipReplayCheck){let G=X?.replayGuard;if(!G)console.warn("SECURITY WARNING: No ReplayGuard provided to decryptLayer2. Using in-memory ephemeral store. Replays will only be detected within this process lifetime."),G=new d$;if(!await G.checkAndMark($.meta.nonce))throw new Error("Security Error: Replay detected (nonce used).")}let J=JSON.stringify($),q=X?.pqc?.recipientPrivateKey;try{let G=G8(J,Z,q);return JSON.parse(G)}catch(G){let Q=G instanceof Error?G.message:String(G);if(Q.includes("Missing PQC KEM")||Q.includes("AAD mismatch"))throw new Error(Q);throw new Error("Decryption failed")}}d0();function uJ($){let Z=0,X=0;for(let J=0;J<$.length;J++){let q=$[J];if(q===void 0)break;if(Z|=(q&127)<<X,(q&128)===0)return{value:Z,length:J+1};X+=7}throw new Error("Invalid varint encoding")}function pJ($){let{value:Z,length:X}=uJ($);return{code:Z,data:$.slice(X)}}function c$($){let Z=new Map;if(Array.isArray($.verificationMethod))$.verificationMethod.forEach((X)=>{if(X?.id)Z.set(X.id,X)});if(Array.isArray($.assertionMethod))$.assertionMethod.forEach((X)=>{if(X&&typeof X==="object"&&"id"in X){let J=X;if(J.id)Z.set(J.id,J)}});return Z}function n$($){let X=$.split("#")[0]||"";if(!X.startsWith("did:key:"))throw new Error(`Unsupported DID method for did:key decoding: ${$}`);let J=X.slice(8),q=pJ(g$(J));return{code:q.code,publicKey:q.data}}async function o$($,Z=fetch){if($.startsWith("did:key:")){let Q=$.slice(8);return{id:$,verificationMethod:[{id:`${$}#${Q}`,type:"Multikey",controller:$,publicKeyMultibase:Q}],assertionMethod:[`${$}#${Q}`]}}if(!$.startsWith("did:web:"))return null;let X=$.split(":")[2];if(!X)return null;let J=$.split(":").slice(3),q=J.length>0?J.join("/"):".well-known",G=`https://${X}/${q}/did.json`;try{let Q=await Z(G);if(!Q.ok)return null;return await Q.json()}catch(Q){return console.warn(`Failed to resolve DID ${$}:`,Q),null}}async function dJ($){if($.startsWith("did:key:"))try{let{code:Q,publicKey:Y}=n$($);if(Q===236)return{publicKey:Y,kid:`${$}#${$.split(":").pop()}`};if(Q===237)return{publicKey:Z4(Y),kid:`${$}#${$.split(":").pop()}`};throw new Error(`Unsupported did:key type (multicodec: 0x${Q.toString(16)})`)}catch(Q){throw new Error(`Failed to resolve did:key: ${Q.message||Q}`)}let Z=await o$($,fetch);if(!Z)throw new Error(`Failed to resolve DID: ${$}`);if(!Z.keyAgreement||Z.keyAgreement.length===0)throw new Error("No keyAgreement found in DID Document");let X=Z.keyAgreement[0],J;if(typeof X==="string")J=X;else if(X&&typeof X==="object"&&"id"in X)J=X.id;else throw new Error("Invalid keyAgreement format in DID Document");let q=c$(Z),G=q.get(J);if(!G){let Q=J.split("#").pop();if(Q){for(let[Y,U]of q.entries())if(Y.endsWith(`#${Q}`)){G=U;break}}}if(!G&&typeof X==="object"&&"publicKeyJwk"in X)G=X;if(!G)throw new Error(`KeyAgreement method not found: ${J}`);if(G.publicKeyJwk&&typeof G.publicKeyJwk==="object"){let Q=G.publicKeyJwk;if(Q.kty==="OKP"&&Q.crv==="X25519"&&Q.x)return{publicKey:m$(Q.x),kid:G.id}}throw new Error("No X25519 encryption key found in DID Document")}async function i$($,Z,X){await P0(fetch("weba_crypto_wasm_bg.wasm"));let J=localStorage.getItem(`guest-did:${$}`);if(!J)throw new Error("Credential ID not found for DID");let G={layer2_plain:{type:"https://schema.org/Message",ext:{"com.example.rsvp":{attending:!0,count:1}},text:X,timestamp:new Date().toISOString()},layer2_sig:{alg:"none",kid:"guest-passkey",sig:"",created_at:new Date().toISOString()}};console.log("Resolving recipient...",Z);let{publicKey:Q,kid:Y}=await dJ(Z);console.log("Encrypting...",Y);let U=await p$(G,Q,`ref:${Date.now()}`,Y,{userSk:new Uint8Array(0),userKid:"guest-passkey"}),H=await(await fetch(U8,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:"query GetChallenge($did: ID!) { getChallenge(did: $did) { nonce } }",variables:{did:$}})})).json();if(H.errors)throw new Error(H.errors[0].message);let F=H.data.getChallenge.nonce,V=Y8(F);console.log("Requesting Passkey signature...");let D=await navigator.credentials.get({publicKey:{challenge:V,allowCredentials:[{id:Y8(J),type:"public-key"}],userVerification:"required"}});if(!D)throw new Error("Authentication failed");let P=D.response,A=`
        mutation GuestPostMessage(
            $did: ID!, 
            $credentialId: String!, 
            $signature: String!, 
            $authenticatorData: String!, 
            $clientDataJSON: String!,
            $recipientDid: String!,
            $envelope: String!
        ) {
            guestPostMessage(
                did: $did, 
                credentialId: $credentialId, 
                signature: $signature, 
                authenticatorData: $authenticatorData, 
                clientDataJSON: $clientDataJSON,
                recipientDid: $recipientDid,
                envelope: $envelope
            ) {
                id
            }
        }
    `,S=await(await fetch(U8,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:A,variables:{did:$,credentialId:J,signature:l0(P.signature),authenticatorData:l0(P.authenticatorData),clientDataJSON:l0(P.clientDataJSON),recipientDid:Z,envelope:JSON.stringify(U)}})})).json();if(S.errors)throw new Error(S.errors[0].message);return console.log("Guest Message Sent!",S.data.guestPostMessage.id),S.data.guestPostMessage}var lJ=typeof window!=="undefined"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"),U8=lJ?"http://127.0.0.1:5002/api":"/api",cJ="SRN Guest Service";async function nJ(){let $=localStorage.length;for(let Z=0;Z<$;Z++){let X=localStorage.key(Z);if(!X||!X.startsWith("guest-did:"))continue;if(X.endsWith(":privateKey"))continue;return X.replace("guest-did:","")}return null}async function r$($=!1){if(!window.PublicKeyCredential)throw new Error("Passkey not supported on this device");if(!$){let X=await nJ();if(X)return console.log("Reusing existing Guest DID"),{did:X,isReused:!0}}return{did:await oJ(),isReused:!1}}async function oJ(){try{let J=function(F){let V="",D=new Uint8Array(F),P=D.length;for(let A=0;A<P;A++)V+=String.fromCharCode(D[A]);return btoa(V)};await P0(fetch("weba_crypto_wasm_bg.wasm"));let $=new Uint8Array(32);crypto.getRandomValues($);let Z=new Uint8Array(16);crypto.getRandomValues(Z);let X=await navigator.credentials.create({publicKey:{challenge:$,rp:{name:cJ,id:window.location.hostname},user:{id:Z,name:"guest@srn.example",displayName:"SRN Guest User"},pubKeyCredParams:[{alg:-7,type:"public-key"}],authenticatorSelection:{authenticatorAttachment:"platform",userVerification:"required",residentKey:"required",requireResidentKey:!0},timeout:60000,attestation:"none"}});if(!X)throw new Error("Passkey creation cancelled");let q=await u$(),G={kty:"OKP",crv:"X25519",x:s$(q.publicKey)},Q=`
      mutation CreateGuestDid($credentialId: String!, $attestationObject: String!, $clientDataJSON: String!, $encryptionPublicKeyJwk: String!) {
        createGuestDid(credentialId: $credentialId, attestationObject: $attestationObject, clientDataJSON: $clientDataJSON, encryptionPublicKeyJwk: $encryptionPublicKeyJwk) {
          did
          expiresAt
        }
      }
    `,U=await(await fetch(U8,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:Q,variables:{credentialId:X.id,attestationObject:J(X.response.attestationObject),clientDataJSON:J(X.response.clientDataJSON),encryptionPublicKeyJwk:JSON.stringify(G)}})})).json();if(U.errors)throw new Error(`GraphQL Error: ${U.errors[0].message}`);let{did:z,expiresAt:H}=U.data.createGuestDid;return localStorage.setItem(`guest-did:${z}`,X.id),localStorage.setItem(`guest-did:${z}:privateKey`,s$(q.privateKey)),console.log(`Guest DID created: ${z} (expires: ${H})`),z}catch($){throw console.error("Failed to create Guest DID:",$),$}}async function iJ($){await P0(fetch("weba_crypto_wasm_bg.wasm"));let Z=localStorage.getItem(`guest-did:${$}`);if(!Z)throw new Error("Credential ID not found for DID");let J=await(await fetch(U8,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:"query GetChallenge($did: ID!) { getChallenge(did: $did) { nonce } }",variables:{did:$}})})).json();if(J.errors)throw new Error(J.errors[0].message);let q=J.data.getChallenge.nonce,G=Y8(q),Q=await navigator.credentials.get({publicKey:{challenge:G,allowCredentials:[{id:Y8(Z),type:"public-key"}],userVerification:"required"}});if(!Q)throw new Error("Authentication failed");let Y=Q.response,U=`
        query GuestInbox($did: ID!, $credentialId: String!, $signature: String!, $authenticatorData: String!, $clientDataJSON: String!) {
            guestInbox(did: $did, credentialId: $credentialId, signature: $signature, authenticatorData: $authenticatorData, clientDataJSON: $clientDataJSON) {
                id
                senderDid
                recipientDid
                envelope
                createdAt
            }
        }
    `,H=await(await fetch(U8,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:U,variables:{did:$,credentialId:Z,signature:l0(Y.signature),authenticatorData:l0(Y.authenticatorData),clientDataJSON:l0(Y.clientDataJSON)}})})).json();if(H.errors)throw new Error(H.errors[0].message);let F=H.data.guestInbox,V=localStorage.getItem(`guest-did:${$}:privateKey`);if(V){let D=new Uint8Array(Y8(V));for(let P of F)if(P.envelope)try{let A=JSON.parse(P.envelope),N=await l$(A,D);if(N.layer2_plain)P.content=N.layer2_plain;else P.content=N;delete P.envelope}catch(A){console.error("Failed to decrypt:",A),P.content={text:"[Decryption Failed: "+A.message+"]"}}}return F}function Y8($){let Z="=".repeat((4-$.length%4)%4),X=($+Z).replace(/-/g,"+").replace(/_/g,"/"),J=window.atob(X),q=new Uint8Array(J.length);for(let G=0;G<J.length;++G)q[G]=J.charCodeAt(G);return q.buffer}function l0($){let Z="",X=new Uint8Array($),J=X.length;for(let q=0;q<J;q++)Z+=String.fromCharCode(X[q]);return window.btoa(Z)}function s$($){let Z="",X=$.length;for(let J=0;J<X;J++)Z+=String.fromCharCode($[J]);return btoa(Z).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}if(typeof window!=="undefined")window.getOrCreateGuestDid=r$,window.fetchGuestInbox=iJ,window.sendGuestMessage=i$,window.submitFormWithGuestDid=async($,Z,X)=>{let{did:J,isReused:q}=await r$(!1),G=JSON.stringify($);return await i$(J,X||"did:web:srn.example",G),{senderDid:J}},window.clearAllGuestDids=()=>{let $=Object.keys(localStorage);for(let Z of $)if(Z.startsWith("guest-did:"))localStorage.removeItem(Z)};var w8=($)=>{let Z=new Uint8Array($);return btoa(String.fromCharCode(...Z)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")},a$=($)=>{let Z=$.replace(/-/g,"+").replace(/_/g,"/");while(Z.length%4)Z+="=";let X=atob(Z),J=new Uint8Array(X.length);for(let q=0;q<X.length;q++)J[q]=X.charCodeAt(q);return J.buffer};async function t$($){let Z=crypto.getRandomValues(new Uint8Array(32)),J=new TextEncoder().encode($),q=await crypto.subtle.digest("SHA-256",J),G=new Uint8Array(q).slice(0,16),Q=await navigator.credentials.create({publicKey:{challenge:Z,rp:{name:"Sorane Web/A Form"},user:{id:G,name:$,displayName:$},pubKeyCredParams:[{alg:-7,type:"public-key"}],authenticatorSelection:{authenticatorAttachment:"platform",userVerification:"required",residentKey:"required"},timeout:60000,attestation:"none",extensions:{prf:{}}}});if(!Q)throw new Error("Credential creation failed");return{id:Q.id,rawId:w8(Q.rawId),response:Q.response}}async function e$($,Z){let X=await navigator.credentials.get({publicKey:{challenge:Z,allowCredentials:[{id:a$($),type:"public-key"}],userVerification:"required"}});if(!X)throw new Error("Assertion failed");let J=X.response;return{id:X.id,signature:w8(J.signature),authenticatorData:w8(J.authenticatorData),clientDataJSON:w8(J.clientDataJSON)}}async function c0($,Z){let X=crypto.getRandomValues(new Uint8Array(32)),J=await navigator.credentials.get({publicKey:{challenge:X,allowCredentials:[{id:a$($),type:"public-key"}],userVerification:"required",extensions:{prf:{eval:{first:Z}}}}});if(!J)throw new Error("Assertion failed");let G=J.getClientExtensionResults()?.prf?.results?.first;if(!G)throw new Error("PRF extension not available");return new Uint8Array(G)}function $Z($){let Z=document.getElementById($);if(!Z||!Z.textContent)return null;try{return JSON.parse(Z.textContent)}catch{return null}}function ZZ(){let $=$Z("weba-l2-envelope");if(!$)return;let Z=$Z("weba-l2-keywrap"),X=document.querySelector(".weba-form-container")||document.body,J=document.createElement("div");J.className="weba-l2-unlock",J.style.cssText="margin-top:2rem;padding:1rem;border:1px solid #cbd5f5;border-radius:10px;background:#f8fafc;";let q=document.createElement("div");q.textContent="Encrypted Submission",q.style.cssText="font-weight:600;color:#334155;margin-bottom:0.5rem;",J.appendChild(q);let G=document.createElement("div");G.textContent="Locked. Unlock with Passkey.",G.style.cssText="color:#64748b;margin-bottom:0.75rem;",J.appendChild(G);let Q=document.createElement("button");Q.textContent="Unlock (Passkey)",Q.style.cssText="padding:0.5rem 1rem;border:1px solid #94a3b8;border-radius:6px;background:#fff;cursor:pointer;",J.appendChild(Q);let Y=document.createElement("pre");Y.style.cssText="margin-top:1rem;padding:1rem;background:#0f172a;color:#e2e8f0;border-radius:8px;overflow:auto;font-size:0.85rem;display:none;",J.appendChild(Y);let U=document.createElement("details");U.style.cssText="margin-top:0.75rem; display:none;",U.innerHTML='<summary style="cursor:pointer;color:#64748b;">Show signature</summary><pre style="margin-top:0.5rem;padding:0.75rem;background:#0b1220;color:#cbd5f5;border-radius:6px;overflow:auto;font-size:0.8rem;"></pre>',J.appendChild(U);let z=document.createElement("button");z.textContent="Export JSON",z.style.cssText="margin-top:0.75rem;padding:0.45rem 0.9rem;border:1px solid #94a3b8;border-radius:6px;background:#fff;cursor:pointer;display:none;",z.disabled=!0,J.appendChild(z),Q.addEventListener("click",async()=>{if(!Z){G.textContent="Key wrap package not found.";return}Q.disabled=!0,G.textContent="Waiting for passkey...";try{let H=N0(Z.prf_salt),F=await c0(Z.credential_id,H),V=await XZ({keywrap:Z,prfKey:F}),D=await I8($,V,{skipReplayCheck:!0});rJ(D.layer2_plain),document.body.classList.add("weba-l2-readonly"),Y.textContent=JSON.stringify(D.layer2_plain,null,2),Y.style.display="block";let P=U.querySelector("pre");if(P)P.textContent=JSON.stringify(D.layer2_sig,null,2);U.style.display="block",z.style.display="inline-block",z.disabled=!1,G.textContent="Unlocked.",z.onclick=()=>{let A=new Blob([JSON.stringify(D,null,2)],{type:"application/json"}),N=URL.createObjectURL(A),S=document.createElement("a");S.href=N,S.download="weba-l2-decrypted.json",S.click()}}catch(H){console.error(H),G.textContent="Unlock failed.",Q.disabled=!1}}),X.appendChild(J)}function rJ($){if(!$||typeof $!=="object")return;let Z=$;document.querySelectorAll("[data-json-path]").forEach((X)=>{let J=X.dataset.jsonPath;if(!J||!(J in Z))return;let q=Z[J];if(X.type==="checkbox")X.checked=Boolean(q);else if(X.type==="radio")X.checked=X.value===String(q);else X.value=q===null||q===void 0?"":String(q)}),document.querySelectorAll('input[type="radio"]').forEach((X)=>{let J=X.name;if(!J||!(J in Z))return;let q=Z[J];X.checked=X.value===String(q)}),document.querySelectorAll("table.data-table.dynamic").forEach((X)=>{let J=X.dataset.tableKey;if(!J)return;let q=Z[J];if(!Array.isArray(q))return;let G=X.querySelector("tbody");if(!G)return;let Q=G.querySelector("tr.template-row");if(!Q)return;Array.from(G.querySelectorAll("tr")).forEach((Y)=>{if(!Y.classList.contains("template-row"))Y.remove()}),q.forEach((Y,U)=>{let z=U===0?Q:Q.cloneNode(!0);if(U>0){z.classList.remove("template-row");let H=z.querySelector(".remove-row-btn");if(H)H.style.visibility="visible";G.appendChild(z)}if(Y&&typeof Y==="object")z.querySelectorAll("input, select, textarea").forEach((H)=>{let F=H.dataset.baseKey;if(!F)return;let V=Y[F];if(H.type==="checkbox")H.checked=Boolean(V);else H.value=V===null||V===void 0?"":String(V)})})}),document.querySelectorAll("input").forEach((X)=>{if(X.type==="checkbox"||X.type==="radio")X.disabled=!0;else X.readOnly=!0}),document.querySelectorAll("textarea").forEach((X)=>{X.readOnly=!0}),document.querySelectorAll("select").forEach((X)=>{X.disabled=!0}),document.querySelectorAll(".form-toolbar button, .add-row-btn, .remove-row-btn").forEach((X)=>{X.disabled=!0})}function R0($){return document.getElementById($)}function JZ(){if(!R0("weba-l2-keywrap-tool"))return;let Z=R0("kwp-recipient-sk"),X=R0("kwp-credential-id"),J=R0("kwp-prf-salt"),q=R0("kwp-aad"),G=R0("kwp-kid"),Q=R0("kwp-status"),Y=R0("kwp-output"),U=R0("kwp-generate-salt"),z=R0("kwp-wrap");if(!Z||!X||!J||!Q||!Y||!z)return;U?.addEventListener("click",()=>{let H=new Uint8Array(32);crypto.getRandomValues(H),J.value=b0(H)}),z.addEventListener("click",async()=>{Q.textContent="Waiting for passkey...",z.disabled=!0;try{if(!Z.value||!X.value||!J.value)throw new Error("Missing required fields.");let H=N0(Z.value.trim()),F=N0(J.value.trim()),V=await c0(X.value.trim(),F),D=q?.value?N0(q.value.trim()):void 0,P=await qZ({recipientSk:H,prfKey:V,aad:D}),A={alg:"WebAuthn-PRF-AESGCM-v1",kid:G?.value||"issuer#passkey-1",credential_id:X.value.trim(),prf_salt:b0(F),wrapped_key:b0(P),...D?{aad:b0(D)}:{}};Y.textContent=JSON.stringify(A,null,2),Q.textContent="Key wrap ready."}catch(H){console.error(H),Q.textContent="Key wrap failed."}finally{z.disabled=!1}})}if(typeof window!=="undefined")window.initL2Viewer=ZZ,window.initKeywrapTool=JZ;class Q4{key;nonces;constructor($="weba_l2_nonces"){this.key=$,this.nonces=new Set,this.load()}load(){let $=localStorage.getItem(this.key);if($)try{let Z=JSON.parse($);if(Array.isArray(Z))this.nonces=new Set(Z)}catch(Z){console.error("Failed to load replay store from localStorage",Z)}}save(){try{localStorage.setItem(this.key,JSON.stringify(Array.from(this.nonces)))}catch($){console.error("Failed to save replay store to localStorage",$)}}async has($){return this.nonces.has($)}async add($){this.nonces.add($),this.save()}async reset(){this.nonces.clear(),this.save()}}function b0($){if(typeof Buffer!=="undefined")return Buffer.from($).toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/g,"");let Z="";return $.forEach((J)=>{Z+=String.fromCharCode(J)}),btoa(Z).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/g,"")}function N0($){let Z=$.length%4===0?"":"=".repeat(4-$.length%4),X=$.replace(/-/g,"+").replace(/_/g,"/")+Z;if(typeof Buffer!=="undefined")return new Uint8Array(Buffer.from(X,"base64"));let J=atob(X),q=new Uint8Array(J.length);for(let G=0;G<J.length;G+=1)q[G]=J.charCodeAt(G);return q}async function f8(){await Q8()}async function QZ($){await f8();let Z=new TextEncoder().encode("weba-l2/user-x25519"),X=C0($,void 0,Z,32);return{publicKey:j8(X),privateKey:X}}async function aJ($,Z,X,J){let q=await crypto.subtle.importKey("raw",Z,"AES-GCM",!1,["encrypt"]),G=await crypto.subtle.encrypt({name:"AES-GCM",iv:X,additionalData:J},q,$);return new Uint8Array(G)}async function qZ($){await f8();let Z=C0($.prfKey,void 0,new TextEncoder().encode("weba-l2/prk"),32),X=C0(Z,void 0,new TextEncoder().encode("weba-l2/kw"),32),J=C0(Z,void 0,new TextEncoder().encode("weba-l2/kw-iv"),12),q=$.aad??new Uint8Array;return aJ($.recipientSk,X,J,q)}async function tJ($,Z,X,J){let q=await crypto.subtle.importKey("raw",Z,"AES-GCM",!1,["decrypt"]),G=await crypto.subtle.decrypt({name:"AES-GCM",iv:X,additionalData:J},q,$);return new Uint8Array(G)}class T8{seenNonces=new Set;store;constructor($){this.store=$}async checkAndMark($){if(this.store){if(await this.store.has($))return!1;return await this.store.add($),!0}if(this.seenNonces.has($))return!1;return this.seenNonces.add($),!0}async reset(){if(this.store)await this.store.reset();this.seenNonces.clear()}}async function I8($,Z,X){if(await f8(),$.layer2.enc!=="HPKE-v1")throw new Error(`Unsupported layer2.enc: ${$.layer2.enc}`);if(!X?.skipReplayCheck){let G=X?.replayGuard;if(!G)console.warn("SECURITY WARNING: No ReplayGuard provided to decryptLayer2Envelope. Using in-memory ephemeral store. Replays will only be detected within this page session."),G=new T8;if(!await G.checkAndMark($.meta.nonce))throw new Error("Security Error: Replay detected (nonce used).")}let J=JSON.stringify($),q=X?.pqcRecipientSk;try{let G=G8(J,Z,q);return JSON.parse(G)}catch(G){let Q=G instanceof Error?G.message:String(G);if(Q.includes("Missing PQC KEM")||Q.includes("AAD mismatch"))throw new Error(Q);throw new Error("Decryption failed")}}async function XZ($){await f8();let Z=C0($.prfKey,void 0,new TextEncoder().encode("weba-l2/prk"),32),X=C0(Z,void 0,new TextEncoder().encode("weba-l2/kw"),32),J=C0(Z,void 0,new TextEncoder().encode("weba-l2/kw-iv"),12),q=$.keywrap.aad?N0($.keywrap.aad):new Uint8Array,G=N0($.keywrap.wrapped_key);return tJ(G,X,J,q)}var AZ=C8(N8(),1);var G4;try{G4=new TextDecoder}catch($){}var T,y0,M=0;var FZ=[],eJ=105,$q=57342,Zq=57343,GZ=57337;var YZ=6,n0={},z8=112810000,I0=16810000;var Y4=FZ,U4=0,u={},s,v8,S8=0,H8=0,J0,O0,$0=[],z4=[],V0,F0,F8,UZ={useRecords:!1,mapsAsObjects:!0},B8=!1,HZ=2;try{new Function("")}catch($){HZ=1/0}class x0{constructor($){if($){if(($.keyMap||$._keyMap)&&!$.useRecords)$.useRecords=!1,$.mapsAsObjects=!0;if($.useRecords===!1&&$.mapsAsObjects===void 0)$.mapsAsObjects=!0;if($.getStructures)$.getShared=$.getStructures;if($.getShared&&!$.structures)($.structures=[]).uninitialized=!0;if($.keyMap){this.mapKey=new Map;for(let[Z,X]of Object.entries($.keyMap))this.mapKey.set(X,Z)}}Object.assign(this,$)}decodeKey($){return this.keyMap?this.mapKey.get($)||$:$}encodeKey($){return this.keyMap&&this.keyMap.hasOwnProperty($)?this.keyMap[$]:$}encodeKeys($){if(!this._keyMap)return $;let Z=new Map;for(let[X,J]of Object.entries($))Z.set(this._keyMap.hasOwnProperty(X)?this._keyMap[X]:X,J);return Z}decodeKeys($){if(!this._keyMap||$.constructor.name!="Map")return $;if(!this._mapKey){this._mapKey=new Map;for(let[X,J]of Object.entries(this._keyMap))this._mapKey.set(J,X)}let Z={};return $.forEach((X,J)=>Z[M0(this._mapKey.has(J)?this._mapKey.get(J):J)]=X),Z}mapDecode($,Z){let X=this.decode($);if(this._keyMap)switch(X.constructor.name){case"Array":return X.map((J)=>this.decodeKeys(J))}return X}decode($,Z){if(T)return WZ(()=>{return _8(),this?this.decode($,Z):x0.prototype.decode.call(UZ,$,Z)});y0=Z>-1?Z:$.length,M=0,U4=0,H8=0,v8=null,Y4=FZ,J0=null,T=$;try{F0=$.dataView||($.dataView=new DataView($.buffer,$.byteOffset,$.byteLength))}catch(X){if(T=null,$ instanceof Uint8Array)throw X;throw new Error("Source must be a Uint8Array or Buffer but was a "+($&&typeof $=="object"?$.constructor.name:typeof $))}if(this instanceof x0){if(u=this,V0=this.sharedValues&&(this.pack?new Array(this.maxPrivatePackedValues||16).concat(this.sharedValues):this.sharedValues),this.structures)return s=this.structures,x8();else if(!s||s.length>0)s=[]}else{if(u=UZ,!s||s.length>0)s=[];V0=null}return x8()}decodeMultiple($,Z){let X,J=0;try{let q=$.length;B8=!0;let G=this?this.decode($,q):W4.decode($,q);if(Z){if(Z(G)===!1)return;while(M<q)if(J=M,Z(x8())===!1)return}else{X=[G];while(M<q)J=M,X.push(x8());return X}}catch(q){throw q.lastPosition=J,q.values=X,q}finally{B8=!1,_8()}}}function x8(){try{let $=p();if(J0){if(M>=J0.postBundlePosition){let Z=new Error("Unexpected bundle position");throw Z.incomplete=!0,Z}M=J0.postBundlePosition,J0=null}if(M==y0){if(s=null,T=null,O0)O0=null}else if(M>y0){let Z=new Error("Unexpected end of CBOR data");throw Z.incomplete=!0,Z}else if(!B8)throw new Error("Data read, but end of buffer not reached");return $}catch($){if(_8(),$ instanceof RangeError||$.message.startsWith("Unexpected end of buffer"))$.incomplete=!0;throw $}}function p(){let $=T[M++],Z=$>>5;if($=$&31,$>23)switch($){case 24:$=T[M++];break;case 25:if(Z==7)return Qq();$=F0.getUint16(M),M+=2;break;case 26:if(Z==7){let X=F0.getFloat32(M);if(u.useFloat32>2){let J=k8[(T[M]&127)<<1|T[M+1]>>7];return M+=4,(J*X+(X>0?0.5:-0.5)>>0)/J}return M+=4,X}$=F0.getUint32(M),M+=4;break;case 27:if(Z==7){let X=F0.getFloat64(M);return M+=8,X}if(Z>1){if(F0.getUint32(M)>0)throw new Error("JavaScript does not support arrays, maps, or strings with length over 4294967295");$=F0.getUint32(M+4)}else if(u.int64AsNumber)$=F0.getUint32(M)*4294967296,$+=F0.getUint32(M+4);else $=F0.getBigUint64(M);M+=8;break;case 31:switch(Z){case 2:case 3:throw new Error("Indefinite length not supported for byte or text strings");case 4:let X=[],J,q=0;while((J=p())!=n0){if(q>=z8)throw new Error(`Array length exceeds ${z8}`);X[q++]=J}return Z==4?X:Z==3?X.join(""):Buffer.concat(X);case 5:let G;if(u.mapsAsObjects){let Q={},Y=0;if(u.keyMap)while((G=p())!=n0){if(Y++>=I0)throw new Error(`Property count exceeds ${I0}`);Q[M0(u.decodeKey(G))]=p()}else while((G=p())!=n0){if(Y++>=I0)throw new Error(`Property count exceeds ${I0}`);Q[M0(G)]=p()}return Q}else{if(F8)u.mapsAsObjects=!0,F8=!1;let Q=new Map;if(u.keyMap){let Y=0;while((G=p())!=n0){if(Y++>=I0)throw new Error(`Map size exceeds ${I0}`);Q.set(u.decodeKey(G),p())}}else{let Y=0;while((G=p())!=n0){if(Y++>=I0)throw new Error(`Map size exceeds ${I0}`);Q.set(G,p())}}return Q}case 7:return n0;default:throw new Error("Invalid major type for indefinite length "+Z)}default:throw new Error("Unknown token "+$)}switch(Z){case 0:return $;case 1:return~$;case 2:return qq($);case 3:if(H8>=M)return v8.slice(M-S8,(M+=$)-S8);if(H8==0&&y0<140&&$<32){let q=$<16?BZ($):Jq($);if(q!=null)return q}return Xq($);case 4:if($>=z8)throw new Error(`Array length exceeds ${z8}`);let X=new Array($);for(let q=0;q<$;q++)X[q]=p();return X;case 5:if($>=I0)throw new Error(`Map size exceeds ${z8}`);if(u.mapsAsObjects){let q={};if(u.keyMap)for(let G=0;G<$;G++)q[M0(u.decodeKey(p()))]=p();else for(let G=0;G<$;G++)q[M0(p())]=p();return q}else{if(F8)u.mapsAsObjects=!0,F8=!1;let q=new Map;if(u.keyMap)for(let G=0;G<$;G++)q.set(u.decodeKey(p()),p());else for(let G=0;G<$;G++)q.set(p(),p());return q}case 6:if($>=GZ){let q=s[$&8191];if(q){if(!q.read)q.read=F4(q);return q.read()}if($<65536){if($==Zq){let G=i0(),Q=p(),Y=p();B4(Q,Y);let U={};if(u.keyMap)for(let z=2;z<G;z++){let H=u.decodeKey(Y[z-2]);U[M0(H)]=p()}else for(let z=2;z<G;z++){let H=Y[z-2];U[M0(H)]=p()}return U}else if($==$q){let G=i0(),Q=p();for(let Y=2;Y<G;Y++)B4(Q++,p());return p()}else if($==GZ)return Hq();if(u.getShared){if(V4(),q=s[$&8191],q){if(!q.read)q.read=F4(q);return q.read()}}}}let J=$0[$];if(J)if(J.handlesRead)return J(p);else return J(p());else{let q=p();for(let G=0;G<z4.length;G++){let Q=z4[G]($,q);if(Q!==void 0)return Q}return new L0(q,$)}case 7:switch($){case 20:return!1;case 21:return!0;case 22:return null;case 23:return;case 31:default:let q=(V0||g0())[$];if(q!==void 0)return q;throw new Error("Unknown token "+$)}default:if(isNaN($)){let q=new Error("Unexpected end of CBOR data");throw q.incomplete=!0,q}throw new Error("Unknown CBOR token "+$)}}var zZ=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function F4($){if(!$)throw new Error("Structure is required in record definition");function Z(){let X=T[M++];if(X=X&31,X>23)switch(X){case 24:X=T[M++];break;case 25:X=F0.getUint16(M),M+=2;break;case 26:X=F0.getUint32(M),M+=4;break;default:throw new Error("Expected array header, but got "+T[M-1])}let J=this.compiledReader;while(J){if(J.propertyCount===X)return J(p);J=J.next}if(this.slowReads++>=HZ){let G=this.length==X?this:this.slice(0,X);if(J=u.keyMap?new Function("r","return {"+G.map((Q)=>u.decodeKey(Q)).map((Q)=>zZ.test(Q)?M0(Q)+":r()":"["+JSON.stringify(Q)+"]:r()").join(",")+"}"):new Function("r","return {"+G.map((Q)=>zZ.test(Q)?M0(Q)+":r()":"["+JSON.stringify(Q)+"]:r()").join(",")+"}"),this.compiledReader)J.next=this.compiledReader;return J.propertyCount=X,this.compiledReader=J,J(p)}let q={};if(u.keyMap)for(let G=0;G<X;G++)q[M0(u.decodeKey(this[G]))]=p();else for(let G=0;G<X;G++)q[M0(this[G])]=p();return q}return $.slowReads=0,Z}function M0($){if(typeof $==="string")return $==="__proto__"?"__proto_":$;if(typeof $==="number"||typeof $==="boolean"||typeof $==="bigint")return $.toString();if($==null)return $+"";throw new Error("Invalid property name type "+typeof $)}var Xq=H4;function H4($){let Z;if($<16){if(Z=BZ($))return Z}if($>64&&G4)return G4.decode(T.subarray(M,M+=$));let X=M+$,J=[];Z="";while(M<X){let q=T[M++];if((q&128)===0)J.push(q);else if((q&224)===192){let G=T[M++]&63;J.push((q&31)<<6|G)}else if((q&240)===224){let G=T[M++]&63,Q=T[M++]&63;J.push((q&31)<<12|G<<6|Q)}else if((q&248)===240){let G=T[M++]&63,Q=T[M++]&63,Y=T[M++]&63,U=(q&7)<<18|G<<12|Q<<6|Y;if(U>65535)U-=65536,J.push(U>>>10&1023|55296),U=56320|U&1023;J.push(U)}else J.push(q);if(J.length>=4096)Z+=Y0.apply(String,J),J.length=0}if(J.length>0)Z+=Y0.apply(String,J);return Z}var Y0=String.fromCharCode;function Jq($){let Z=M,X=new Array($);for(let J=0;J<$;J++){let q=T[M++];if((q&128)>0){M=Z;return}X[J]=q}return Y0.apply(String,X)}function BZ($){if($<4)if($<2)if($===0)return"";else{let Z=T[M++];if((Z&128)>1){M-=1;return}return Y0(Z)}else{let Z=T[M++],X=T[M++];if((Z&128)>0||(X&128)>0){M-=2;return}if($<3)return Y0(Z,X);let J=T[M++];if((J&128)>0){M-=3;return}return Y0(Z,X,J)}else{let Z=T[M++],X=T[M++],J=T[M++],q=T[M++];if((Z&128)>0||(X&128)>0||(J&128)>0||(q&128)>0){M-=4;return}if($<6)if($===4)return Y0(Z,X,J,q);else{let G=T[M++];if((G&128)>0){M-=5;return}return Y0(Z,X,J,q,G)}else if($<8){let G=T[M++],Q=T[M++];if((G&128)>0||(Q&128)>0){M-=6;return}if($<7)return Y0(Z,X,J,q,G,Q);let Y=T[M++];if((Y&128)>0){M-=7;return}return Y0(Z,X,J,q,G,Q,Y)}else{let G=T[M++],Q=T[M++],Y=T[M++],U=T[M++];if((G&128)>0||(Q&128)>0||(Y&128)>0||(U&128)>0){M-=8;return}if($<10)if($===8)return Y0(Z,X,J,q,G,Q,Y,U);else{let z=T[M++];if((z&128)>0){M-=9;return}return Y0(Z,X,J,q,G,Q,Y,U,z)}else if($<12){let z=T[M++],H=T[M++];if((z&128)>0||(H&128)>0){M-=10;return}if($<11)return Y0(Z,X,J,q,G,Q,Y,U,z,H);let F=T[M++];if((F&128)>0){M-=11;return}return Y0(Z,X,J,q,G,Q,Y,U,z,H,F)}else{let z=T[M++],H=T[M++],F=T[M++],V=T[M++];if((z&128)>0||(H&128)>0||(F&128)>0||(V&128)>0){M-=12;return}if($<14)if($===12)return Y0(Z,X,J,q,G,Q,Y,U,z,H,F,V);else{let D=T[M++];if((D&128)>0){M-=13;return}return Y0(Z,X,J,q,G,Q,Y,U,z,H,F,V,D)}else{let D=T[M++],P=T[M++];if((D&128)>0||(P&128)>0){M-=14;return}if($<15)return Y0(Z,X,J,q,G,Q,Y,U,z,H,F,V,D,P);let A=T[M++];if((A&128)>0){M-=15;return}return Y0(Z,X,J,q,G,Q,Y,U,z,H,F,V,D,P,A)}}}}}function qq($){return u.copyBuffers?Uint8Array.prototype.slice.call(T,M,M+=$):T.subarray(M,M+=$)}var KZ=new Float32Array(1),E8=new Uint8Array(KZ.buffer,0,4);function Qq(){let $=T[M++],Z=T[M++],X=($&127)>>2;if(X===31){if(Z||$&3)return NaN;return $&128?-1/0:1/0}if(X===0){let J=(($&3)<<8|Z)/16777216;return $&128?-J:J}return E8[3]=$&128|(X>>1)+56,E8[2]=($&7)<<5|Z>>3,E8[1]=Z<<5,E8[0]=0,KZ[0]}var pQ=new Array(4096);class L0{constructor($,Z){this.value=$,this.tag=Z}}$0[0]=($)=>{return new Date($)};$0[1]=($)=>{return new Date(Math.round($*1000))};$0[2]=($)=>{let Z=BigInt(0);for(let X=0,J=$.byteLength;X<J;X++)Z=BigInt($[X])+(Z<<BigInt(8));return Z};$0[3]=($)=>{return BigInt(-1)-$0[2]($)};$0[4]=($)=>{return+($[1]+"e"+$[0])};$0[5]=($)=>{return $[1]*Math.exp($[0]*Math.log(2))};var B4=($,Z)=>{$=$-57344;let X=s[$];if(X&&X.isShared)(s.restoreStructures||(s.restoreStructures=[]))[$]=X;s[$]=Z,Z.read=F4(Z)};$0[eJ]=($)=>{let Z=$.length,X=$[1];B4($[0],X);let J={};for(let q=2;q<Z;q++){let G=X[q-2];J[M0(G)]=$[q]}return J};$0[14]=($)=>{if(J0)return J0[0].slice(J0.position0,J0.position0+=$);return new L0($,14)};$0[15]=($)=>{if(J0)return J0[1].slice(J0.position1,J0.position1+=$);return new L0($,15)};var Gq={Error,RegExp};$0[27]=($)=>{return(Gq[$[0]]||Error)($[1],$[2])};var VZ=($)=>{if(T[M++]!=132){let X=new Error("Packed values structure must be followed by a 4 element array");if(T.length<M)X.incomplete=!0;throw X}let Z=$();if(!Z||!Z.length){let X=new Error("Packed values structure must be followed by a 4 element array");throw X.incomplete=!0,X}return V0=V0?Z.concat(V0.slice(Z.length)):Z,V0.prefixes=$(),V0.suffixes=$(),$()};VZ.handlesRead=!0;$0[51]=VZ;$0[YZ]=($)=>{if(!V0)if(u.getShared)V4();else return new L0($,YZ);if(typeof $=="number")return V0[16+($>=0?2*$:-2*$-1)];let Z=new Error("No support for non-integer packed references yet");if($===void 0)Z.incomplete=!0;throw Z};$0[28]=($)=>{if(!O0)O0=new Map,O0.id=0;let Z=O0.id++,X=M,J=T[M],q;if(J>>5==4)q=[];else q={};let G={target:q};O0.set(Z,G);let Q=$();if(G.used){if(Object.getPrototypeOf(q)!==Object.getPrototypeOf(Q))M=X,q=Q,O0.set(Z,{target:q}),Q=$();return Object.assign(q,Q)}return G.target=Q,Q};$0[28].handlesRead=!0;$0[29]=($)=>{let Z=O0.get($);return Z.used=!0,Z.target};$0[258]=($)=>new Set($);($0[259]=($)=>{if(u.mapsAsObjects)u.mapsAsObjects=!1,F8=!0;return $()}).handlesRead=!0;function o0($,Z){if(typeof $==="string")return $+Z;if($ instanceof Array)return $.concat(Z);return Object.assign({},$,Z)}function g0(){if(!V0)if(u.getShared)V4();else throw new Error("No packed values available");return V0}var Yq=1399353956;z4.push(($,Z)=>{if($>=225&&$<=255)return o0(g0().prefixes[$-224],Z);if($>=28704&&$<=32767)return o0(g0().prefixes[$-28672],Z);if($>=1879052288&&$<=2147483647)return o0(g0().prefixes[$-1879048192],Z);if($>=216&&$<=223)return o0(Z,g0().suffixes[$-216]);if($>=27647&&$<=28671)return o0(Z,g0().suffixes[$-27639]);if($>=1811940352&&$<=1879048191)return o0(Z,g0().suffixes[$-1811939328]);if($==Yq)return{packedValues:V0,structures:s.slice(0),version:Z};if($==55799)return Z});var Uq=new Uint8Array(new Uint16Array([1]).buffer)[0]==1,K4=[Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,typeof BigUint64Array=="undefined"?{name:"BigUint64Array"}:BigUint64Array,Int8Array,Int16Array,Int32Array,typeof BigInt64Array=="undefined"?{name:"BigInt64Array"}:BigInt64Array,Float32Array,Float64Array],zq=[64,68,69,70,71,72,77,78,79,85,86];for(let $=0;$<K4.length;$++)Fq(K4[$],zq[$]);function Fq($,Z){let X="get"+$.name.slice(0,-5),J;if(typeof $==="function")J=$.BYTES_PER_ELEMENT;else $=null;for(let q=0;q<2;q++){if(!q&&J==1)continue;let G=J==2?1:J==4?2:J==8?3:0;$0[q?Z:Z-4]=J==1||q==Uq?(Q)=>{if(!$)throw new Error("Could not find typed array for code "+Z);if(!u.copyBuffers){if(J===1||J===2&&!(Q.byteOffset&1)||J===4&&!(Q.byteOffset&3)||J===8&&!(Q.byteOffset&7))return new $(Q.buffer,Q.byteOffset,Q.byteLength>>G)}return new $(Uint8Array.prototype.slice.call(Q,0).buffer)}:(Q)=>{if(!$)throw new Error("Could not find typed array for code "+Z);let Y=new DataView(Q.buffer,Q.byteOffset,Q.byteLength),U=Q.length>>G,z=new $(U),H=Y[X];for(let F=0;F<U;F++)z[F]=H.call(Y,F<<G,q);return z}}}function Hq(){let $=i0(),Z=M+p();for(let J=2;J<$;J++){let q=i0();M+=q}let X=M;return M=Z,J0=[H4(i0()),H4(i0())],J0.position0=0,J0.position1=0,J0.postBundlePosition=M,M=X,p()}function i0(){let $=T[M++]&31;if($>23)switch($){case 24:$=T[M++];break;case 25:$=F0.getUint16(M),M+=2;break;case 26:$=F0.getUint32(M),M+=4;break}return $}function V4(){if(u.getShared){let $=WZ(()=>{return T=null,u.getShared()})||{},Z=$.structures||[];if(u.sharedVersion=$.version,V0=u.sharedValues=$.packedValues,s===!0)u.structures=s=Z;else s.splice.apply(s,[0,Z.length].concat(Z))}}function WZ($){let Z=y0,X=M,J=U4,q=S8,G=H8,Q=v8,Y=Y4,U=O0,z=J0,H=new Uint8Array(T.slice(0,y0)),F=s,V=u,D=B8,P=$();return y0=Z,M=X,U4=J,S8=q,H8=G,v8=Q,Y4=Y,O0=U,J0=z,T=H,B8=D,s=F,u=V,F0=new DataView(T.buffer,T.byteOffset,T.byteLength),P}function _8(){T=null,O0=null,s=null}var k8=new Array(147);for(let $=0;$<256;$++)k8[$]=+("1e"+Math.floor(45.15-$*0.30103));var W4=new x0({useRecords:!1}),b8=W4.decode,Bq=W4.decodeMultiple;var g8;try{g8=new TextEncoder}catch($){}var C4,RZ,h8=typeof globalThis==="object"&&globalThis.Buffer,K8=typeof h8!=="undefined",D4=K8?h8.allocUnsafeSlow:Uint8Array,DZ=K8?h8:Uint8Array,OZ=256,MZ=K8?4294967296:2144337920;var O4,W,i,B=0,E0,q0=null,Kq=61440,Vq=/[\u0080-\uFFFF]/,D0=Symbol("record-id");class m8 extends x0{constructor($){super($);this.offset=0;let Z,X,J,q,G,Q;$=$||{};let Y=DZ.prototype.utf8Write?function(K,L,O){return W.utf8Write(K,L,O)}:g8&&g8.encodeInto?function(K,L){return g8.encodeInto(K,W.subarray(L)).written}:!1,U=this,z=$.structures||$.saveStructures,H=$.maxSharedStructures;if(H==null)H=z?128:0;if(H>8190)throw new Error("Maximum maxSharedStructure is 8190");let F=$.sequential;if(F)H=0;if(!this.structures)this.structures=[];if(this.saveStructures)this.saveShared=this.saveStructures;let V,D,P=$.sharedValues,A;if(P){A=Object.create(null);for(let K=0,L=P.length;K<L;K++)A[P[K]]=K}let N=[],S=0,f=0;this.mapEncode=function(K,L){if(this._keyMap&&!this._mapped)switch(K.constructor.name){case"Array":K=K.map((O)=>this.encodeKeys(O));break}return this.encode(K,L)},this.encode=function(K,L){if(!W)W=new D4(8192),i=new DataView(W.buffer,0,8192),B=0;if(E0=W.length-10,E0-B<2048)W=new D4(W.length),i=new DataView(W.buffer,0,W.length),E0=W.length-10,B=0;else if(L===R4)B=B+7&2147483640;if(X=B,U.useSelfDescribedHeader)i.setUint32(B,3654940416),B+=3;if(Q=U.structuredClone?new Map:null,U.bundleStrings&&typeof K!=="string")q0=[],q0.size=1/0;else q0=null;if(J=U.structures,J){if(J.uninitialized){let C=U.getShared()||{};U.structures=J=C.structures||[],U.sharedVersion=C.version;let j=U.sharedValues=C.packedValues;if(j){A={};for(let w=0,I=j.length;w<I;w++)A[j[w]]=w}}let O=J.length;if(O>H&&!F)O=H;if(!J.transitions){J.transitions=Object.create(null);for(let C=0;C<O;C++){let j=J[C];if(!j)continue;let w,I=J.transitions;for(let _=0,g=j.length;_<g;_++){if(I[D0]===void 0)I[D0]=C;let v=j[_];if(w=I[v],!w)w=I[v]=Object.create(null);I=w}I[D0]=C|1048576}}if(!F)J.nextId=O}if(q)q=!1;if(G=J||[],D=A,$.pack){let O=new Map;if(O.values=[],O.encoder=U,O.maxValues=$.maxPrivatePackedValues||(A?16:1/0),O.objectMap=A||!1,O.samplingPackedValues=V,y8(K,O),O.values.length>0){W[B++]=216,W[B++]=51,A0(4);let C=O.values;x(C),A0(0),A0(0),D=Object.create(A||null);for(let j=0,w=C.length;j<w;j++)D[C[j]]=j}}O4=L&P4;try{if(O4)return;if(x(K),q0)CZ(X,x);if(U.offset=B,Q&&Q.idsToInsert){if(B+=Q.idsToInsert.length*2,B>E0)a(B);U.offset=B;let O=Oq(W.subarray(X,B),Q.idsToInsert);return Q=null,O}if(L&R4)return W.start=X,W.end=B,W;return W.subarray(X,B)}finally{if(J){if(f<10)f++;if(J.length>H)J.length=H;if(S>1e4){if(J.transitions=null,f=0,S=0,N.length>0)N=[]}else if(N.length>0&&!F){for(let O=0,C=N.length;O<C;O++)N[O][D0]=void 0;N=[]}}if(q&&U.saveShared){if(U.structures.length>H)U.structures=U.structures.slice(0,H);let O=W.subarray(X,B);if(U.updateSharedData()===!1)return U.encode(K);return O}if(L&Nq)B=X}},this.findCommonStringsToPack=()=>{if(V=new Map,!A)A=Object.create(null);return(K)=>{let L=K&&K.threshold||4,O=this.pack?K.maxPrivatePackedValues||16:0;if(!P)P=this.sharedValues=[];for(let[C,j]of V)if(j.count>L)A[C]=O++,P.push(C),q=!0;while(this.saveShared&&this.updateSharedData()===!1);V=null}};let x=(K)=>{if(B>E0)W=a(B);var L=typeof K,O;if(L==="string"){if(D){let I=D[K];if(I>=0){if(I<16)W[B++]=I+224;else if(W[B++]=198,I&1)x(15-I>>1);else x(I-16>>1);return}else if(V&&!$.pack){let _=V.get(K);if(_)_.count++;else V.set(K,{count:1})}}let C=K.length;if(q0&&C>=4&&C<1024){if((q0.size+=C)>Kq){let _,g=(q0[0]?q0[0].length*3+q0[1].length:0)+10;if(B+g>E0)W=a(B+g);if(W[B++]=217,W[B++]=223,W[B++]=249,W[B++]=q0.position?132:130,W[B++]=26,_=B-X,B+=4,q0.position)CZ(X,x);q0=["",""],q0.size=0,q0.position=_}let I=Vq.test(K);q0[I?0:1]+=K,W[B++]=I?206:207,x(C);return}let j;if(C<32)j=1;else if(C<256)j=2;else if(C<65536)j=3;else j=5;let w=C*3;if(B+w>E0)W=a(B+w);if(C<64||!Y){let I,_,g,v=B+j;for(I=0;I<C;I++)if(_=K.charCodeAt(I),_<128)W[v++]=_;else if(_<2048)W[v++]=_>>6|192,W[v++]=_&63|128;else if((_&64512)===55296&&((g=K.charCodeAt(I+1))&64512)===56320)_=65536+((_&1023)<<10)+(g&1023),I++,W[v++]=_>>18|240,W[v++]=_>>12&63|128,W[v++]=_>>6&63|128,W[v++]=_&63|128;else W[v++]=_>>12|224,W[v++]=_>>6&63|128,W[v++]=_&63|128;O=v-B-j}else O=Y(K,B+j,w);if(O<24)W[B++]=96|O;else if(O<256){if(j<2)W.copyWithin(B+2,B+1,B+1+O);W[B++]=120,W[B++]=O}else if(O<65536){if(j<3)W.copyWithin(B+3,B+2,B+2+O);W[B++]=121,W[B++]=O>>8,W[B++]=O&255}else{if(j<5)W.copyWithin(B+5,B+3,B+3+O);W[B++]=122,i.setUint32(B,O),B+=4}B+=O}else if(L==="number")if(!this.alwaysUseFloat&&K>>>0===K)if(K<24)W[B++]=K;else if(K<256)W[B++]=24,W[B++]=K;else if(K<65536)W[B++]=25,W[B++]=K>>8,W[B++]=K&255;else W[B++]=26,i.setUint32(B,K),B+=4;else if(!this.alwaysUseFloat&&K>>0===K)if(K>=-24)W[B++]=31-K;else if(K>=-256)W[B++]=56,W[B++]=~K;else if(K>=-65536)W[B++]=57,i.setUint16(B,~K),B+=2;else W[B++]=58,i.setUint32(B,~K),B+=4;else{let C;if((C=this.useFloat32)>0&&K<4294967296&&K>=-2147483648){W[B++]=250,i.setFloat32(B,K);let j;if(C<4||(j=K*k8[(W[B]&127)<<1|W[B+1]>>7])>>0===j){B+=4;return}else B--}W[B++]=251,i.setFloat64(B,K),B+=8}else if(L==="object")if(!K)W[B++]=246;else{if(Q){let j=Q.get(K);if(j){if(W[B++]=216,W[B++]=29,W[B++]=25,!j.references){let w=Q.idsToInsert||(Q.idsToInsert=[]);j.references=[],w.push(j)}j.references.push(B-X),B+=2;return}else Q.set(K,{offset:B-X})}let C=K.constructor;if(C===Object)k(K);else if(C===Array){if(O=K.length,O<24)W[B++]=128|O;else A0(O);for(let j=0;j<O;j++)x(K[j])}else if(C===Map){if(this.mapsAsObjects?this.useTag259ForMaps!==!1:this.useTag259ForMaps)W[B++]=217,W[B++]=1,W[B++]=3;if(O=K.size,O<24)W[B++]=160|O;else if(O<256)W[B++]=184,W[B++]=O;else if(O<65536)W[B++]=185,W[B++]=O>>8,W[B++]=O&255;else W[B++]=186,i.setUint32(B,O),B+=4;if(U.keyMap)for(let[j,w]of K)x(U.encodeKey(j)),x(w);else for(let[j,w]of K)x(j),x(w)}else{for(let j=0,w=C4.length;j<w;j++){let I=RZ[j];if(K instanceof I){let _=C4[j],g=_.tag;if(g==null)g=_.getTag&&_.getTag.call(this,K);if(g<24)W[B++]=192|g;else if(g<256)W[B++]=216,W[B++]=g;else if(g<65536)W[B++]=217,W[B++]=g>>8,W[B++]=g&255;else if(g>-1)W[B++]=218,i.setUint32(B,g),B+=4;_.encode.call(this,K,x,a);return}}if(K[Symbol.iterator]){if(O4){let j=new Error("Iterable should be serialized as iterator");throw j.iteratorNotHandled=!0,j}W[B++]=159;for(let j of K)x(j);W[B++]=255;return}if(K[Symbol.asyncIterator]||M4(K)){let j=new Error("Iterable/blob should be serialized as iterator");throw j.iteratorNotHandled=!0,j}if(this.useToJSON&&K.toJSON){let j=K.toJSON();if(j!==K)return x(j)}k(K)}}else if(L==="boolean")W[B++]=K?245:244;else if(L==="bigint"){if(K<BigInt(1)<<BigInt(64)&&K>=0)W[B++]=27,i.setBigUint64(B,K);else if(K>-(BigInt(1)<<BigInt(64))&&K<0)W[B++]=59,i.setBigUint64(B,-K-BigInt(1));else if(this.largeBigIntToFloat)W[B++]=251,i.setFloat64(B,Number(K));else{if(K>=BigInt(0))W[B++]=194;else W[B++]=195,K=BigInt(-1)-K;let C=[];while(K)C.push(Number(K&BigInt(255))),K>>=BigInt(8);N4(new Uint8Array(C.reverse()),a);return}B+=8}else if(L==="undefined")W[B++]=247;else throw new Error("Unknown type: "+L)},k=this.useRecords===!1?this.variableMapSize?(K)=>{let L=Object.keys(K),O=Object.values(K),C=L.length;if(C<24)W[B++]=160|C;else if(C<256)W[B++]=184,W[B++]=C;else if(C<65536)W[B++]=185,W[B++]=C>>8,W[B++]=C&255;else W[B++]=186,i.setUint32(B,C),B+=4;let j;if(U.keyMap)for(let w=0;w<C;w++)x(U.encodeKey(L[w])),x(O[w]);else for(let w=0;w<C;w++)x(L[w]),x(O[w])}:(K)=>{W[B++]=185;let L=B-X;B+=2;let O=0;if(U.keyMap){for(let C in K)if(typeof K.hasOwnProperty!=="function"||K.hasOwnProperty(C))x(U.encodeKey(C)),x(K[C]),O++}else for(let C in K)if(typeof K.hasOwnProperty!=="function"||K.hasOwnProperty(C))x(C),x(K[C]),O++;W[L+++X]=O>>8,W[L+X]=O&255}:(K,L)=>{let O,C=G.transitions||(G.transitions=Object.create(null)),j=0,w=0,I,_;if(this.keyMap){_=Object.keys(K).map((v)=>this.encodeKey(v)),w=_.length;for(let v=0;v<w;v++){let B0=_[v];if(O=C[B0],!O)O=C[B0]=Object.create(null),j++;C=O}}else for(let v in K)if(typeof K.hasOwnProperty!=="function"||K.hasOwnProperty(v)){if(O=C[v],!O){if(C[D0]&1048576)I=C[D0]&65535;O=C[v]=Object.create(null),j++}C=O,w++}let g=C[D0];if(g!==void 0)g&=65535,W[B++]=217,W[B++]=g>>8|224,W[B++]=g&255;else{if(!_)_=C.__keys__||(C.__keys__=Object.keys(K));if(I===void 0){if(g=G.nextId++,!g)g=0,G.nextId=1;if(g>=OZ)G.nextId=(g=H)+1}else g=I;if(G[g]=_,g<H){W[B++]=217,W[B++]=g>>8|224,W[B++]=g&255,C=G.transitions;for(let v=0;v<w;v++){if(C[D0]===void 0||C[D0]&1048576)C[D0]=g;C=C[_[v]]}C[D0]=g|1048576,q=!0}else{if(C[D0]=g,i.setUint32(B,3655335680),B+=3,j)S+=f*j;if(N.length>=OZ-H)N.shift()[D0]=void 0;if(N.push(C),A0(w+2),x(57344+g),x(_),L)return;for(let v in K)if(typeof K.hasOwnProperty!=="function"||K.hasOwnProperty(v))x(K[v]);return}}if(w<24)W[B++]=128|w;else A0(w);if(L)return;for(let v in K)if(typeof K.hasOwnProperty!=="function"||K.hasOwnProperty(v))x(K[v])},a=(K)=>{let L;if(K>16777216){if(K-X>MZ)throw new Error("Encoded buffer would be larger than maximum buffer size");L=Math.min(MZ,Math.round(Math.max((K-X)*(K>67108864?1.25:2),4194304)/4096)*4096)}else L=(Math.max(K-X<<2,W.length-1)>>12)+1<<12;let O=new D4(L);if(i=new DataView(O.buffer,0,L),W.copy)W.copy(O,0,X,K);else O.set(W.slice(X,K));return B-=X,X=0,E0=O.length-10,W=O},G0=100,l=1000;this.encodeAsIterable=function(K,L){return o(K,L,b)},this.encodeAsAsyncIterable=function(K,L){return o(K,L,m)};function*b(K,L,O){let C=K.constructor;if(C===Object){let j=U.useRecords!==!1;if(j)k(K,!0);else PZ(Object.keys(K).length,160);for(let w in K){let I=K[w];if(!j)x(w);if(I&&typeof I==="object")if(L[w])yield*b(I,L[w]);else yield*d(I,L,w);else x(I)}}else if(C===Array){let j=K.length;A0(j);for(let w=0;w<j;w++){let I=K[w];if(I&&(typeof I==="object"||B-X>G0))if(L.element)yield*b(I,L.element);else yield*d(I,L,"element");else x(I)}}else if(K[Symbol.iterator]&&!K.buffer){W[B++]=159;for(let j of K)if(j&&(typeof j==="object"||B-X>G0))if(L.element)yield*b(j,L.element);else yield*d(j,L,"element");else x(j);W[B++]=255}else if(M4(K))PZ(K.size,64),yield W.subarray(X,B),yield K,c();else if(K[Symbol.asyncIterator])W[B++]=159,yield W.subarray(X,B),yield K,c(),W[B++]=255;else x(K);if(O&&B>X)yield W.subarray(X,B);else if(B-X>G0)yield W.subarray(X,B),c()}function*d(K,L,O){let C=B-X;try{if(x(K),B-X>G0)yield W.subarray(X,B),c()}catch(j){if(j.iteratorNotHandled)L[O]={},B=X+C,yield*b.call(this,K,L[O]);else throw j}}function c(){G0=l,U.encode(null,P4)}function o(K,L,O){if(L&&L.chunkThreshold)G0=l=L.chunkThreshold;else G0=100;if(K&&typeof K==="object")return U.encode(null,P4),O(K,U.iterateProperties||(U.iterateProperties={}),!0);return[U.encode(K)]}async function*m(K,L){for(let O of b(K,L,!0)){let C=O.constructor;if(C===DZ||C===Uint8Array)yield O;else if(M4(O)){let j=O.stream().getReader(),w;while(!(w=await j.read()).done)yield w.value}else if(O[Symbol.asyncIterator])for await(let j of O)if(c(),j)yield*m(j,L.async||(L.async={}));else yield U.encode(j);else yield O}}}useBuffer($){W=$,i=new DataView(W.buffer,W.byteOffset,W.byteLength),B=0}clearSharedData(){if(this.structures)this.structures=[];if(this.sharedValues)this.sharedValues=void 0}updateSharedData(){let $=this.sharedVersion||0;this.sharedVersion=$+1;let Z=this.structures.slice(0),X=new L4(Z,this.sharedValues,this.sharedVersion),J=this.saveShared(X,(q)=>(q&&q.version||0)==$);if(J===!1)X=this.getShared()||{},this.structures=X.structures||[],this.sharedValues=X.packedValues,this.sharedVersion=X.version,this.structures.nextId=this.structures.length;else Z.forEach((q,G)=>this.structures[G]=q);return J}}function PZ($,Z){if($<24)W[B++]=Z|$;else if($<256)W[B++]=Z|24,W[B++]=$;else if($<65536)W[B++]=Z|25,W[B++]=$>>8,W[B++]=$&255;else W[B++]=Z|26,i.setUint32(B,$),B+=4}class L4{constructor($,Z,X){this.structures=$,this.packedValues=Z,this.version=X}}function A0($){if($<24)W[B++]=128|$;else if($<256)W[B++]=152,W[B++]=$;else if($<65536)W[B++]=153,W[B++]=$>>8,W[B++]=$&255;else W[B++]=154,i.setUint32(B,$),B+=4}var Wq=typeof Blob==="undefined"?function(){}:Blob;function M4($){if($ instanceof Wq)return!0;let Z=$[Symbol.toStringTag];return Z==="Blob"||Z==="File"}function y8($,Z){switch(typeof $){case"string":if($.length>3){if(Z.objectMap[$]>-1||Z.values.length>=Z.maxValues)return;let J=Z.get($);if(J){if(++J.count==2)Z.values.push($)}else if(Z.set($,{count:1}),Z.samplingPackedValues){let q=Z.samplingPackedValues.get($);if(q)q.count++;else Z.samplingPackedValues.set($,{count:1})}}break;case"object":if($)if($ instanceof Array)for(let J=0,q=$.length;J<q;J++)y8($[J],Z);else{let J=!Z.encoder.useRecords;for(var X in $)if($.hasOwnProperty(X)){if(J)y8(X,Z);y8($[X],Z)}}break;case"function":console.log($)}}var Dq=new Uint8Array(new Uint16Array([1]).buffer)[0]==1;RZ=[Date,Set,Error,RegExp,L0,ArrayBuffer,Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,typeof BigUint64Array=="undefined"?function(){}:BigUint64Array,Int8Array,Int16Array,Int32Array,typeof BigInt64Array=="undefined"?function(){}:BigInt64Array,Float32Array,Float64Array,L4];C4=[{tag:1,encode($,Z){let X=$.getTime()/1000;if((this.useTimestamp32||$.getMilliseconds()===0)&&X>=0&&X<4294967296)W[B++]=26,i.setUint32(B,X),B+=4;else W[B++]=251,i.setFloat64(B,X),B+=8}},{tag:258,encode($,Z){let X=Array.from($);Z(X)}},{tag:27,encode($,Z){Z([$.name,$.message])}},{tag:27,encode($,Z){Z(["RegExp",$.source,$.flags])}},{getTag($){return $.tag},encode($,Z){Z($.value)}},{encode($,Z,X){N4($,X)}},{getTag($){if($.constructor===Uint8Array){if(this.tagUint8Array||K8&&this.tagUint8Array!==!1)return 64}},encode($,Z,X){N4($,X)}},j0(68,1),j0(69,2),j0(70,4),j0(71,8),j0(72,1),j0(77,2),j0(78,4),j0(79,8),j0(85,4),j0(86,8),{encode($,Z){let X=$.packedValues||[],J=$.structures||[];if(X.values.length>0){W[B++]=216,W[B++]=51,A0(4);let q=X.values;Z(q),A0(0),A0(0),packedObjectMap=Object.create(sharedPackedObjectMap||null);for(let G=0,Q=q.length;G<Q;G++)packedObjectMap[q[G]]=G}if(J){i.setUint32(B,3655335424),B+=3;let q=J.slice(0);q.unshift(57344),q.push(new L0($.version,1399353956)),Z(q)}else Z(new L0($.version,1399353956))}}];function j0($,Z){if(!Dq&&Z>1)$-=4;return{tag:$,encode:function X(J,q){let G=J.byteLength,Q=J.byteOffset||0,Y=J.buffer||J;q(K8?h8.from(Y,Q,G):new Uint8Array(Y,Q,G))}}}function N4($,Z){let X=$.byteLength;if(X<24)W[B++]=64+X;else if(X<256)W[B++]=88,W[B++]=X;else if(X<65536)W[B++]=89,W[B++]=X>>8,W[B++]=X&255;else W[B++]=90,i.setUint32(B,X),B+=4;if(B+X>=W.length)Z(B+X);W.set($.buffer?$:new Uint8Array($),B),B+=X}function Oq($,Z){let X,J=Z.length*2,q=$.length-J;Z.sort((G,Q)=>G.offset>Q.offset?1:-1);for(let G=0;G<Z.length;G++){let Q=Z[G];Q.id=G;for(let Y of Q.references)$[Y++]=G>>8,$[Y]=G&255}while(X=Z.pop()){let G=X.offset;$.copyWithin(G+J,G,q),J-=2;let Q=G+J;$[Q++]=216,$[Q++]=28,q=G}return $}function CZ($,Z){i.setUint32(q0.position+$,B-q0.position-$+1);let X=q0;q0=null,Z(X[0]),Z(X[1])}var j4=new m8({useRecords:!1}),Mq=j4.encode,Pq=j4.encodeAsIterable,Cq=j4.encodeAsAsyncIterable;var R4=512,Nq=1024,P4=2048;var LZ="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",Rq="eddsa-jcs-2022",Lq=237,jq=4608;function A4($){return Array.from($).map((Z)=>Z.toString(16).padStart(2,"0")).join("")}function jZ($){let Z=new Uint8Array($.length/2);for(let X=0;X<Z.length;X++)Z[X]=parseInt($.substring(X*2,X*2+2),16);return Z}function Aq($){if($.length===0)return"";let Z=[0];for(let q of $){let G=q;for(let Q=0;Q<Z.length;Q++){let Y=Z[Q]*256+G;Z[Q]=Y%58,G=Math.floor(Y/58)}while(G>0)Z.push(G%58),G=Math.floor(G/58)}let X=0;for(let q of $){if(q!==0)break;X+=1}let J=LZ[0].repeat(X);for(let q=Z.length-1;q>=0;q--)J+=LZ[Z[q]];return J}function wZ($){return`z${Aq($)}`}function wq($){let Z=[],X=$;while(X>=128)Z.push(X&127|128),X>>=7;return Z.push(X),new Uint8Array(Z)}function Iq($,Z){let J=wq(Z==="p256"?jq:Lq),q=new Uint8Array(J.length+$.length);return q.set(J,0),q.set($,J.length),`did:key:${wZ(q)}`}class IZ{usePasskey=!0;credentialId=null;publicKey=null;publicKeyType="ed25519";edPrivateKey=null;constructor(){this.loadKey()}loadKey(){if(typeof localStorage==="undefined")return;let $=localStorage.getItem("weba_passkey_id"),Z=localStorage.getItem("weba_passkey_pub");if($&&Z){this.credentialId=$,this.publicKey=jZ(Z),this.publicKeyType="p256",this.usePasskey=!0;return}let X=localStorage.getItem("weba_private_key");if(X)this.edPrivateKey=jZ(X),this.publicKeyType="ed25519",this.usePasskey=!1}resetKey(){if(typeof localStorage!=="undefined")localStorage.removeItem("weba_passkey_id"),localStorage.removeItem("weba_passkey_pub"),localStorage.removeItem("weba_private_key");this.credentialId=null,this.publicKey=null,this.edPrivateKey=null}async register(){try{let $=prompt("Enter a name for this Passkey:","demo-user")||"User";console.log(`Registering Passkey for ${$}...`);let Z=await t$($),X=new Uint8Array(Z.response.attestationObject),q=b8(X).authData,G=new DataView(q.buffer,q.byteOffset,q.byteLength),Q=53,Y=G.getUint16(Q);Q+=2,Q+=Y;let U=q.slice(Q),z=b8(U),H=z.get(-2),F=z.get(-3);if(!H||!F)throw new Error("Invalid COSE Key: x or y missing");let V=new Uint8Array(65);if(V[0]=4,V.set(H,1),V.set(F,33),this.credentialId=Z.rawId,this.publicKey=V,this.publicKeyType="p256",this.usePasskey=!0,typeof localStorage!=="undefined")localStorage.setItem("weba_passkey_id",this.credentialId),localStorage.setItem("weba_passkey_pub",A4(this.publicKey));return console.log("Passkey Registered:",this.credentialId),!0}catch($){return console.warn("Passkey registration failed, falling back to Ed25519",$),this.generateEdKey(),!1}}async generateEdKey(){let{initWasm:$,ed25519GenerateKeyPair:Z}=await Promise.resolve().then(() => (d0(),X4));await $(fetch("/assets/weba_crypto_wasm_bg.wasm"));let{privateKey:X,publicKey:J}=Z();if(this.edPrivateKey=X,this.publicKey=J,this.publicKeyType="ed25519",this.usePasskey=!1,typeof localStorage!=="undefined")localStorage.setItem("weba_private_key",A4(this.edPrivateKey))}getIssuerDid(){if(!this.publicKey)return"";return Iq(this.publicKey,this.publicKeyType)}getPublicKey(){return this.publicKey?A4(this.publicKey):""}async sign($,Z="authentication"){if(!this.publicKey)await this.register();let X=AZ.default($),J=new TextEncoder().encode(X);if(this.usePasskey&&this.credentialId){let q=await crypto.subtle.digest("SHA-256",J),G=await e$(this.credentialId,q);return{...$,proof:{type:"PasskeySignature2025",created:new Date().toISOString(),verificationMethod:this.getIssuerDid(),proofPurpose:Z,proofValue:G.signature,"srn:authenticatorData":G.authenticatorData,"srn:clientDataJSON":G.clientDataJSON,"srn:credentialId":G.id}}}else{if(!this.edPrivateKey)await this.generateEdKey();let{initWasm:q,ed25519Sign:G}=await Promise.resolve().then(() => (d0(),X4));await q(fetch("/assets/weba_crypto_wasm_bg.wasm"));let Q=G(this.edPrivateKey,J);return{...$,proof:{type:"DataIntegrityProof",cryptosuite:Rq,created:new Date().toISOString(),verificationMethod:this.getIssuerDid(),proofPurpose:Z,proofValue:wZ(Q)}}}}async derivePrf($){if(!this.credentialId)return null;try{return await c0(this.credentialId,$)}catch(Z){return console.error("PRF derivation failed",Z),null}}}var V8=new IZ;var r={_context:{masterData:{}},setMasterData($){this._context.masterData=$},escapeHtml($){if(!$)return"";return $.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},formatHint($){return this.escapeHtml($).replace(/&lt;br\s*\/?&gt;/gi,"<br>").replace(/\r?\n/g,"<br>")},getStyle($){if(!$)return"";let Z="";if($.includes("size:L"))Z+="font-size: 1.25em;";if($.includes("size:S"))Z+="font-size: 0.8em;";if($.includes("size:XL"))Z+="font-size: 1.5em; font-weight: bold;";if($.includes("align:R"))Z+="text-align: right;";if($.includes("align:C"))Z+="text-align: center;";if($.includes("bold"))Z+="font-weight: bold;";return Z},getSemanticAttrs($,Z){if(!Z)return"";let X="",J=$.toLowerCase();if(J.includes("phone")||J.includes("tel")||J.includes(""))X+=' type="tel" inputmode="tel" autocomplete="tel"';else if(J.includes("email")||J.includes("mail")||J.includes(""))X+=' type="email" inputmode="email" autocomplete="email"';else if(J.includes("zip")||J.includes("postal")||J.includes(""))X+=' inputmode="numeric" autocomplete="postal-code"';else if(J.includes("name")||J.includes("")||J.includes(""))if(J.includes("sei")||J.includes("")||J.includes("family"))X+=' autocomplete="family-name"';else if(J.includes("mei")||J.includes("")||J.includes("given"))X+=' autocomplete="given-name"';else X+=' autocomplete="name"';else if(J.includes("company")||J.includes("organization")||J.includes("")||J.includes(""))X+=' autocomplete="organization"';else if(J.includes("address")||J.includes(""))if(J.includes("1")||J.includes("line1"))X+=' autocomplete="address-line1"';else if(J.includes("2")||J.includes("line2"))X+=' autocomplete="address-line2"';else X+=' autocomplete="street-address"';else if(J.includes("pref")||J.includes("")||J.includes("state"))X+=' autocomplete="address-level1"';else if(J.includes("city")||J.includes(""))X+=' autocomplete="address-level2"';let q=(Z||"").match(/autocomplete="([^"]+)"/)||(Z||"").match(/autocomplete='([^']+)'/);if(q)X=X.replace(/autocomplete="[^"]*"/,""),X+=` autocomplete="${q[1]}"`;let G=(Z||"").match(/inputmode="([^"]+)"/)||(Z||"").match(/inputmode='([^']+)'/);if(G)X=X.replace(/inputmode="[^"]*"/,""),X+=` inputmode="${G[1]}"`;return X},getExtraAttrs($){if(!$)return"";let Z="",X=$.match(/(?:len|max):(\d+)/);if(X)Z+=` maxlength="${X[1]}"`;let J=$.match(/(?:val|value)="([^"]+)"/);if(J)Z+=` value="${this.escapeHtml(J[1])}"`;else{let z=$.match(/(?:val|value)=([^\s\)]+)/);if(z)Z+=` value="${this.escapeHtml(z[1])}"`}let q=$.match(/context="([^"]+)"/)||$.match(/context='([^']+)'/);if(q)Z+=` data-context="${this.escapeHtml(q[1])}"`;let G=$.match(/property="([^"]+)"/)||$.match(/property='([^']+)'/);if(G)Z+=` data-property="${this.escapeHtml(G[1])}"`;let Q=$.match(/show_if="([^"]+)"/)||$.match(/show_if='([^']+)'/);if(Q)Z+=` data-show-if="${this.escapeHtml(Q[1])}"`;let Y=$.match(/autofill:([a-z:]+)/);if(Y)Z+=` data-autofill="${this.escapeHtml(Y[1])}"`;return["min","max","step","pattern","required","readonly","disabled","minlength","maxlength"].forEach((z)=>{let H=$.match(new RegExp(`${z}="([^"]+)"`))||$.match(new RegExp(`${z}='([^']+)'`))||$.match(new RegExp(`${z}=([^\\s\\)]+)`));if(H)Z+=` ${z}="${this.escapeHtml(H[1])}"`;else if(new RegExp(`\\b${z}\\b`).test($))Z+=` ${z}`}),Z},text:function($,Z,X){let J=(X||"").match(/(?:val|value)="([^"]+)"/)||(X||"").match(/(?:val|value)='([^']+)'/)||(X||"").match(/(?:val|value)=([^ ]+)/),q=(X||"").match(/placeholder="([^"]+)"/)||(X||"").match(/placeholder='([^']+)'/),G=(X||"").match(/hint="([^"]+)"/)||(X||"").match(/hint='([^']+)'/),Q=J?J[1]:"",Y=q?q[1]:"",U=(X||"").match(/context="([^"]+)"/)||(X||"").match(/context='([^']+)'/),z=G?G[1]:U?U[1]:"",H=z?`<div class="form-hint">${this.formatHint(z)}</div>`:"",F=this.getSemanticAttrs($,X);return`
        <div class="form-row" style="${this.getStyle(X)}">
            <label class="form-label">${this.escapeHtml(Z)}</label>
            <input ${F?F:'type="text"'} class="form-input" data-json-path="${$}" value="${this.escapeHtml(Q)}" placeholder="${this.escapeHtml(Y)}" style="${this.getStyle(X)}"${this.getExtraAttrs(X)}>
            ${H}
        </div>`},number:function($,Z,X){let J=(X||"").match(/placeholder="([^"]+)"/)||(X||"").match(/placeholder='([^']+)'/),q=(X||"").match(/hint="([^"]+)"/)||(X||"").match(/hint='([^']+)'/),G=J?J[1]:"",Q=(X||"").match(/context="([^"]+)"/)||(X||"").match(/context='([^']+)'/),Y=q?q[1]:Q?Q[1]:"",U=Y?`<div class="form-row"><div class="form-hint">${this.formatHint(Y)}</div></div>`:"";return`
        <div class="form-row">
            <label class="form-label">${this.escapeHtml(Z)}</label>
            <input type="number" inputmode="decimal" class="form-input" data-json-path="${$}" placeholder="${this.escapeHtml(G)}" style="${this.getStyle(X)}"${this.getExtraAttrs(X)}>
            ${U}
        </div>`},date:function($,Z,X){return`
        <div class="form-row">
            <label class="form-label">${this.escapeHtml(Z)}</label>
            <input type="date" class="form-input" data-json-path="${$}" style="${this.getStyle(X)}"${this.getExtraAttrs(X)}>
        </div>`},textarea:function($,Z,X){let J=(X||"").match(/placeholder="([^"]+)"/)||(X||"").match(/placeholder='([^']+)'/),q=(X||"").match(/hint="([^"]+)"/)||(X||"").match(/hint='([^']+)'/),G=J?J[1]:"",Q=(X||"").match(/context="([^"]+)"/)||(X||"").match(/context='([^']+)'/),Y=q?q[1]:Q?Q[1]:"",U=Y?`<div class="form-hint">${this.formatHint(Y)}</div>`:"",z=(X||"").match(/(?:val|value)="([^"]+)"/)||(X||"").match(/(?:val|value)='([^']+)'/)||(X||"").match(/(?:val|value)=([^ ]+)/),H=z?z[1]:"";return`
        <div class="form-row vertical" style="${this.getStyle(X)}">
            <label class="form-label">${this.escapeHtml(Z)}</label>
            <textarea class="form-input" rows="5" data-json-path="${$}" placeholder="${this.escapeHtml(G)}" style="${this.getStyle(X)}"${this.getExtraAttrs(X)}>${this.escapeHtml(H)}</textarea>
            ${U}
        </div>`},radioStart:function($,Z,X){return`
        <div class="form-row vertical" style="${this.getStyle(X)}">
            <label class="form-label">${this.escapeHtml(Z)}</label>
            <div class="radio-group" style="padding-left: 10px;">`},radioOption:function($,Z,X,J){return`
            <label style="display:block; margin-bottom:5px;">
                <input type="radio" name="${$}" value="${this.escapeHtml(Z)}" ${J?"checked":""}> ${this.escapeHtml(X)}
            </label>`},calc:function($,Z,X){let J=(X||"").match(/formula="([^"]+)"/)||(X||"").match(/formula='([^']+)'/),q=J?J[1]:"";return`
        <div class="form-row">
            <label class="form-label">${this.escapeHtml(Z)}</label>
            <input type="text" readonly class="form-input" data-json-path="${$}" data-formula="${this.escapeHtml(q)}" style="background:#f9f9f9; ${this.getStyle(X)}"${this.getExtraAttrs(X)}>
        </div>`},search:function($,Z,X){let J=(X||"").match(/src:([^\s)]+)/),q=(X||"").match(/label:(\d+)/),G=(X||"").match(/value:(\d+)/),Q=(X||"").match(/placeholder="([^"]+)"/)||(X||"").match(/placeholder='([^']+)'/),Y=(X||"").match(/hint="([^"]+)"/)||(X||"").match(/hint='([^']+)'/),U=J?J[1]:"",z=Q?Q[1]:"",H=Y?`<div class="form-hint">${this.formatHint(Y[1])}</div>`:"",F=q?` data-master-label-index="${q[1]}"`:"",V=G?` data-master-value-index="${G[1]}"`:"";return`
        <div class="form-row autocomplete-container" style="position:relative; z-index:100;">
            <label class="form-label">${this.escapeHtml(Z)}</label>
            <div style="flex:1; position:relative;">
                <input type="text" class="form-input search-input" autocomplete="off" 
                    data-json-path="${$}" 
                    data-master-src="${U}"${F}${V}
                    placeholder="${this.escapeHtml(z)}" 
                    style="${this.getStyle(X)}"${this.getExtraAttrs(X)}>
                <div class="search-suggestions" style="display:none; position:absolute; top:100%; left:0; width:100%; background:white; border:1px solid #ccc; max-height:200px; overflow-y:auto; box-shadow:0 4px 6px rgba(0,0,0,0.1); border-radius:0 0 4px 4px; z-index:1001;"></div>
            </div>
            ${H}
        </div>`},renderInput($,Z,X,J=!1){let q=(X||"").match(/placeholder="([^"]+)"/)||(X||"").match(/placeholder='([^']+)'/),G=q?`placeholder="${this.escapeHtml(q[1])}"`:"",Q=J?"form-input template-input":"form-input",Y=J?`data-base-key="${Z}"`:`data-json-path="${Z}"`;if($==="calc"){let P=(X||"").match(/formula="([^"]+)"/)||(X||"").match(/formula='([^']+)'/),A=P?P[1]:"";return`<input type="text" readonly class="${Q}" ${Y} data-formula="${this.escapeHtml(A)}" style="background:#f9f9f9; text-align:right; ${this.getStyle(X)}"${this.getExtraAttrs(X)}>`}if($==="datalist"){let P=(X||"").match(/src:([a-zA-Z0-9_\-\u0080-\uFFFF]+)/),A=(X||"").match(/label:(\d+)/),N="",S=P?P[1]:"";if(S&&this._context.masterData&&this._context.masterData[S]){let x=this._context.masterData[S],k=A?parseInt(A[1]||"1")-1:1;x.forEach((a)=>{if(a.length>k)N+=`<option value="${this.escapeHtml(a[k]||"")}"></option>`})}let f="list_"+Z+"_"+Math.floor(Math.random()*1e4);return`<input type="text" list="${f}" class="${Q}" ${Y} ${G} style="${this.getStyle(X)}"${this.getExtraAttrs(X)}><datalist id="${f}">${N}</datalist>`}if($==="search"){let P=(X||"").match(/src:([a-zA-Z0-9_\-\u0080-\uFFFF]+)/),A=(X||"").match(/label:(\d+)/),N=(X||"").match(/value:(\d+)/),S=P?P[1]:"",f=A?` data-master-label-index="${A[1]}"`:"",x=N?` data-master-value-index="${N[1]}"`:"",k=Q+" search-input",a="";if((X||"").includes("suggest:column"))a=' data-suggest-source="column"';let G0=(X||"").match(/copy:([^\s)]+)/),l=G0?` data-copy-from="${G0[1]}"`:"";return`<div style="display:inline-block; position:relative; width: 100%; min-width: 100px;">
                        <input type="text" class="${k}" ${Y} autocomplete="off" data-master-src="${S}"${f}${x} ${G} style="${G0?"background-color: #ffffea;":""} ${this.getStyle(X)}"${this.getExtraAttrs(X)}${a}${l}>
                    </div>`}if($==="number"){let P=(X||"").match(/copy:([^\s)]+)/),A=P?` data-copy-from="${P[1]}"`:"";return`<input type="number" class="${Q}" ${Y} ${G} style="text-align:right; ${P?"background-color: #ffffea;":""} ${this.getStyle(X)}"${this.getExtraAttrs(X)}${A}>`}if($==="date")return`<input type="date" class="${Q}" ${Y} style="${this.getStyle(X)}"${this.getExtraAttrs(X)}>`;if($==="checkbox")return`<input type="checkbox" class="${Q}" ${Y} style="${this.getStyle(X)}"${this.getExtraAttrs(X)}>`;if($==="autonum"||(X||"").includes("autonum"))return`<input type="number" readonly class="${Q+" auto-num"}" ${Y} data-autonum="true" style="background:transparent; border:none; text-align:center; width:100%; font-weight:bold; cursor:default; ${this.getStyle(X)}"${this.getExtraAttrs(X)}>`;let U="",z="";if((X||"").includes("suggest:column"))z=" search-input",U=' data-suggest-source="column"';let H=(X||"").match(/copy:([^\s)]+)/),F=H?` data-copy-from="${H[1]}"`:"",V=H?"background-color: #ffffea;":"",D=this.getSemanticAttrs(Z,X);return`<input ${D?D:'type="text"'} class="${Q}${z}" ${Y} ${G} style="${V} ${this.getStyle(X)}"${this.getExtraAttrs(X)}${U}${F}>`},tableRow($,Z=!1){let X=$.map((J)=>{let q=J.trim(),G=q.match(/^\[(?:([a-z]+):)?([^\]:\(\)]+)(?:\s*\((.*)\)|:([^\]]+))?\]$/);if(G){let[Q,Y,U,z,H]=G,F=(U||"").trim(),V=z||H||"";if(F.includes(" ")){let P=F.split(/\s+/);F=P[0],V=P.slice(1).join(" ")+" "+V}return`<td>${this.renderInput(Y||"text",F,V,Z)}</td>`}else return`<td>${this.escapeHtml(q)}</td>`}).join("");return`<tr ${Z?'class="template-row"':""}>${X}</tr>`}};/*! js-yaml 4.1.1 https://github.com/nodeca/js-yaml @license MIT */function dZ($){return typeof $==="undefined"||$===null}function fq($){return typeof $==="object"&&$!==null}function Tq($){if(Array.isArray($))return $;else if(dZ($))return[];return[$]}function xq($,Z){var X,J,q,G;if(Z){G=Object.keys(Z);for(X=0,J=G.length;X<J;X+=1)q=G[X],$[q]=Z[q]}return $}function Eq($,Z){var X="",J;for(J=0;J<Z;J+=1)X+=$;return X}function vq($){return $===0&&Number.NEGATIVE_INFINITY===1/$}var Sq=dZ,_q=fq,kq=Tq,bq=Eq,gq=vq,yq=xq,Q0={isNothing:Sq,isObject:_q,toArray:kq,repeat:bq,isNegativeZero:gq,extend:yq};function lZ($,Z){var X="",J=$.reason||"(unknown reason)";if(!$.mark)return J;if($.mark.name)X+='in "'+$.mark.name+'" ';if(X+="("+($.mark.line+1)+":"+($.mark.column+1)+")",!Z&&$.mark.snippet)X+=`

`+$.mark.snippet;return J+" "+X}function D8($,Z){if(Error.call(this),this.name="YAMLException",this.reason=$,this.mark=Z,this.message=lZ(this,!1),Error.captureStackTrace)Error.captureStackTrace(this,this.constructor);else this.stack=new Error().stack||""}D8.prototype=Object.create(Error.prototype);D8.prototype.constructor=D8;D8.prototype.toString=function $(Z){return this.name+": "+lZ(this,Z)};var H0=D8;function w4($,Z,X,J,q){var G="",Q="",Y=Math.floor(q/2)-1;if(J-Z>Y)G=" ... ",Z=J-Y+G.length;if(X-J>Y)Q=" ...",X=J+Y-Q.length;return{str:G+$.slice(Z,X).replace(/\t/g,"")+Q,pos:J-Z+G.length}}function I4($,Z){return Q0.repeat(" ",Z-$.length)+$}function hq($,Z){if(Z=Object.create(Z||null),!$.buffer)return null;if(!Z.maxLength)Z.maxLength=79;if(typeof Z.indent!=="number")Z.indent=1;if(typeof Z.linesBefore!=="number")Z.linesBefore=3;if(typeof Z.linesAfter!=="number")Z.linesAfter=2;var X=/\r?\n|\r|\0/g,J=[0],q=[],G,Q=-1;while(G=X.exec($.buffer))if(q.push(G.index),J.push(G.index+G[0].length),$.position<=G.index&&Q<0)Q=J.length-2;if(Q<0)Q=J.length-1;var Y="",U,z,H=Math.min($.line+Z.linesAfter,q.length).toString().length,F=Z.maxLength-(Z.indent+H+3);for(U=1;U<=Z.linesBefore;U++){if(Q-U<0)break;z=w4($.buffer,J[Q-U],q[Q-U],$.position-(J[Q]-J[Q-U]),F),Y=Q0.repeat(" ",Z.indent)+I4(($.line-U+1).toString(),H)+" | "+z.str+`
`+Y}z=w4($.buffer,J[Q],q[Q],$.position,F),Y+=Q0.repeat(" ",Z.indent)+I4(($.line+1).toString(),H)+" | "+z.str+`
`,Y+=Q0.repeat("-",Z.indent+H+3+z.pos)+`^
`;for(U=1;U<=Z.linesAfter;U++){if(Q+U>=q.length)break;z=w4($.buffer,J[Q+U],q[Q+U],$.position-(J[Q]-J[Q+U]),F),Y+=Q0.repeat(" ",Z.indent)+I4(($.line+U+1).toString(),H)+" | "+z.str+`
`}return Y.replace(/\n$/,"")}var mq=hq,uq=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],pq=["scalar","sequence","mapping"];function dq($){var Z={};if($!==null)Object.keys($).forEach(function(X){$[X].forEach(function(J){Z[String(J)]=X})});return Z}function lq($,Z){if(Z=Z||{},Object.keys(Z).forEach(function(X){if(uq.indexOf(X)===-1)throw new H0('Unknown option "'+X+'" is met in definition of "'+$+'" YAML type.')}),this.options=Z,this.tag=$,this.kind=Z.kind||null,this.resolve=Z.resolve||function(){return!0},this.construct=Z.construct||function(X){return X},this.instanceOf=Z.instanceOf||null,this.predicate=Z.predicate||null,this.represent=Z.represent||null,this.representName=Z.representName||null,this.defaultStyle=Z.defaultStyle||null,this.multi=Z.multi||!1,this.styleAliases=dq(Z.styleAliases||null),pq.indexOf(this.kind)===-1)throw new H0('Unknown kind "'+this.kind+'" is specified for "'+$+'" YAML type.')}var U0=lq;function fZ($,Z){var X=[];return $[Z].forEach(function(J){var q=X.length;X.forEach(function(G,Q){if(G.tag===J.tag&&G.kind===J.kind&&G.multi===J.multi)q=Q}),X[q]=J}),X}function cq(){var $={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},Z,X;function J(q){if(q.multi)$.multi[q.kind].push(q),$.multi.fallback.push(q);else $[q.kind][q.tag]=$.fallback[q.tag]=q}for(Z=0,X=arguments.length;Z<X;Z+=1)arguments[Z].forEach(J);return $}function T4($){return this.extend($)}T4.prototype.extend=function $(Z){var X=[],J=[];if(Z instanceof U0)J.push(Z);else if(Array.isArray(Z))J=J.concat(Z);else if(Z&&(Array.isArray(Z.implicit)||Array.isArray(Z.explicit))){if(Z.implicit)X=X.concat(Z.implicit);if(Z.explicit)J=J.concat(Z.explicit)}else throw new H0("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");X.forEach(function(G){if(!(G instanceof U0))throw new H0("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(G.loadKind&&G.loadKind!=="scalar")throw new H0("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(G.multi)throw new H0("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),J.forEach(function(G){if(!(G instanceof U0))throw new H0("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var q=Object.create(T4.prototype);return q.implicit=(this.implicit||[]).concat(X),q.explicit=(this.explicit||[]).concat(J),q.compiledImplicit=fZ(q,"implicit"),q.compiledExplicit=fZ(q,"explicit"),q.compiledTypeMap=cq(q.compiledImplicit,q.compiledExplicit),q};var cZ=T4,nZ=new U0("tag:yaml.org,2002:str",{kind:"scalar",construct:function($){return $!==null?$:""}}),oZ=new U0("tag:yaml.org,2002:seq",{kind:"sequence",construct:function($){return $!==null?$:[]}}),iZ=new U0("tag:yaml.org,2002:map",{kind:"mapping",construct:function($){return $!==null?$:{}}}),rZ=new cZ({explicit:[nZ,oZ,iZ]});function nq($){if($===null)return!0;var Z=$.length;return Z===1&&$==="~"||Z===4&&($==="null"||$==="Null"||$==="NULL")}function oq(){return null}function iq($){return $===null}var sZ=new U0("tag:yaml.org,2002:null",{kind:"scalar",resolve:nq,construct:oq,predicate:iq,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});function rq($){if($===null)return!1;var Z=$.length;return Z===4&&($==="true"||$==="True"||$==="TRUE")||Z===5&&($==="false"||$==="False"||$==="FALSE")}function sq($){return $==="true"||$==="True"||$==="TRUE"}function aq($){return Object.prototype.toString.call($)==="[object Boolean]"}var aZ=new U0("tag:yaml.org,2002:bool",{kind:"scalar",resolve:rq,construct:sq,predicate:aq,represent:{lowercase:function($){return $?"true":"false"},uppercase:function($){return $?"TRUE":"FALSE"},camelcase:function($){return $?"True":"False"}},defaultStyle:"lowercase"});function tq($){return 48<=$&&$<=57||65<=$&&$<=70||97<=$&&$<=102}function eq($){return 48<=$&&$<=55}function $5($){return 48<=$&&$<=57}function Z5($){if($===null)return!1;var Z=$.length,X=0,J=!1,q;if(!Z)return!1;if(q=$[X],q==="-"||q==="+")q=$[++X];if(q==="0"){if(X+1===Z)return!0;if(q=$[++X],q==="b"){X++;for(;X<Z;X++){if(q=$[X],q==="_")continue;if(q!=="0"&&q!=="1")return!1;J=!0}return J&&q!=="_"}if(q==="x"){X++;for(;X<Z;X++){if(q=$[X],q==="_")continue;if(!tq($.charCodeAt(X)))return!1;J=!0}return J&&q!=="_"}if(q==="o"){X++;for(;X<Z;X++){if(q=$[X],q==="_")continue;if(!eq($.charCodeAt(X)))return!1;J=!0}return J&&q!=="_"}}if(q==="_")return!1;for(;X<Z;X++){if(q=$[X],q==="_")continue;if(!$5($.charCodeAt(X)))return!1;J=!0}if(!J||q==="_")return!1;return!0}function X5($){var Z=$,X=1,J;if(Z.indexOf("_")!==-1)Z=Z.replace(/_/g,"");if(J=Z[0],J==="-"||J==="+"){if(J==="-")X=-1;Z=Z.slice(1),J=Z[0]}if(Z==="0")return 0;if(J==="0"){if(Z[1]==="b")return X*parseInt(Z.slice(2),2);if(Z[1]==="x")return X*parseInt(Z.slice(2),16);if(Z[1]==="o")return X*parseInt(Z.slice(2),8)}return X*parseInt(Z,10)}function J5($){return Object.prototype.toString.call($)==="[object Number]"&&($%1===0&&!Q0.isNegativeZero($))}var tZ=new U0("tag:yaml.org,2002:int",{kind:"scalar",resolve:Z5,construct:X5,predicate:J5,represent:{binary:function($){return $>=0?"0b"+$.toString(2):"-0b"+$.toString(2).slice(1)},octal:function($){return $>=0?"0o"+$.toString(8):"-0o"+$.toString(8).slice(1)},decimal:function($){return $.toString(10)},hexadecimal:function($){return $>=0?"0x"+$.toString(16).toUpperCase():"-0x"+$.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),q5=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function Q5($){if($===null)return!1;if(!q5.test($)||$[$.length-1]==="_")return!1;return!0}function G5($){var Z,X;if(Z=$.replace(/_/g,"").toLowerCase(),X=Z[0]==="-"?-1:1,"+-".indexOf(Z[0])>=0)Z=Z.slice(1);if(Z===".inf")return X===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY;else if(Z===".nan")return NaN;return X*parseFloat(Z,10)}var Y5=/^[-+]?[0-9]+e/;function U5($,Z){var X;if(isNaN($))switch(Z){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===$)switch(Z){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===$)switch(Z){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(Q0.isNegativeZero($))return"-0.0";return X=$.toString(10),Y5.test(X)?X.replace("e",".e"):X}function z5($){return Object.prototype.toString.call($)==="[object Number]"&&($%1!==0||Q0.isNegativeZero($))}var eZ=new U0("tag:yaml.org,2002:float",{kind:"scalar",resolve:Q5,construct:G5,predicate:z5,represent:U5,defaultStyle:"lowercase"}),$X=rZ.extend({implicit:[sZ,aZ,tZ,eZ]}),ZX=$X,XX=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),JX=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function F5($){if($===null)return!1;if(XX.exec($)!==null)return!0;if(JX.exec($)!==null)return!0;return!1}function H5($){var Z,X,J,q,G,Q,Y,U=0,z=null,H,F,V;if(Z=XX.exec($),Z===null)Z=JX.exec($);if(Z===null)throw new Error("Date resolve error");if(X=+Z[1],J=+Z[2]-1,q=+Z[3],!Z[4])return new Date(Date.UTC(X,J,q));if(G=+Z[4],Q=+Z[5],Y=+Z[6],Z[7]){U=Z[7].slice(0,3);while(U.length<3)U+="0";U=+U}if(Z[9]){if(H=+Z[10],F=+(Z[11]||0),z=(H*60+F)*60000,Z[9]==="-")z=-z}if(V=new Date(Date.UTC(X,J,q,G,Q,Y,U)),z)V.setTime(V.getTime()-z);return V}function B5($){return $.toISOString()}var qX=new U0("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:F5,construct:H5,instanceOf:Date,represent:B5});function K5($){return $==="<<"||$===null}var QX=new U0("tag:yaml.org,2002:merge",{kind:"scalar",resolve:K5}),_4=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function V5($){if($===null)return!1;var Z,X,J=0,q=$.length,G=_4;for(X=0;X<q;X++){if(Z=G.indexOf($.charAt(X)),Z>64)continue;if(Z<0)return!1;J+=6}return J%8===0}function W5($){var Z,X,J=$.replace(/[\r\n=]/g,""),q=J.length,G=_4,Q=0,Y=[];for(Z=0;Z<q;Z++){if(Z%4===0&&Z)Y.push(Q>>16&255),Y.push(Q>>8&255),Y.push(Q&255);Q=Q<<6|G.indexOf(J.charAt(Z))}if(X=q%4*6,X===0)Y.push(Q>>16&255),Y.push(Q>>8&255),Y.push(Q&255);else if(X===18)Y.push(Q>>10&255),Y.push(Q>>2&255);else if(X===12)Y.push(Q>>4&255);return new Uint8Array(Y)}function D5($){var Z="",X=0,J,q,G=$.length,Q=_4;for(J=0;J<G;J++){if(J%3===0&&J)Z+=Q[X>>18&63],Z+=Q[X>>12&63],Z+=Q[X>>6&63],Z+=Q[X&63];X=(X<<8)+$[J]}if(q=G%3,q===0)Z+=Q[X>>18&63],Z+=Q[X>>12&63],Z+=Q[X>>6&63],Z+=Q[X&63];else if(q===2)Z+=Q[X>>10&63],Z+=Q[X>>4&63],Z+=Q[X<<2&63],Z+=Q[64];else if(q===1)Z+=Q[X>>2&63],Z+=Q[X<<4&63],Z+=Q[64],Z+=Q[64];return Z}function O5($){return Object.prototype.toString.call($)==="[object Uint8Array]"}var GX=new U0("tag:yaml.org,2002:binary",{kind:"scalar",resolve:V5,construct:W5,predicate:O5,represent:D5}),M5=Object.prototype.hasOwnProperty,P5=Object.prototype.toString;function C5($){if($===null)return!0;var Z=[],X,J,q,G,Q,Y=$;for(X=0,J=Y.length;X<J;X+=1){if(q=Y[X],Q=!1,P5.call(q)!=="[object Object]")return!1;for(G in q)if(M5.call(q,G))if(!Q)Q=!0;else return!1;if(!Q)return!1;if(Z.indexOf(G)===-1)Z.push(G);else return!1}return!0}function N5($){return $!==null?$:[]}var YX=new U0("tag:yaml.org,2002:omap",{kind:"sequence",resolve:C5,construct:N5}),R5=Object.prototype.toString;function L5($){if($===null)return!0;var Z,X,J,q,G,Q=$;G=new Array(Q.length);for(Z=0,X=Q.length;Z<X;Z+=1){if(J=Q[Z],R5.call(J)!=="[object Object]")return!1;if(q=Object.keys(J),q.length!==1)return!1;G[Z]=[q[0],J[q[0]]]}return!0}function j5($){if($===null)return[];var Z,X,J,q,G,Q=$;G=new Array(Q.length);for(Z=0,X=Q.length;Z<X;Z+=1)J=Q[Z],q=Object.keys(J),G[Z]=[q[0],J[q[0]]];return G}var UX=new U0("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:L5,construct:j5}),A5=Object.prototype.hasOwnProperty;function w5($){if($===null)return!0;var Z,X=$;for(Z in X)if(A5.call(X,Z)){if(X[Z]!==null)return!1}return!0}function I5($){return $!==null?$:{}}var zX=new U0("tag:yaml.org,2002:set",{kind:"mapping",resolve:w5,construct:I5}),k4=ZX.extend({implicit:[qX,QX],explicit:[GX,YX,UX,zX]}),_0=Object.prototype.hasOwnProperty,u8=1,FX=2,HX=3,p8=4,f4=1,f5=2,TZ=3,T5=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,x5=/[\x85\u2028\u2029]/,E5=/[,\[\]\{\}]/,BX=/^(?:!|!!|![a-z\-]+!)$/i,KX=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function xZ($){return Object.prototype.toString.call($)}function w0($){return $===10||$===13}function h0($){return $===9||$===32}function W0($){return $===9||$===32||$===10||$===13}function s0($){return $===44||$===91||$===93||$===123||$===125}function v5($){var Z;if(48<=$&&$<=57)return $-48;if(Z=$|32,97<=Z&&Z<=102)return Z-97+10;return-1}function S5($){if($===120)return 2;if($===117)return 4;if($===85)return 8;return 0}function _5($){if(48<=$&&$<=57)return $-48;return-1}function EZ($){return $===48?"\x00":$===97?"\x07":$===98?"\b":$===116?"\t":$===9?"\t":$===110?`
`:$===118?"\v":$===102?"\f":$===114?"\r":$===101?"\x1B":$===32?" ":$===34?'"':$===47?"/":$===92?"\\":$===78?"":$===95?"":$===76?"\u2028":$===80?"\u2029":""}function k5($){if($<=65535)return String.fromCharCode($);return String.fromCharCode(($-65536>>10)+55296,($-65536&1023)+56320)}function VX($,Z,X){if(Z==="__proto__")Object.defineProperty($,Z,{configurable:!0,enumerable:!0,writable:!0,value:X});else $[Z]=X}var WX=new Array(256),DX=new Array(256);for(v0=0;v0<256;v0++)WX[v0]=EZ(v0)?1:0,DX[v0]=EZ(v0);var v0;function b5($,Z){this.input=$,this.filename=Z.filename||null,this.schema=Z.schema||k4,this.onWarning=Z.onWarning||null,this.legacy=Z.legacy||!1,this.json=Z.json||!1,this.listener=Z.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=$.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function OX($,Z){var X={name:$.filename,buffer:$.input.slice(0,-1),position:$.position,line:$.line,column:$.position-$.lineStart};return X.snippet=mq(X),new H0(Z,X)}function E($,Z){throw OX($,Z)}function d8($,Z){if($.onWarning)$.onWarning.call(null,OX($,Z))}var vZ={YAML:function $(Z,X,J){var q,G,Q;if(Z.version!==null)E(Z,"duplication of %YAML directive");if(J.length!==1)E(Z,"YAML directive accepts exactly one argument");if(q=/^([0-9]+)\.([0-9]+)$/.exec(J[0]),q===null)E(Z,"ill-formed argument of the YAML directive");if(G=parseInt(q[1],10),Q=parseInt(q[2],10),G!==1)E(Z,"unacceptable YAML version of the document");if(Z.version=J[0],Z.checkLineBreaks=Q<2,Q!==1&&Q!==2)d8(Z,"unsupported YAML version of the document")},TAG:function $(Z,X,J){var q,G;if(J.length!==2)E(Z,"TAG directive accepts exactly two arguments");if(q=J[0],G=J[1],!BX.test(q))E(Z,"ill-formed tag handle (first argument) of the TAG directive");if(_0.call(Z.tagMap,q))E(Z,'there is a previously declared suffix for "'+q+'" tag handle');if(!KX.test(G))E(Z,"ill-formed tag prefix (second argument) of the TAG directive");try{G=decodeURIComponent(G)}catch(Q){E(Z,"tag prefix is malformed: "+G)}Z.tagMap[q]=G}};function S0($,Z,X,J){var q,G,Q,Y;if(Z<X){if(Y=$.input.slice(Z,X),J){for(q=0,G=Y.length;q<G;q+=1)if(Q=Y.charCodeAt(q),!(Q===9||32<=Q&&Q<=1114111))E($,"expected valid JSON character")}else if(T5.test(Y))E($,"the stream contains non-printable characters");$.result+=Y}}function SZ($,Z,X,J){var q,G,Q,Y;if(!Q0.isObject(X))E($,"cannot merge mappings; the provided source object is unacceptable");q=Object.keys(X);for(Q=0,Y=q.length;Q<Y;Q+=1)if(G=q[Q],!_0.call(Z,G))VX(Z,G,X[G]),J[G]=!0}function a0($,Z,X,J,q,G,Q,Y,U){var z,H;if(Array.isArray(q)){q=Array.prototype.slice.call(q);for(z=0,H=q.length;z<H;z+=1){if(Array.isArray(q[z]))E($,"nested arrays are not supported inside keys");if(typeof q==="object"&&xZ(q[z])==="[object Object]")q[z]="[object Object]"}}if(typeof q==="object"&&xZ(q)==="[object Object]")q="[object Object]";if(q=String(q),Z===null)Z={};if(J==="tag:yaml.org,2002:merge")if(Array.isArray(G))for(z=0,H=G.length;z<H;z+=1)SZ($,Z,G[z],X);else SZ($,Z,G,X);else{if(!$.json&&!_0.call(X,q)&&_0.call(Z,q))$.line=Q||$.line,$.lineStart=Y||$.lineStart,$.position=U||$.position,E($,"duplicated mapping key");VX(Z,q,G),delete X[q]}return Z}function b4($){var Z=$.input.charCodeAt($.position);if(Z===10)$.position++;else if(Z===13){if($.position++,$.input.charCodeAt($.position)===10)$.position++}else E($,"a line break is expected");$.line+=1,$.lineStart=$.position,$.firstTabInLine=-1}function Z0($,Z,X){var J=0,q=$.input.charCodeAt($.position);while(q!==0){while(h0(q)){if(q===9&&$.firstTabInLine===-1)$.firstTabInLine=$.position;q=$.input.charCodeAt(++$.position)}if(Z&&q===35)do q=$.input.charCodeAt(++$.position);while(q!==10&&q!==13&&q!==0);if(w0(q)){b4($),q=$.input.charCodeAt($.position),J++,$.lineIndent=0;while(q===32)$.lineIndent++,q=$.input.charCodeAt(++$.position)}else break}if(X!==-1&&J!==0&&$.lineIndent<X)d8($,"deficient indentation");return J}function n8($){var Z=$.position,X;if(X=$.input.charCodeAt(Z),(X===45||X===46)&&X===$.input.charCodeAt(Z+1)&&X===$.input.charCodeAt(Z+2)){if(Z+=3,X=$.input.charCodeAt(Z),X===0||W0(X))return!0}return!1}function g4($,Z){if(Z===1)$.result+=" ";else if(Z>1)$.result+=Q0.repeat(`
`,Z-1)}function g5($,Z,X){var J,q,G,Q,Y,U,z,H,F=$.kind,V=$.result,D;if(D=$.input.charCodeAt($.position),W0(D)||s0(D)||D===35||D===38||D===42||D===33||D===124||D===62||D===39||D===34||D===37||D===64||D===96)return!1;if(D===63||D===45){if(q=$.input.charCodeAt($.position+1),W0(q)||X&&s0(q))return!1}$.kind="scalar",$.result="",G=Q=$.position,Y=!1;while(D!==0){if(D===58){if(q=$.input.charCodeAt($.position+1),W0(q)||X&&s0(q))break}else if(D===35){if(J=$.input.charCodeAt($.position-1),W0(J))break}else if($.position===$.lineStart&&n8($)||X&&s0(D))break;else if(w0(D))if(U=$.line,z=$.lineStart,H=$.lineIndent,Z0($,!1,-1),$.lineIndent>=Z){Y=!0,D=$.input.charCodeAt($.position);continue}else{$.position=Q,$.line=U,$.lineStart=z,$.lineIndent=H;break}if(Y)S0($,G,Q,!1),g4($,$.line-U),G=Q=$.position,Y=!1;if(!h0(D))Q=$.position+1;D=$.input.charCodeAt(++$.position)}if(S0($,G,Q,!1),$.result)return!0;return $.kind=F,$.result=V,!1}function y5($,Z){var X,J,q;if(X=$.input.charCodeAt($.position),X!==39)return!1;$.kind="scalar",$.result="",$.position++,J=q=$.position;while((X=$.input.charCodeAt($.position))!==0)if(X===39)if(S0($,J,$.position,!0),X=$.input.charCodeAt(++$.position),X===39)J=$.position,$.position++,q=$.position;else return!0;else if(w0(X))S0($,J,q,!0),g4($,Z0($,!1,Z)),J=q=$.position;else if($.position===$.lineStart&&n8($))E($,"unexpected end of the document within a single quoted scalar");else $.position++,q=$.position;E($,"unexpected end of the stream within a single quoted scalar")}function h5($,Z){var X,J,q,G,Q,Y;if(Y=$.input.charCodeAt($.position),Y!==34)return!1;$.kind="scalar",$.result="",$.position++,X=J=$.position;while((Y=$.input.charCodeAt($.position))!==0)if(Y===34)return S0($,X,$.position,!0),$.position++,!0;else if(Y===92){if(S0($,X,$.position,!0),Y=$.input.charCodeAt(++$.position),w0(Y))Z0($,!1,Z);else if(Y<256&&WX[Y])$.result+=DX[Y],$.position++;else if((Q=S5(Y))>0){q=Q,G=0;for(;q>0;q--)if(Y=$.input.charCodeAt(++$.position),(Q=v5(Y))>=0)G=(G<<4)+Q;else E($,"expected hexadecimal character");$.result+=k5(G),$.position++}else E($,"unknown escape sequence");X=J=$.position}else if(w0(Y))S0($,X,J,!0),g4($,Z0($,!1,Z)),X=J=$.position;else if($.position===$.lineStart&&n8($))E($,"unexpected end of the document within a double quoted scalar");else $.position++,J=$.position;E($,"unexpected end of the stream within a double quoted scalar")}function m5($,Z){var X=!0,J,q,G,Q=$.tag,Y,U=$.anchor,z,H,F,V,D,P=Object.create(null),A,N,S,f;if(f=$.input.charCodeAt($.position),f===91)H=93,D=!1,Y=[];else if(f===123)H=125,D=!0,Y={};else return!1;if($.anchor!==null)$.anchorMap[$.anchor]=Y;f=$.input.charCodeAt(++$.position);while(f!==0){if(Z0($,!0,Z),f=$.input.charCodeAt($.position),f===H)return $.position++,$.tag=Q,$.anchor=U,$.kind=D?"mapping":"sequence",$.result=Y,!0;else if(!X)E($,"missed comma between flow collection entries");else if(f===44)E($,"expected the node content, but found ','");if(N=A=S=null,F=V=!1,f===63){if(z=$.input.charCodeAt($.position+1),W0(z))F=V=!0,$.position++,Z0($,!0,Z)}if(J=$.line,q=$.lineStart,G=$.position,t0($,Z,u8,!1,!0),N=$.tag,A=$.result,Z0($,!0,Z),f=$.input.charCodeAt($.position),(V||$.line===J)&&f===58)F=!0,f=$.input.charCodeAt(++$.position),Z0($,!0,Z),t0($,Z,u8,!1,!0),S=$.result;if(D)a0($,Y,P,N,A,S,J,q,G);else if(F)Y.push(a0($,null,P,N,A,S,J,q,G));else Y.push(A);if(Z0($,!0,Z),f=$.input.charCodeAt($.position),f===44)X=!0,f=$.input.charCodeAt(++$.position);else X=!1}E($,"unexpected end of the stream within a flow collection")}function u5($,Z){var X,J,q=f4,G=!1,Q=!1,Y=Z,U=0,z=!1,H,F;if(F=$.input.charCodeAt($.position),F===124)J=!1;else if(F===62)J=!0;else return!1;$.kind="scalar",$.result="";while(F!==0)if(F=$.input.charCodeAt(++$.position),F===43||F===45)if(f4===q)q=F===43?TZ:f5;else E($,"repeat of a chomping mode identifier");else if((H=_5(F))>=0)if(H===0)E($,"bad explicit indentation width of a block scalar; it cannot be less than one");else if(!Q)Y=Z+H-1,Q=!0;else E($,"repeat of an indentation width identifier");else break;if(h0(F)){do F=$.input.charCodeAt(++$.position);while(h0(F));if(F===35)do F=$.input.charCodeAt(++$.position);while(!w0(F)&&F!==0)}while(F!==0){b4($),$.lineIndent=0,F=$.input.charCodeAt($.position);while((!Q||$.lineIndent<Y)&&F===32)$.lineIndent++,F=$.input.charCodeAt(++$.position);if(!Q&&$.lineIndent>Y)Y=$.lineIndent;if(w0(F)){U++;continue}if($.lineIndent<Y){if(q===TZ)$.result+=Q0.repeat(`
`,G?1+U:U);else if(q===f4){if(G)$.result+=`
`}break}if(J)if(h0(F))z=!0,$.result+=Q0.repeat(`
`,G?1+U:U);else if(z)z=!1,$.result+=Q0.repeat(`
`,U+1);else if(U===0){if(G)$.result+=" "}else $.result+=Q0.repeat(`
`,U);else $.result+=Q0.repeat(`
`,G?1+U:U);G=!0,Q=!0,U=0,X=$.position;while(!w0(F)&&F!==0)F=$.input.charCodeAt(++$.position);S0($,X,$.position,!1)}return!0}function _Z($,Z){var X,J=$.tag,q=$.anchor,G=[],Q,Y=!1,U;if($.firstTabInLine!==-1)return!1;if($.anchor!==null)$.anchorMap[$.anchor]=G;U=$.input.charCodeAt($.position);while(U!==0){if($.firstTabInLine!==-1)$.position=$.firstTabInLine,E($,"tab characters must not be used in indentation");if(U!==45)break;if(Q=$.input.charCodeAt($.position+1),!W0(Q))break;if(Y=!0,$.position++,Z0($,!0,-1)){if($.lineIndent<=Z){G.push(null),U=$.input.charCodeAt($.position);continue}}if(X=$.line,t0($,Z,HX,!1,!0),G.push($.result),Z0($,!0,-1),U=$.input.charCodeAt($.position),($.line===X||$.lineIndent>Z)&&U!==0)E($,"bad indentation of a sequence entry");else if($.lineIndent<Z)break}if(Y)return $.tag=J,$.anchor=q,$.kind="sequence",$.result=G,!0;return!1}function p5($,Z,X){var J,q,G,Q,Y,U,z=$.tag,H=$.anchor,F={},V=Object.create(null),D=null,P=null,A=null,N=!1,S=!1,f;if($.firstTabInLine!==-1)return!1;if($.anchor!==null)$.anchorMap[$.anchor]=F;f=$.input.charCodeAt($.position);while(f!==0){if(!N&&$.firstTabInLine!==-1)$.position=$.firstTabInLine,E($,"tab characters must not be used in indentation");if(J=$.input.charCodeAt($.position+1),G=$.line,(f===63||f===58)&&W0(J)){if(f===63){if(N)a0($,F,V,D,P,null,Q,Y,U),D=P=A=null;S=!0,N=!0,q=!0}else if(N)N=!1,q=!0;else E($,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line");$.position+=1,f=J}else{if(Q=$.line,Y=$.lineStart,U=$.position,!t0($,X,FX,!1,!0))break;if($.line===G){f=$.input.charCodeAt($.position);while(h0(f))f=$.input.charCodeAt(++$.position);if(f===58){if(f=$.input.charCodeAt(++$.position),!W0(f))E($,"a whitespace character is expected after the key-value separator within a block mapping");if(N)a0($,F,V,D,P,null,Q,Y,U),D=P=A=null;S=!0,N=!1,q=!1,D=$.tag,P=$.result}else if(S)E($,"can not read an implicit mapping pair; a colon is missed");else return $.tag=z,$.anchor=H,!0}else if(S)E($,"can not read a block mapping entry; a multiline key may not be an implicit key");else return $.tag=z,$.anchor=H,!0}if($.line===G||$.lineIndent>Z){if(N)Q=$.line,Y=$.lineStart,U=$.position;if(t0($,Z,p8,!0,q))if(N)P=$.result;else A=$.result;if(!N)a0($,F,V,D,P,A,Q,Y,U),D=P=A=null;Z0($,!0,-1),f=$.input.charCodeAt($.position)}if(($.line===G||$.lineIndent>Z)&&f!==0)E($,"bad indentation of a mapping entry");else if($.lineIndent<Z)break}if(N)a0($,F,V,D,P,null,Q,Y,U);if(S)$.tag=z,$.anchor=H,$.kind="mapping",$.result=F;return S}function d5($){var Z,X=!1,J=!1,q,G,Q;if(Q=$.input.charCodeAt($.position),Q!==33)return!1;if($.tag!==null)E($,"duplication of a tag property");if(Q=$.input.charCodeAt(++$.position),Q===60)X=!0,Q=$.input.charCodeAt(++$.position);else if(Q===33)J=!0,q="!!",Q=$.input.charCodeAt(++$.position);else q="!";if(Z=$.position,X){do Q=$.input.charCodeAt(++$.position);while(Q!==0&&Q!==62);if($.position<$.length)G=$.input.slice(Z,$.position),Q=$.input.charCodeAt(++$.position);else E($,"unexpected end of the stream within a verbatim tag")}else{while(Q!==0&&!W0(Q)){if(Q===33)if(!J){if(q=$.input.slice(Z-1,$.position+1),!BX.test(q))E($,"named tag handle cannot contain such characters");J=!0,Z=$.position+1}else E($,"tag suffix cannot contain exclamation marks");Q=$.input.charCodeAt(++$.position)}if(G=$.input.slice(Z,$.position),E5.test(G))E($,"tag suffix cannot contain flow indicator characters")}if(G&&!KX.test(G))E($,"tag name cannot contain such characters: "+G);try{G=decodeURIComponent(G)}catch(Y){E($,"tag name is malformed: "+G)}if(X)$.tag=G;else if(_0.call($.tagMap,q))$.tag=$.tagMap[q]+G;else if(q==="!")$.tag="!"+G;else if(q==="!!")$.tag="tag:yaml.org,2002:"+G;else E($,'undeclared tag handle "'+q+'"');return!0}function l5($){var Z,X;if(X=$.input.charCodeAt($.position),X!==38)return!1;if($.anchor!==null)E($,"duplication of an anchor property");X=$.input.charCodeAt(++$.position),Z=$.position;while(X!==0&&!W0(X)&&!s0(X))X=$.input.charCodeAt(++$.position);if($.position===Z)E($,"name of an anchor node must contain at least one character");return $.anchor=$.input.slice(Z,$.position),!0}function c5($){var Z,X,J;if(J=$.input.charCodeAt($.position),J!==42)return!1;J=$.input.charCodeAt(++$.position),Z=$.position;while(J!==0&&!W0(J)&&!s0(J))J=$.input.charCodeAt(++$.position);if($.position===Z)E($,"name of an alias node must contain at least one character");if(X=$.input.slice(Z,$.position),!_0.call($.anchorMap,X))E($,'unidentified alias "'+X+'"');return $.result=$.anchorMap[X],Z0($,!0,-1),!0}function t0($,Z,X,J,q){var G,Q,Y,U=1,z=!1,H=!1,F,V,D,P,A,N;if($.listener!==null)$.listener("open",$);if($.tag=null,$.anchor=null,$.kind=null,$.result=null,G=Q=Y=p8===X||HX===X,J){if(Z0($,!0,-1)){if(z=!0,$.lineIndent>Z)U=1;else if($.lineIndent===Z)U=0;else if($.lineIndent<Z)U=-1}}if(U===1)while(d5($)||l5($))if(Z0($,!0,-1)){if(z=!0,Y=G,$.lineIndent>Z)U=1;else if($.lineIndent===Z)U=0;else if($.lineIndent<Z)U=-1}else Y=!1;if(Y)Y=z||q;if(U===1||p8===X){if(u8===X||FX===X)A=Z;else A=Z+1;if(N=$.position-$.lineStart,U===1)if(Y&&(_Z($,N)||p5($,N,A))||m5($,A))H=!0;else{if(Q&&u5($,A)||y5($,A)||h5($,A))H=!0;else if(c5($)){if(H=!0,$.tag!==null||$.anchor!==null)E($,"alias node should not have any properties")}else if(g5($,A,u8===X)){if(H=!0,$.tag===null)$.tag="?"}if($.anchor!==null)$.anchorMap[$.anchor]=$.result}else if(U===0)H=Y&&_Z($,N)}if($.tag===null){if($.anchor!==null)$.anchorMap[$.anchor]=$.result}else if($.tag==="?"){if($.result!==null&&$.kind!=="scalar")E($,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+$.kind+'"');for(F=0,V=$.implicitTypes.length;F<V;F+=1)if(P=$.implicitTypes[F],P.resolve($.result)){if($.result=P.construct($.result),$.tag=P.tag,$.anchor!==null)$.anchorMap[$.anchor]=$.result;break}}else if($.tag!=="!"){if(_0.call($.typeMap[$.kind||"fallback"],$.tag))P=$.typeMap[$.kind||"fallback"][$.tag];else{P=null,D=$.typeMap.multi[$.kind||"fallback"];for(F=0,V=D.length;F<V;F+=1)if($.tag.slice(0,D[F].tag.length)===D[F].tag){P=D[F];break}}if(!P)E($,"unknown tag !<"+$.tag+">");if($.result!==null&&P.kind!==$.kind)E($,"unacceptable node kind for !<"+$.tag+'> tag; it should be "'+P.kind+'", not "'+$.kind+'"');if(!P.resolve($.result,$.tag))E($,"cannot resolve a node with !<"+$.tag+"> explicit tag");else if($.result=P.construct($.result,$.tag),$.anchor!==null)$.anchorMap[$.anchor]=$.result}if($.listener!==null)$.listener("close",$);return $.tag!==null||$.anchor!==null||H}function n5($){var Z=$.position,X,J,q,G=!1,Q;$.version=null,$.checkLineBreaks=$.legacy,$.tagMap=Object.create(null),$.anchorMap=Object.create(null);while((Q=$.input.charCodeAt($.position))!==0){if(Z0($,!0,-1),Q=$.input.charCodeAt($.position),$.lineIndent>0||Q!==37)break;G=!0,Q=$.input.charCodeAt(++$.position),X=$.position;while(Q!==0&&!W0(Q))Q=$.input.charCodeAt(++$.position);if(J=$.input.slice(X,$.position),q=[],J.length<1)E($,"directive name must not be less than one character in length");while(Q!==0){while(h0(Q))Q=$.input.charCodeAt(++$.position);if(Q===35){do Q=$.input.charCodeAt(++$.position);while(Q!==0&&!w0(Q));break}if(w0(Q))break;X=$.position;while(Q!==0&&!W0(Q))Q=$.input.charCodeAt(++$.position);q.push($.input.slice(X,$.position))}if(Q!==0)b4($);if(_0.call(vZ,J))vZ[J]($,J,q);else d8($,'unknown document directive "'+J+'"')}if(Z0($,!0,-1),$.lineIndent===0&&$.input.charCodeAt($.position)===45&&$.input.charCodeAt($.position+1)===45&&$.input.charCodeAt($.position+2)===45)$.position+=3,Z0($,!0,-1);else if(G)E($,"directives end mark is expected");if(t0($,$.lineIndent-1,p8,!1,!0),Z0($,!0,-1),$.checkLineBreaks&&x5.test($.input.slice(Z,$.position)))d8($,"non-ASCII line breaks are interpreted as content");if($.documents.push($.result),$.position===$.lineStart&&n8($)){if($.input.charCodeAt($.position)===46)$.position+=3,Z0($,!0,-1);return}if($.position<$.length-1)E($,"end of the stream or a document separator is expected");else return}function MX($,Z){if($=String($),Z=Z||{},$.length!==0){if($.charCodeAt($.length-1)!==10&&$.charCodeAt($.length-1)!==13)$+=`
`;if($.charCodeAt(0)===65279)$=$.slice(1)}var X=new b5($,Z),J=$.indexOf("\x00");if(J!==-1)X.position=J,E(X,"null byte is not allowed in input");X.input+="\x00";while(X.input.charCodeAt(X.position)===32)X.lineIndent+=1,X.position+=1;while(X.position<X.length-1)n5(X);return X.documents}function o5($,Z,X){if(Z!==null&&typeof Z==="object"&&typeof X==="undefined")X=Z,Z=null;var J=MX($,X);if(typeof Z!=="function")return J;for(var q=0,G=J.length;q<G;q+=1)Z(J[q])}function i5($,Z){var X=MX($,Z);if(X.length===0)return;else if(X.length===1)return X[0];throw new H0("expected a single document in the stream, but found more")}var r5=o5,s5=i5,PX={loadAll:r5,load:s5},CX=Object.prototype.toString,NX=Object.prototype.hasOwnProperty,y4=65279,a5=9,O8=10,t5=13,e5=32,$6=33,Z6=34,x4=35,X6=37,J6=38,q6=39,Q6=42,RX=44,G6=45,l8=58,Y6=61,U6=62,z6=63,F6=64,LX=91,jX=93,H6=96,AX=123,B6=124,wX=125,z0={};z0[0]="\\0";z0[7]="\\a";z0[8]="\\b";z0[9]="\\t";z0[10]="\\n";z0[11]="\\v";z0[12]="\\f";z0[13]="\\r";z0[27]="\\e";z0[34]="\\\"";z0[92]="\\\\";z0[133]="\\N";z0[160]="\\_";z0[8232]="\\L";z0[8233]="\\P";var K6=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],V6=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function W6($,Z){var X,J,q,G,Q,Y,U;if(Z===null)return{};X={},J=Object.keys(Z);for(q=0,G=J.length;q<G;q+=1){if(Q=J[q],Y=String(Z[Q]),Q.slice(0,2)==="!!")Q="tag:yaml.org,2002:"+Q.slice(2);if(U=$.compiledTypeMap.fallback[Q],U&&NX.call(U.styleAliases,Y))Y=U.styleAliases[Y];X[Q]=Y}return X}function D6($){var Z,X,J;if(Z=$.toString(16).toUpperCase(),$<=255)X="x",J=2;else if($<=65535)X="u",J=4;else if($<=4294967295)X="U",J=8;else throw new H0("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+X+Q0.repeat("0",J-Z.length)+Z}var O6=1,M8=2;function M6($){this.schema=$.schema||k4,this.indent=Math.max(1,$.indent||2),this.noArrayIndent=$.noArrayIndent||!1,this.skipInvalid=$.skipInvalid||!1,this.flowLevel=Q0.isNothing($.flowLevel)?-1:$.flowLevel,this.styleMap=W6(this.schema,$.styles||null),this.sortKeys=$.sortKeys||!1,this.lineWidth=$.lineWidth||80,this.noRefs=$.noRefs||!1,this.noCompatMode=$.noCompatMode||!1,this.condenseFlow=$.condenseFlow||!1,this.quotingType=$.quotingType==='"'?M8:O6,this.forceQuotes=$.forceQuotes||!1,this.replacer=typeof $.replacer==="function"?$.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function kZ($,Z){var X=Q0.repeat(" ",Z),J=0,q=-1,G="",Q,Y=$.length;while(J<Y){if(q=$.indexOf(`
`,J),q===-1)Q=$.slice(J),J=Y;else Q=$.slice(J,q+1),J=q+1;if(Q.length&&Q!==`
`)G+=X;G+=Q}return G}function E4($,Z){return`
`+Q0.repeat(" ",$.indent*Z)}function P6($,Z){var X,J,q;for(X=0,J=$.implicitTypes.length;X<J;X+=1)if(q=$.implicitTypes[X],q.resolve(Z))return!0;return!1}function c8($){return $===e5||$===a5}function P8($){return 32<=$&&$<=126||161<=$&&$<=55295&&$!==8232&&$!==8233||57344<=$&&$<=65533&&$!==y4||65536<=$&&$<=1114111}function bZ($){return P8($)&&$!==y4&&$!==t5&&$!==O8}function gZ($,Z,X){var J=bZ($),q=J&&!c8($);return(X?J:J&&$!==RX&&$!==LX&&$!==jX&&$!==AX&&$!==wX)&&$!==x4&&!(Z===l8&&!q)||bZ(Z)&&!c8(Z)&&$===x4||Z===l8&&q}function C6($){return P8($)&&$!==y4&&!c8($)&&$!==G6&&$!==z6&&$!==l8&&$!==RX&&$!==LX&&$!==jX&&$!==AX&&$!==wX&&$!==x4&&$!==J6&&$!==Q6&&$!==$6&&$!==B6&&$!==Y6&&$!==U6&&$!==q6&&$!==Z6&&$!==X6&&$!==F6&&$!==H6}function N6($){return!c8($)&&$!==l8}function W8($,Z){var X=$.charCodeAt(Z),J;if(X>=55296&&X<=56319&&Z+1<$.length){if(J=$.charCodeAt(Z+1),J>=56320&&J<=57343)return(X-55296)*1024+J-56320+65536}return X}function IX($){var Z=/^\n* /;return Z.test($)}var fX=1,v4=2,TX=3,xX=4,r0=5;function R6($,Z,X,J,q,G,Q,Y){var U,z=0,H=null,F=!1,V=!1,D=J!==-1,P=-1,A=C6(W8($,0))&&N6(W8($,$.length-1));if(Z||Q)for(U=0;U<$.length;z>=65536?U+=2:U++){if(z=W8($,U),!P8(z))return r0;A=A&&gZ(z,H,Y),H=z}else{for(U=0;U<$.length;z>=65536?U+=2:U++){if(z=W8($,U),z===O8){if(F=!0,D)V=V||U-P-1>J&&$[P+1]!==" ",P=U}else if(!P8(z))return r0;A=A&&gZ(z,H,Y),H=z}V=V||D&&(U-P-1>J&&$[P+1]!==" ")}if(!F&&!V){if(A&&!Q&&!q($))return fX;return G===M8?r0:v4}if(X>9&&IX($))return r0;if(!Q)return V?xX:TX;return G===M8?r0:v4}function L6($,Z,X,J,q){$.dump=function(){if(Z.length===0)return $.quotingType===M8?'""':"''";if(!$.noCompatMode){if(K6.indexOf(Z)!==-1||V6.test(Z))return $.quotingType===M8?'"'+Z+'"':"'"+Z+"'"}var G=$.indent*Math.max(1,X),Q=$.lineWidth===-1?-1:Math.max(Math.min($.lineWidth,40),$.lineWidth-G),Y=J||$.flowLevel>-1&&X>=$.flowLevel;function U(z){return P6($,z)}switch(R6(Z,Y,$.indent,Q,U,$.quotingType,$.forceQuotes&&!J,q)){case fX:return Z;case v4:return"'"+Z.replace(/'/g,"''")+"'";case TX:return"|"+yZ(Z,$.indent)+hZ(kZ(Z,G));case xX:return">"+yZ(Z,$.indent)+hZ(kZ(j6(Z,Q),G));case r0:return'"'+A6(Z)+'"';default:throw new H0("impossible error: invalid scalar style")}}()}function yZ($,Z){var X=IX($)?String(Z):"",J=$[$.length-1]===`
`,q=J&&($[$.length-2]===`
`||$===`
`),G=q?"+":J?"":"-";return X+G+`
`}function hZ($){return $[$.length-1]===`
`?$.slice(0,-1):$}function j6($,Z){var X=/(\n+)([^\n]*)/g,J=function(){var z=$.indexOf(`
`);return z=z!==-1?z:$.length,X.lastIndex=z,mZ($.slice(0,z),Z)}(),q=$[0]===`
`||$[0]===" ",G,Q;while(Q=X.exec($)){var Y=Q[1],U=Q[2];G=U[0]===" ",J+=Y+(!q&&!G&&U!==""?`
`:"")+mZ(U,Z),q=G}return J}function mZ($,Z){if($===""||$[0]===" ")return $;var X=/ [^ ]/g,J,q=0,G,Q=0,Y=0,U="";while(J=X.exec($)){if(Y=J.index,Y-q>Z)G=Q>q?Q:Y,U+=`
`+$.slice(q,G),q=G+1;Q=Y}if(U+=`
`,$.length-q>Z&&Q>q)U+=$.slice(q,Q)+`
`+$.slice(Q+1);else U+=$.slice(q);return U.slice(1)}function A6($){var Z="",X=0,J;for(var q=0;q<$.length;X>=65536?q+=2:q++)if(X=W8($,q),J=z0[X],!J&&P8(X)){if(Z+=$[q],X>=65536)Z+=$[q+1]}else Z+=J||D6(X);return Z}function w6($,Z,X){var J="",q=$.tag,G,Q,Y;for(G=0,Q=X.length;G<Q;G+=1){if(Y=X[G],$.replacer)Y=$.replacer.call(X,String(G),Y);if(f0($,Z,Y,!1,!1)||typeof Y==="undefined"&&f0($,Z,null,!1,!1)){if(J!=="")J+=","+(!$.condenseFlow?" ":"");J+=$.dump}}$.tag=q,$.dump="["+J+"]"}function uZ($,Z,X,J){var q="",G=$.tag,Q,Y,U;for(Q=0,Y=X.length;Q<Y;Q+=1){if(U=X[Q],$.replacer)U=$.replacer.call(X,String(Q),U);if(f0($,Z+1,U,!0,!0,!1,!0)||typeof U==="undefined"&&f0($,Z+1,null,!0,!0,!1,!0)){if(!J||q!=="")q+=E4($,Z);if($.dump&&O8===$.dump.charCodeAt(0))q+="-";else q+="- ";q+=$.dump}}$.tag=G,$.dump=q||"[]"}function I6($,Z,X){var J="",q=$.tag,G=Object.keys(X),Q,Y,U,z,H;for(Q=0,Y=G.length;Q<Y;Q+=1){if(H="",J!=="")H+=", ";if($.condenseFlow)H+='"';if(U=G[Q],z=X[U],$.replacer)z=$.replacer.call(X,U,z);if(!f0($,Z,U,!1,!1))continue;if($.dump.length>1024)H+="? ";if(H+=$.dump+($.condenseFlow?'"':"")+":"+($.condenseFlow?"":" "),!f0($,Z,z,!1,!1))continue;H+=$.dump,J+=H}$.tag=q,$.dump="{"+J+"}"}function f6($,Z,X,J){var q="",G=$.tag,Q=Object.keys(X),Y,U,z,H,F,V;if($.sortKeys===!0)Q.sort();else if(typeof $.sortKeys==="function")Q.sort($.sortKeys);else if($.sortKeys)throw new H0("sortKeys must be a boolean or a function");for(Y=0,U=Q.length;Y<U;Y+=1){if(V="",!J||q!=="")V+=E4($,Z);if(z=Q[Y],H=X[z],$.replacer)H=$.replacer.call(X,z,H);if(!f0($,Z+1,z,!0,!0,!0))continue;if(F=$.tag!==null&&$.tag!=="?"||$.dump&&$.dump.length>1024,F)if($.dump&&O8===$.dump.charCodeAt(0))V+="?";else V+="? ";if(V+=$.dump,F)V+=E4($,Z);if(!f0($,Z+1,H,!0,F))continue;if($.dump&&O8===$.dump.charCodeAt(0))V+=":";else V+=": ";V+=$.dump,q+=V}$.tag=G,$.dump=q||"{}"}function pZ($,Z,X){var J,q,G,Q,Y,U;q=X?$.explicitTypes:$.implicitTypes;for(G=0,Q=q.length;G<Q;G+=1)if(Y=q[G],(Y.instanceOf||Y.predicate)&&(!Y.instanceOf||typeof Z==="object"&&Z instanceof Y.instanceOf)&&(!Y.predicate||Y.predicate(Z))){if(X)if(Y.multi&&Y.representName)$.tag=Y.representName(Z);else $.tag=Y.tag;else $.tag="?";if(Y.represent){if(U=$.styleMap[Y.tag]||Y.defaultStyle,CX.call(Y.represent)==="[object Function]")J=Y.represent(Z,U);else if(NX.call(Y.represent,U))J=Y.represent[U](Z,U);else throw new H0("!<"+Y.tag+'> tag resolver accepts not "'+U+'" style');$.dump=J}return!0}return!1}function f0($,Z,X,J,q,G,Q){if($.tag=null,$.dump=X,!pZ($,X,!1))pZ($,X,!0);var Y=CX.call($.dump),U=J,z;if(J)J=$.flowLevel<0||$.flowLevel>Z;var H=Y==="[object Object]"||Y==="[object Array]",F,V;if(H)F=$.duplicates.indexOf(X),V=F!==-1;if($.tag!==null&&$.tag!=="?"||V||$.indent!==2&&Z>0)q=!1;if(V&&$.usedDuplicates[F])$.dump="*ref_"+F;else{if(H&&V&&!$.usedDuplicates[F])$.usedDuplicates[F]=!0;if(Y==="[object Object]"){if(J&&Object.keys($.dump).length!==0){if(f6($,Z,$.dump,q),V)$.dump="&ref_"+F+$.dump}else if(I6($,Z,$.dump),V)$.dump="&ref_"+F+" "+$.dump}else if(Y==="[object Array]"){if(J&&$.dump.length!==0){if($.noArrayIndent&&!Q&&Z>0)uZ($,Z-1,$.dump,q);else uZ($,Z,$.dump,q);if(V)$.dump="&ref_"+F+$.dump}else if(w6($,Z,$.dump),V)$.dump="&ref_"+F+" "+$.dump}else if(Y==="[object String]"){if($.tag!=="?")L6($,$.dump,Z,G,U)}else if(Y==="[object Undefined]")return!1;else{if($.skipInvalid)return!1;throw new H0("unacceptable kind of an object to dump "+Y)}if($.tag!==null&&$.tag!=="?"){if(z=encodeURI($.tag[0]==="!"?$.tag.slice(1):$.tag).replace(/!/g,"%21"),$.tag[0]==="!")z="!"+z;else if(z.slice(0,18)==="tag:yaml.org,2002:")z="!!"+z.slice(18);else z="!<"+z+">";$.dump=z+" "+$.dump}}return!0}function T6($,Z){var X=[],J=[],q,G;S4($,X,J);for(q=0,G=J.length;q<G;q+=1)Z.duplicates.push(X[J[q]]);Z.usedDuplicates=new Array(G)}function S4($,Z,X){var J,q,G;if($!==null&&typeof $==="object")if(q=Z.indexOf($),q!==-1){if(X.indexOf(q)===-1)X.push(q)}else if(Z.push($),Array.isArray($))for(q=0,G=$.length;q<G;q+=1)S4($[q],Z,X);else{J=Object.keys($);for(q=0,G=J.length;q<G;q+=1)S4($[J[q]],Z,X)}}function x6($,Z){Z=Z||{};var X=new M6(Z);if(!X.noRefs)T6($,X);var J=$;if(X.replacer)J=X.replacer.call({"":J},"",J);if(f0(X,0,J,!0,!0))return X.dump+`
`;return""}var E6=x6,v6={dump:E6};function h4($,Z){return function(){throw new Error("Function yaml."+$+" is removed in js-yaml 4. Use yaml."+Z+" instead, which is now safe by default.")}}var S6=U0,_6=cZ,k6=rZ,b6=$X,g6=ZX,y6=k4,h6=PX.load,m6=PX.loadAll,u6=v6.dump,p6=H0,d6={binary:GX,float:eZ,map:iZ,null:sZ,pairs:UX,set:zX,timestamp:qX,bool:aZ,int:tZ,merge:QX,omap:YX,seq:oZ,str:nZ},l6=h4("safeLoad","load"),c6=h4("safeLoadAll","loadAll"),n6=h4("safeDump","dump"),EX={Type:S6,Schema:_6,FAILSAFE_SCHEMA:k6,JSON_SCHEMA:b6,CORE_SCHEMA:g6,DEFAULT_SCHEMA:y6,load:h6,loadAll:m6,dump:u6,YAMLException:p6,types:d6,safeLoad:l6,safeLoadAll:c6,safeDump:n6};function vX($){let Z=$.split(`
`),X="",J={"@context":"https://schema.org","@type":"CreativeWork",needsPostal:!1},q=[],G=(l)=>{let b=l.trim();if(!b)return null;try{return JSON.parse(b)}catch{}try{return EX.load(b)}catch{}return null},Q={},Y=!1,U="",z=!1;Z.forEach((l)=>{let b=l.trim();if(b==="```agg"){z=!0;return}if(z){if(b==="```")z=!1;return}let d=b.match(/^\[master:([^\]]+)\]$/);if(d){U=d[1]||"",Q[U]=[],Y=!0;return}if(Y&&U){if(b.startsWith("|")){let c=b.split("|").slice(1,-1).map((m)=>m.trim());if(!c.every((m)=>m.match(/^-+$/))&&U&&Q[U]){let m=Q[U];if(m)m.push(c)}}else if(b.length>0)Y=!1}}),r.setMasterData(Q);let H=null,F=null,V=!1,D=!1,P="";J.fields=[],J.tables={},J.masterData=Q;let A=[],N=null,S="",f=!1,x=[],k=(l)=>{S+=l},a=(l)=>{let b=/\[(?:([a-z]+):)?([^\]\s:\(\)]+)(?:\s*\((.*?)\))?\]/g,d=0,c="",o;while((o=b.exec(l))!==null){c+=r.escapeHtml(l.substring(d,o.index));let[m,K,L,O]=o,C=O||"",j=K||"text",w=C.match(/placeholder="([^"]+)"/)||C.match(/placeholder='([^']+)'/),I=w?w[1]:L,_=C.match(/context="([^"]+)"/)||C.match(/context='([^']+)'/),g=C.match(/property="([^"]+)"/)||C.match(/property='([^']+)'/);J.fields.push({key:L,label:I,type:j,context:_?_[1]:void 0,property:g?g[1]:void 0,show_if:(C.match(/show_if="([^"]+)"/)||C.match(/show_if='([^']+)'/))?.[1],required:C.includes("required")}),c+=r.renderInput(j,L,C),d=b.lastIndex}return c+=r.escapeHtml(l.substring(d)),c=c.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/__(.*?)__/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/_(.*?)_/g,"<em>$1</em>").replace(/`(.*?)`/g,"<code>$1</code>").replace(/\[([^\]]+)\]\((https?:\/\/[^\)]+)\)/g,'<a href="$2" target="_blank" rel="noopener">$1</a>').replace(/\[([^\]]+)\]\(([\.\/][^\)]+)\)/g,'<a href="$2">$1</a>'),c};if(Z.forEach((l)=>{let b=l.trim();if(b==="```agg"){f=!0,x=[];return}if(f){if(b==="```"){f=!1;let m=G(x.join(`
`));if(m)q.push(m);x=[]}else x.push(l);return}let d=b.match(/^\[master:([^\]]+)\]$/);if(d){P=d[1]||"";return}let c=b.match(/^\[dynamic\s*-?\s*table:([^\]]+)\]$/);if(c){F=c[1]||"",J.tables[F]=[];return}if(b.startsWith("|")){if(!V){k('<div class="form-row vertical"><div class="table-wrapper">');let L="data-table",O="";if(F)L+=" dynamic",O=`id="tbl_${F}" data-table-key="${F}"`;else if(P)L+=" master",O=`data-master-key="${P}"`;k(`<table class="${L}" ${O}>`),k("<tbody>"),V=!0,D=!!P}let m=b.split("|").slice(1,-1).map((L)=>L.trim());if(m.every((L)=>L.match(/^-+$/)));else if(F)if(!m.some((O)=>O.includes("[")))k(`<tr>${m.map((O)=>`<th>${r.escapeHtml(O)}</th>`).join("")}<th class="row-action-cell"></th></tr>`);else{let O=F;m.forEach((j)=>{let w=j.trim().match(/^\[(?:([a-z]+):)?([^\]:\(\)]+)(?:\s*\((.*)\)|:([^\]]+))?\]$/);if(w){let[I,_,g,v,B0]=w,K0=(g||"").trim(),k0=v||B0||"";if(K0.includes(" ")){let c4=K0.split(/\s+/);K0=c4[0],k0=c4.slice(1).join(" ")+" "+k0}let m0=k0.match(/placeholder="([^"]+)"/)||k0.match(/placeholder='([^']+)'/),kX=m0?m0[1]:K0,l4=J.tables[O];if(l4)l4.push({key:K0,label:kX,type:_||"text"})}});let C=r.tableRow(m,!0);C=C.replace("</tr>",'<td class="row-action-cell"><button type="button" class="remove-row-btn" onclick="removeTableRow(this)" tabindex="-1"></button></td></tr>'),k(C)}else if(D)k(r.tableRow(m));else k(r.tableRow(m));return}else if(V){if(k("</tbody></table></div>"),F)k(`<button type="button" class="add-row-btn" onclick="addTableRow(this, '${F}')" data-i18n="add_row">+ </button>`),F=null;k("</div>"),V=!1,D=!1,P=""}let o=b.match(/^(#{1,6})\s+(.*)$/);if(o){let m=o[1]?o[1].length:1,K=o[2]||"";if(m===1)k(`<h1>${r.escapeHtml(K)}</h1>`),J.name=K;else if(m===2){if(N)k("</div>");let L=K.includes("(Config)")||K.includes("(Hidden)")||K.includes("(System)"),O="tab-"+(A.length+1);A.push({id:O,title:K,isSystem:L}),N=O;let C=!L&&A.filter((w)=>!w.isSystem).length===1?" active":"",j=L?' style="display:none !important;"':"";k(`<div id="${O}" class="tab-content${C}" data-tab-title="${r.escapeHtml(K)}"${j}>`)}else k(`<h${m}>${r.escapeHtml(K)}</h${m}>`);H=null}else if(l.startsWith("  - ")||l.startsWith("\t- ")){if(H){let m=b.replace(/^-\s*/,""),K=!1;if(m.startsWith("[x] "))K=!0,m=m.substring(4);k(r.radioOption(H.key,m,m,K))}}else if(b.startsWith("- [")){let m=b.match(/^-\s*\[([a-z]+):([^\]\s:\(\)]+)(?:\s*\((.*)\))?\]\s*(.*)$/);if(m){let[K,L,O,C,j]=m;H=null;let w=(j||"").trim(),I=C||"",_=I.match(/context="([^"]+)"/)||I.match(/context='([^']+)'/),g=I.match(/property="([^"]+)"/)||I.match(/property='([^']+)'/),v=I.match(/show_if="([^"]+)"/)||I.match(/show_if='([^']+)'/),B0=I.match(/autofill:([a-z]+)/);if(B0&&B0[1]==="postal")J.needsPostal=!0;if(J.fields.push({key:O,label:w,type:L||"text",context:_?_[1]:void 0,property:g?g[1]:void 0,show_if:v?v[1]:void 0,required:I.includes("required")}),L==="radio")H={key:O,label:w,attrs:I},k(r.radioStart(O,w,I));else if(L==="text")k(r.text(O,w,I));else if(L==="number")k(r.number(O,w,I));else if(L==="date")k(r.date(O,w,I));else if(L==="textarea")k(r.textarea(O,w,I));else if(L==="search")k(r.search(O,w,I));else if(L==="calc")k(r.calc(O,w,I));else if(L==="datalist")k(r.renderInput(L,O,I));else if(L&&r[L])k(r[L](O,w,I));else console.warn(`Unknown type: ${L}`,Object.keys(r)),k(`<p style="color:red">Unknown type: ${L}</p>`)}}else if(b.startsWith("---")){if(!N)k("<hr>");H=null}else if(b.startsWith("<")){if(H)k("</div></div>"),H=null;if(b.includes("[")&&b.includes("]"))k(a(b));else k(b)}else if(b.length>0){if(H)k("</div></div>"),H=null;k(`<p>${a(b)}</p>`)}else if(H)k("</div></div>"),H=null}),V){if(k("</tbody></table></div>"),F)k(`<button type="button" class="add-row-btn" onclick="addTableRow(this, '${F}')" data-i18n="add_row">+ </button>`),F=null;k("</div>")}if(H)k("</div></div>");if(N)k("</div>");let G0=`
            <div style="flex:1"></div>
            <button class="btn-clear" onclick="window.clearData()" data-i18n="clear_btn">Clear</button>
            <button class="secondary" onclick="window.saveDraft()" data-i18n="work_save_btn">Save Progress</button>
            <button class="primary" id="btn-submit" onclick="window.signAndDownload()" data-i18n="sign_btn" disabled>Submit</button>
    `;if(A.length>0){let l='<div class="tabs-nav">',b=0;if(A.forEach((d,c)=>{if(d.isSystem)return;l+=`<button class="tab-btn${b===0?" active":""}" onclick="switchTab(this, '${d.id}')">${r.escapeHtml(d.title)}</button>`,b++}),l+=`
            <div class="no-print" style="display: flex; gap: 10px; align-items: center; flex-grow: 1; padding-left: 20px;">
                ${G0}
            </div>
        `,l+="</div>",S.includes("</h1>"))X=S.replace("</h1>","</h1>"+l);else X=l+S}else{let l=`<div class="no-print form-toolbar" style="display: flex; gap: 10px; align-items: center; margin-top: 2rem; padding-top: 1rem; border-top: 1px solid #eee;">
            ${G0}
        </div>`;X=S+l}if(q.length===1)J.aggSpec=q[0];else if(q.length>1)J.aggSpec=q;return{html:X,jsonStructure:J}}var m4=typeof window!=="undefined"&&window.__WEBA_BUILD_TIME__?window.__WEBA_BUILD_TIME__:typeof process!=="undefined"&&process.env&&process.env.BUILD_TIME?process.env.BUILD_TIME:"";function o6($){if(!$)return"Build: dev";return`Build: ${$.replace("T"," ").replace(".000Z","Z")}`}function d4($,Z){let X=Z.trim().replace(/^\$\./,"");if(!X)return[];let J=X.split("."),q=[$];for(let G of J){let Q=G.match(/^(.*)\[(\d*)\]$/),Y=Q?Q[1]:G,U=Q?Q[2]:null,z=Q&&U==="",H=Q&&U!==""&&U!==null?parseInt(U,10):null,F=[];for(let V of q){if(V===null||V===void 0)continue;let D=Y?V[Y]:V;if(z){if(Array.isArray(D))F.push(...D);continue}if(H!==null){if(Array.isArray(D)&&D[H]!==void 0)F.push(D[H]);continue}if(D!==void 0)F.push(D)}q=F}return q}function A7($,Z){let X=[];switch(Z.forEach((J)=>{let q=d4(J.plain,$.path);X.push(...q)}),$.type){case"count":return X.length;case"sum":return X.reduce((J,q)=>J+(Number(q)||0),0);case"avg":return X.length?X.reduce((J,q)=>J+(Number(q)||0),0)/X.length:0;case"boolean_count":return X.filter((J)=>!!J).length;case"percent":{let J=X.filter((q)=>!!q).length;return X.length?`${(J/X.length*100).toFixed(1)}%`:"0%"}default:return 0}}function i6($,Z,X){if(!Z){$.innerHTML="";return}let J="",q=Z.dashboard?.cards||Z.metrics?.map((Q)=>({id:Q.id,label:Q.name,op:Q.type,path:Q.path}))||[];if(q.length>0){let Q=q.map((Y)=>{let U=0,z=[];if(X.forEach((H)=>{if(Y.path)z.push(...d4(H.plain,Y.path))}),Y.op==="count")U=X.length;else if(Y.op==="sum")U=z.reduce((H,F)=>H+(Number(F)||0),0);else if(Y.op==="avg")U=z.length?z.reduce((H,F)=>H+(Number(F)||0),0)/z.length:0;else if(Y.op==="boolean_count")U=z.filter((H)=>!!H).length;if(typeof U==="number"&&Y.format==="currency")U=new Intl.NumberFormat("ja-JP",{style:"currency",currency:"JPY"}).format(U);else if(typeof U==="number")U=U.toLocaleString();return`
        <div class="metric-card">
          <label>${Y.label}</label>
          <div class="value">${U}</div>
        </div>
      `}).join("");J+=`<div class="dashboard-grid">${Q}</div>`}let G=Z.dashboard?.charts||[];if(G.length>0){let Q=G.map((Y)=>{if(Y.type==="bar"){let U={};X.forEach((V)=>{d4(V.plain,Y.source).forEach((P)=>{if(Y.filter){if(P[Y.filter.path]!==Y.filter.value)return}let A=P[Y.x];if(A)U[A]=(U[A]||0)+1})});let z=Object.entries(U).sort((V,D)=>D[1]-V[1]),H=Math.max(...Object.values(U),1),F=z.map(([V,D])=>`
          <div class="chart-bar-row">
            <div class="chart-bar-label">${V}</div>
            <div class="chart-bar-track"><div class="chart-bar-fill" style="width: ${D/H*100}%"></div></div>
            <div class="chart-bar-value">${D}</div>
          </div>
        `).join("");return`
          <div class="chart-card">
            <h4>${Y.title}</h4>
            <div class="chart-bars">${F}</div>
          </div>
        `}return""}).join("");J+=`<div class="chart-grid">${Q}</div>`}$.innerHTML=J}function r6($,Z,X){if(Z.length===0){$.innerHTML=`<div class="agg-empty-state">
      <div class="icon">\uD83D\uDCC2</div>
      <p>No records found. Please upload HTML files and click "Run Aggregation".</p>
    </div>`;return}let J=X.map((G)=>`<th>${G}</th>`).join(""),q=Z.map((G,Q)=>{let Y=X.map((U)=>`<td>${G[U]??""}</td>`).join("");return`<tr onclick="window.showRecordDetail(${Q})">${Y}</tr>`}).join("");$.innerHTML=`
    <div class="agg-section-header">
      <h3>\uD83D\uDCCB Extracted Records</h3>
      <span class="count-badge">${Z.length} records</span>
    </div>
    <div class="agg-table-container">
      <table class="agg-table">
        <thead><tr>${J}</tr></thead>
        <tbody>${q}</tbody>
      </table>
    </div>
  `,window._aggRows=Z}var u4=null,p4=null;function s6(){let $=document.getElementById("weba-source-markdown");if(!$)return null;return $.textContent||null}function a6(){if(u4&&p4)return{html:u4,structure:p4};let $=s6();if(!$)return null;let Z=vX($);return u4=Z.html,p4=Z.jsonStructure,{html:Z.html,structure:Z.jsonStructure}}function SX($,Z){if(!Z)return;let X=Z.trim().replace(/^\$\./,"");if(!X)return;let J=X.split("."),q=$;for(let G of J){if(q===null||q===void 0)return;let Q=G.match(/^(.*)\[(\d+)\]$/);if(Q){let Y=Q[1]??"",U=parseInt(Q[2]??"0",10),z=Y?q[Y]:q;q=Array.isArray(z)?z[U]:void 0;continue}q=q[G]}return q}function _X($,Z){if($ instanceof HTMLInputElement&&$.type==="checkbox"){$.checked=!!Z;return}let X=Z===null||Z===void 0?"":String(Z);$.value=X}function t6($,Z){let X=Array.isArray(Z?.fields)?Z.fields:[],J=new Set(X.map((Y)=>Y.key)),q=new Set(Object.keys(Z?.tables||{})),G="",Q=!1;for(let Y in $){if(Y.startsWith("@")||Y.startsWith("_")||J.has(Y)||q.has(Y))continue;if(!Q)G+='<div class="detail-group-header">Extra Information</div>',Q=!0;G+=`
      <div class="detail-row">
        <div class="detail-key">${Y}</div>
        <div class="detail-val-box"><pre class="val-json">${JSON.stringify($[Y],null,2)}</pre></div>
      </div>
    `}return G}function e6($,Z){let X=Z||{};$.querySelectorAll("input[data-json-path], textarea[data-json-path], select[data-json-path]").forEach((J)=>{let q=J.dataset.jsonPath||"",G=SX(X,q);_X(J,G)}),$.querySelectorAll("input[type='radio']").forEach((J)=>{let q=J.name;if(!q)return;let G=SX(X,q);if(G!==void 0)J.checked=String(G)===J.value}),$.querySelectorAll(".data-table.dynamic").forEach((J)=>{let q=J.getAttribute("data-table-key")||"";if(!q)return;let G=Array.isArray(X[q])?X[q]:[],Q=J.querySelector("tbody"),Y=Q?.querySelector("tr.template-row");if(!Q||!Y)return;Y.style.display="none",G.forEach((U,z)=>{let H=Y.cloneNode(!0);H.classList.remove("template-row"),H.style.display="",H.querySelectorAll("input, textarea, select").forEach((F)=>{let V=F.dataset.baseKey||F.dataset.jsonPath;if(!V)return;_X(F,U?.[V])}),H.querySelectorAll(".auto-num").forEach((F)=>{if(!F.value)F.value=String(z+1)}),H.querySelectorAll(".remove-row-btn").forEach((F)=>{F.style.display="none"}),Q.appendChild(H)})}),$.querySelectorAll("input, textarea, select").forEach((J)=>{J.disabled=!0,J.classList.add("readonly")}),$.querySelectorAll(".add-row-btn").forEach((J)=>{J.style.display="none"})}function $Q($){let Z=window._aggRows;if(!Z||!Z[$])return;let X=Z[$],J=document.getElementById("weba-agg-detail");if(!J)return;let q=X._raw||{},G="",Q=a6(),Y="",U=document.getElementById("weba-structure"),z=[],H=null;if(U)try{let N=JSON.parse(U.textContent);z=N.fields||[],H=N}catch{}let F=(N)=>{if(N===null||N===void 0)return'<span class="val-null">N/A</span>';if(typeof N==="boolean")return`<span class="val-bool ${N}">${N?"Yes":"No"}</span>`;if(Array.isArray(N))return`<div class="val-array">${N.map((S)=>`<div class="array-item">${typeof S==="object"?JSON.stringify(S):S}</div>`).join("")}</div>`;if(typeof N==="object")return`<pre class="val-json">${JSON.stringify(N,null,2)}</pre>`;return`<span class="val-text">${N}</span>`};if(Q)Y=`
      <div class="detail-form-preview" id="weba-agg-form-preview">
        ${Q.html}
      </div>
      ${t6(q,Q.structure||H||{})}
    `;else if(z.length>0){z.forEach((f)=>{if(f.type==="calc")return;let x=q[f.key];if(x!==void 0)G+=`
          <div class="detail-row">
            <div class="detail-key">${f.label||f.key}</div>
            <div class="detail-val-box">${F(x)}</div>
          </div>
        `});let N=new Set(z.map((f)=>f.key)),S=!1;for(let f in q){if(f.startsWith("@")||f.startsWith("_")||N.has(f))continue;if(!S)G+='<div class="detail-group-header">Extra Information</div>',S=!0;G+=`
        <div class="detail-row">
          <div class="detail-key">${f}</div>
          <div class="detail-val-box">${F(q[f])}</div>
        </div>
      `}}else for(let N in q){if(N.startsWith("@")||N.startsWith("_"))continue;G+=`
        <div class="detail-row">
          <div class="detail-key">${N}</div>
          <div class="detail-val-box">${F(q[N])}</div>
        </div>
      `}J.innerHTML=`
    <div class="detail-overlay" id="weba-detail-overlay">
      <div class="detail-modal">
        <div class="detail-modal-header">
          <div class="header-info">
            <span class="file-icon">\uD83D\uDCC4</span>
            <div class="text">
              <h3>Record Details</h3>
              <p>${X._filename||"Standalone Record"}</p>
            </div>
          </div>
          <button class="close-btn" id="weba-detail-close"></button>
        </div>
        <div class="detail-modal-body">
          ${Y||`<div class="form-view">${G}</div>`}
          <details class="raw-data-section">
            <summary>View Raw Source Data (JSON)</summary>
            <pre>${JSON.stringify(q,null,2)}</pre>
            ${X._sig?`<h4>Signature</h4><pre>${JSON.stringify(X._sig,null,2)}</pre>`:""}
          </details>
        </div>
      </div>
    </div>
  `,document.body.style.overflow="hidden";let V=document.getElementById("weba-detail-overlay"),D=document.getElementById("weba-detail-close"),P=()=>{if(J)J.innerHTML="";document.body.style.overflow=""};V?.addEventListener("click",(N)=>{if(N.stopPropagation(),N.target===V)P()}),D?.addEventListener("click",(N)=>{N.stopPropagation(),P()});let A=document.getElementById("weba-agg-form-preview");if(A)e6(A,q)}if(typeof window!=="undefined")window.showRecordDetail=$Q;function ZQ(){let $=document.getElementById("weba-l2-keys");if(!$)return null;try{return JSON.parse($.textContent)}catch{return null}}function XQ(){let $=document.getElementById("weba-agg-spec");if(!$)return null;try{return JSON.parse($.textContent)}catch{return null}}async function JQ($,Z,X){let J=s4($);if(J){if(!Z)return{source:"l2",plain:null};try{let G=null;if(Z.recipient_x25519_private)G=N0(Z.recipient_x25519_private);if(!G&&Z.org_root_key);if(G){let Q=await I8(J,G,{...X?{replayGuard:X}:{}});return{source:"l2",plain:Q.layer2_plain,sig:Q.layer2_sig}}}catch(G){console.warn("L2 decryption failed",G)}}let q=r4($);if(q)return{source:"jsonld",plain:q.credentialSubject?.answers||q};return{source:"unknown",plain:null}}function w7(){let $=document.getElementById("aggregator-root");if(!$)return;$.innerHTML=`
    <div class="agg-layout">
      <aside class="agg-sidebar">
        <div class="agg-brand">
          <div class="agg-brand-main">
            <div class="brand-logo">Agg</div>
            <h1>Web/A Aggregator</h1>
          </div>
          <div class="agg-build-stamp" id="weba-agg-build"></div>
        </div>

        <div class="agg-config-card">
          <div class="card-header">1. Data Source</div>
          <div class="agg-form-field">
            <label>Upload Submitted Forms</label>
            <div class="btn-grid">
              <button id="weba-agg-file-trigger" class="agg-btn-secondary">\uD83D\uDCC4 Select Files</button>
              <button id="weba-agg-dir-trigger" class="agg-btn-secondary">\uD83D\uDCC1 Select Folder</button>
            </div>
            <input id="weba-agg-files" type="file" accept=".html" multiple style="display:none;" />
            <input id="weba-agg-dirs" type="file" webkitdirectory directory style="display:none;" />
            <p class="field-hint">Select files or an entire folder of HTML forms.</p>
          </div>

          <div class="agg-form-field">
            <label>Decryption Method</label>
            <div id="weba-agg-key-status" class="agg-status-chip">No keys detected</div>
            <div class="btn-group">
              <button id="weba-agg-passkey" class="agg-btn-small outline">\uD83D\uDD11 Use Passkey</button>
            </div>
            <p class="field-hint">Encryption is used for Layer 2 security.</p>
          </div>

          <div class="agg-form-field-row">
            <input id="weba-agg-include-json" type="checkbox" />
            <label for="weba-agg-include-json">Include JSON column in table</label>
          </div>
        </div>

        <div class="agg-actions-card">
          <button id="weba-agg-run" class="agg-btn-primary"> Run Aggregation</button>
          <div class="btn-grid">
            <button id="weba-agg-download" class="agg-btn-secondary" disabled>\uD83D\uDCE5 CSV</button>
            <button id="weba-agg-download-jsonl" class="agg-btn-secondary" disabled>\uD83D\uDCE5 JSONL</button>
          </div>
          <button id="weba-agg-clear" class="agg-btn-text">\uD83D\uDDD1 Clear Data</button>
          <div id="weba-agg-status" class="agg-status-message">Ready.</div>
        </div>
      </aside>

      <main class="agg-main">
        <div id="weba-agg-results" class="agg-results is-hidden">
          <div id="weba-agg-dashboard" class="agg-dashboard"></div>
          <div id="weba-agg-output" class="agg-output"></div>
        </div>
      </main>
    </div>

    <div id="weba-agg-detail"></div>

    <style>
      :root {
        --agg-primary: #2563eb;
        --agg-bg: #f8fafc;
        --agg-card-bg: #ffffff;
        --agg-text: #1e293b;
        --agg-text-dim: #64748b;
        --agg-border: #e2e8f0;
      }

      .agg-layout { display: flex; min-height: 80vh; gap: 24px; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; color: var(--agg-text); }
      .agg-sidebar { width: 320px; flex-shrink: 0; display: flex; flex-direction: column; gap: 20px; }
      .agg-main { flex: 1; display: flex; flex-direction: column; gap: 24px; }

      .agg-brand { padding: 12px 0; display: flex; align-items: center; justify-content: space-between; gap: 12px; }
      .agg-brand-main { display: flex; align-items: center; gap: 12px; }
      .brand-logo { background: var(--agg-primary); color: white; width: 40px; height: 40px; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 0.8rem; }
      .agg-brand h1 { font-size: 1.25rem; font-weight: 700; margin: 0; }
      .agg-build-stamp { font-size: 0.65rem; color: var(--agg-text-dim); padding: 2px 8px; border-radius: 999px; border: 1px solid var(--agg-border); background: #f1f5f9; white-space: nowrap; }

      .agg-config-card, .agg-actions-card { background: var(--agg-card-bg); border: 1px solid var(--agg-border); border-radius: 12px; padding: 20px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
      .card-header { font-size: 0.85rem; font-weight: 600; text-transform: uppercase; color: var(--agg-text-dim); margin-bottom: 16px; border-bottom: 1px solid var(--agg-border); padding-bottom: 8px; }

      .agg-form-field { margin-bottom: 16px; }
      .agg-form-field label { display: block; font-size: 0.9rem; font-weight: 600; margin-bottom: 6px; }
      .agg-form-field input[type="file"] { width: 100%; font-size: 0.85rem; }
      .field-hint { font-size: 0.75rem; color: var(--agg-text-dim); margin: 4px 0 0; }

      .agg-form-field-row { display: flex; align-items: center; gap: 8px; margin-top: 12px; }
      .agg-form-field-row label { font-size: 0.85rem; cursor: pointer; }

      .agg-status-chip { background: #f1f5f9; padding: 4px 10px; border-radius: 20px; font-size: 0.75rem; color: var(--agg-text-dim); display: inline-block; margin-bottom: 8px; }
      .agg-status-chip.ready { background: #dcfce7; color: #166534; }

      .btn-group { display: flex; gap: 8px; }
      .btn-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
      
      .agg-btn-primary { background: var(--agg-primary); color: white; border: none; padding: 12px; border-radius: 8px; font-weight: 600; cursor: pointer; width: 100%; margin-bottom: 12px; transition: opacity 0.2s; }
      .agg-btn-primary:active { opacity: 0.8; }
      
      .agg-btn-secondary { background: white; border: 1px solid var(--agg-border); color: var(--agg-text); padding: 8px; border-radius: 8px; font-size: 0.85rem; cursor: pointer; }
      .agg-btn-secondary:disabled { opacity: 0.5; cursor: not-allowed; }
      
      .agg-btn-small { padding: 4px 12px; border-radius: 6px; font-size: 0.8rem; cursor: pointer; }
      .agg-btn-small.outline { background: white; border: 1px solid var(--agg-primary); color: var(--agg-primary); }

      .agg-btn-text { background: none; border: none; color: #ef4444; font-size: 0.85rem; padding: 8px; cursor: pointer; width: 100%; margin-top: 12px; }

      .agg-status-message { font-size: 0.85rem; color: var(--agg-text-dim); text-align: center; margin-top: 12px; padding-top: 12px; border-top: 1px solid var(--agg-border); }

      .agg-results.is-hidden { display: none; }

      /* Dashboard */
      .dashboard-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 16px; }
      .metric-card { background: white; border: 1px solid var(--agg-border); border-radius: 12px; padding: 16px; display: flex; flex-direction: column; gap: 4px; border-left: 4px solid var(--agg-primary); }
      .metric-card label { font-size: 0.75rem; color: var(--agg-text-dim); font-weight: 600; text-transform: uppercase; }
      .metric-card .value { font-size: 1.5rem; font-weight: 700; color: var(--agg-text); }

      /* Charts */
      .chart-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(360px, 1fr)); gap: 20px; margin-top: 24px; }
      .chart-card { background: white; border: 1px solid var(--agg-border); border-radius: 12px; padding: 20px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
      .chart-card h4 { margin: 0 0 16px 0; font-size: 0.95rem; font-weight: 700; color: var(--agg-text); border-bottom: 2px solid #f1f5f9; padding-bottom: 10px; }
      .chart-bars { display: flex; flex-direction: column; gap: 12px; }
      .chart-bar-row { display: flex; align-items: center; gap: 12px; font-size: 0.85rem; }
      .chart-bar-label { width: 120px; text-overflow: ellipsis; overflow: hidden; white-space: nowrap; font-weight: 500; }
      .chart-bar-track { flex: 1; height: 12px; background: #f1f5f9; border-radius: 6px; overflow: hidden; }
      .chart-bar-fill { height: 100%; background: var(--agg-primary); border-radius: 6px; }
      .chart-bar-value { width: 30px; text-align: right; font-weight: 700; color: var(--agg-text-dim); }

      /* Results Styling */
      .agg-section-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
      .count-badge { background: var(--agg-primary); color: white; padding: 2px 8px; border-radius: 12px; font-size: 0.75rem; }

      .agg-table-container { background: white; border: 1px solid var(--agg-border); border-radius: 12px; overflow: auto; box-shadow: 0 1px 3px rgba(0,0,0,0.05); max-height: 500px; }
      .agg-table { width: 100%; border-collapse: collapse; font-size: 0.9rem; text-align: left; }
      .agg-table th { background: #f8fafc; padding: 12px; border-bottom: 1px solid var(--agg-border); font-weight: 600; color: var(--agg-text-dim); position: sticky; top: 0; }
      .agg-table td { padding: 12px; border-bottom: 1px solid var(--agg-border); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 200px; }
      .agg-table tr:hover { background: #f1f5f9; cursor: pointer; }

      .agg-empty-state { text-align: center; padding: 48px; color: var(--agg-text-dim); background: white; border: 2px dashed var(--agg-border); border-radius: 12px; }
      .agg-empty-state .icon { font-size: 2rem; margin-bottom: 12px; }

      /* Detail Modal Overhaul */
      .detail-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(15, 23, 42, 0.75); backdrop-filter: blur(4px); display: flex; align-items: flex-end; justify-content: center; z-index: 10000; }
      @media (min-width: 768px) { .detail-overlay { align-items: center; } }

      .detail-modal { background: white; width: 100%; max-width: 720px; border-radius: 20px 20px 0 0; display: flex; flex-direction: column; max-height: 94vh; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25); animation: slideUp 0.3s ease-out; }
      @media (min-width: 768px) { .detail-modal { border-radius: 16px; max-height: 85vh; } }

      @keyframes slideUp { from { transform: translateY(100px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

      .detail-modal-header { padding: 16px 24px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center; flex-shrink: 0; }
      .header-info { display: flex; gap: 12px; align-items: center; }
      .file-icon { font-size: 1.5rem; }
      .header-info h3 { margin: 0; font-size: 1.1rem; }
      .header-info p { margin: 0; font-size: 0.8rem; color: var(--agg-text-dim); }
      .close-btn { border: none; background: #f1f5f9; width: 32px; height: 32px; border-radius: 50%; font-size: 1rem; cursor: pointer; color: #64748b; }

      .detail-modal-body { padding: 24px; overflow-y: auto; flex: 1; }
      
      .form-view { display: flex; flex-direction: column; gap: 16px; }
      .detail-group-header { font-size: 0.8rem; font-weight: 700; color: var(--agg-primary); text-transform: uppercase; background: #eff6ff; padding: 4px 12px; border-radius: 4px; margin-top: 12px; }
      
      .detail-row { display: grid; grid-template-columns: 140px 1fr; gap: 16px; border-bottom: 1px solid #f1f5f9; padding-bottom: 12px; align-items: flex-start; }
      .detail-key { font-size: 0.85rem; font-weight: 600; color: #64748b; padding-top: 2px; }
      
      .val-null { color: #cbd5e1; font-family: monospace; }
      .val-bool.true { color: #16a34a; font-weight: bold; }
      .val-bool.false { color: #dc2626; font-weight: bold; }
      .val-text { line-height: 1.5; color: #0f172a; }
      .val-json { font-size: 0.8rem; background: #f8fafc; padding: 8px; border-radius: 6px; border: 1px solid #e2e8f0; margin: 0; }
      
      .raw-data-section { margin-top: 32px; border-top: 1px solid #e2e8f0; padding-top: 20px; }
      .raw-data-section summary { font-size: 0.85rem; font-weight: 600; cursor: pointer; color: var(--agg-text-dim); }
      .raw-data-section pre { margin-top: 12px; font-size: 0.75rem; background: #1e293b; color: #e2e8f0; padding: 12px; border-radius: 8px; overflow-x: auto; }

      .detail-form-preview { background: #ffffff; border: 1px solid #e2e8f0; border-radius: 12px; padding: 16px; }
      .detail-form-preview .form-row { margin-bottom: 16px; }
      .detail-form-preview .form-label { font-weight: 600; margin-bottom: 6px; display: block; }
      .detail-form-preview .form-input { width: 100%; padding: 8px 10px; border: 1px solid #cbd5f5; border-radius: 6px; background: #f8fafc; }
      .detail-form-preview .form-input.readonly { color: #0f172a; }
      .detail-form-preview .table-wrapper { overflow-x: auto; }
      .detail-form-preview table { border-collapse: collapse; width: 100%; font-size: 0.9rem; }
      .detail-form-preview th, .detail-form-preview td { border: 1px solid #e2e8f0; padding: 8px; text-align: left; }
      .detail-form-preview .remove-row-btn { display: none; }
      .detail-form-preview .tabs-nav { display: none; }
      .detail-form-preview .tab-content { display: block; }
      .detail-form-preview .form-toolbar { display: none; }
      .detail-form-preview .no-print { display: none; }
    </style>
  `;let Z=$.querySelector("#weba-agg-files"),X=$.querySelector("#weba-agg-dirs"),J=$.querySelector("#weba-agg-file-trigger"),q=$.querySelector("#weba-agg-dir-trigger"),G=$.querySelector("#weba-agg-status"),Q=$.querySelector("#weba-agg-output"),Y=$.querySelector("#weba-agg-dashboard"),U=$.querySelector("#weba-agg-results"),z=$.querySelector("#weba-agg-include-json"),H=$.querySelector("#weba-agg-run"),F=$.querySelector("#weba-agg-download"),V=$.querySelector("#weba-agg-download-jsonl"),D=$.querySelector("#weba-agg-key-status"),P=$.querySelector("#weba-agg-passkey"),A=$.querySelector("#weba-agg-clear"),N=$.querySelector("#weba-agg-build"),S="",f="",x=[],k=null,a=ZQ(),G0=XQ();if(D)D.textContent=a?.recipient_kid?`Loaded (${a.recipient_kid})`:a?"Loaded":"No keys detected",D.classList.toggle("ready",!!a);if(G0?.export?.jsonl===!1&&V)V.disabled=!0;if(N)N.textContent=o6(m4),N.title=m4?`Built at ${m4}`:"Build time not available";let l=(d)=>{if(!U)return;U.classList.toggle("is-hidden",!d)};P?.addEventListener("click",async()=>{try{if(!V8.getPublicKey()){if(!await V8.register())return}alert("Please authenticate with your Passkey to decrypt.");let d=new Uint8Array(32),c=await V8.derivePrf(d);if(!c)throw new Error("PRF not supported or enabled on this key, or authentication failed.");let o=await QZ(c);if(k={recipient_x25519_private:b0(o.privateKey)},P.textContent=" Passkey Active",P.disabled=!0,D)D.textContent="Passkey Enabled",D.classList.add("ready");if(Z?.files&&Z.files.length>0||X?.files&&X.files.length>0)b()}catch(d){console.error(d),alert("Passkey error: "+d.message)}}),J?.addEventListener("click",()=>Z?.click()),q?.addEventListener("click",()=>X?.click()),Z?.addEventListener("change",()=>b()),X?.addEventListener("change",()=>b());let b=async()=>{let d=Z?.files?Array.from(Z.files):[],c=X?.files?Array.from(X.files):[],o=[...d,...c].filter((v)=>v.name.toLowerCase().endsWith(".html")&&!v.name.startsWith("."));if(!(o.length>0)){if(G)G.textContent="Select HTML files first.";l(!1);return}if(G)G.textContent="Processing...";if(F)F.disabled=!0;if(V)V.disabled=!0;l(!0);let K=$.querySelector(".agg-brand h1");x=[];let L=[],O=new Set(["_filename"]),C=0,j=0,w=new T8(new Q4),I=k||a;if(K)K.innerHTML='Web/A Aggregator <span style="font-size:0.75rem; background:#10b981; color:white; padding:2px 8px; border-radius:4px; margin-left:8px; vertical-align:middle;">REAL DATA</span>';console.log(`Running aggregation on ${o.length} files...`);for(let v of o)try{let B0=await v.text(),K0=await JQ(B0,I,w);if(K0.source!=="unknown"&&K0.plain){x.push({filename:v.name,plain:K0.plain,sig:K0.sig});let k0=t4({plain:K0.plain,filename:v.name,includeJson:!!z?.checked,sig:K0.sig,omitKey:(m0)=>m0.startsWith("@")});k0.keys.forEach((m0)=>O.add(m0)),L.push({...k0.row,_raw:K0.plain,_sig:K0.sig}),C+=1}else console.warn(`Could not extract from ${v.name}`),j+=1}catch(B0){console.error(`Error processing ${v.name}`,B0),j+=1}let _=Array.from(O).sort((v,B0)=>{if(v==="_filename")return-1;if(B0==="_filename")return 1;return v.localeCompare(B0)});if(S=e4(L,_),F)F.disabled=L.length===0;let g=G0?.export?.jsonl!==!1;if(f=x.map((v)=>JSON.stringify({_filename:v.filename,_l2_sig:v.sig??null,...v.plain})).join(`
`),V)V.disabled=x.length===0||!g;if(G)G.textContent=`Completed. Processed ${C} entries. Errors: ${j}.`;if(Y)i6(Y,G0,x);if(Q)r6(Q,L,_)};A?.addEventListener("click",()=>{if(x=[],S="",f="",Z)Z.value="";if(X)X.value="";if(G)G.textContent="Data cleared.";if(F)F.disabled=!0;if(V)V.disabled=!0;if(Y)Y.innerHTML="";if(Q)Q.innerHTML="";l(!1),window._aggRows=[]}),H?.addEventListener("click",()=>{b().catch((d)=>{if(G)G.textContent="Failed to aggregate.";console.error(d)})}),F?.addEventListener("click",()=>{if(!S)return;let d=new Blob([S],{type:"text/csv;charset=utf-8"}),c=URL.createObjectURL(d),o=document.createElement("a");o.href=c,o.download="weba-aggregated.csv",o.click(),URL.revokeObjectURL(c)}),V?.addEventListener("click",()=>{if(!f)return;let d=new Blob([f],{type:"application/x-jsonlines;charset=utf-8"}),c=URL.createObjectURL(d),o=document.createElement("a");o.href=c,o.download="weba-aggregated.jsonl",o.click(),URL.revokeObjectURL(c)})}export{d4 as selectValues,r6 as renderTable,i6 as renderDashboard,w7 as initAggregatorBrowser,A7 as computeMetric};
