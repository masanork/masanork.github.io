var fX=Object.create;var{getPrototypeOf:SX,defineProperty:Y9,getOwnPropertyNames:xX}=Object;var vX=Object.prototype.hasOwnProperty;var U9=($,J,Z)=>{Z=$!=null?fX(SX($)):{};let q=J||!$||!$.__esModule?Y9(Z,"default",{value:$,enumerable:!0}):Z;for(let X of xX($))if(!vX.call(q,X))Y9(q,X,{get:()=>$[X],enumerable:!0});return q};var kX=($,J)=>()=>(J||$((J={exports:{}}).exports,J),J.exports);var XJ=kX((T5,QZ)=>{QZ.exports=function $(J){if(typeof J==="number"&&isNaN(J))throw new Error("NaN is not allowed");if(typeof J==="number"&&!isFinite(J))throw new Error("Infinity is not allowed");if(J===null||typeof J!=="object")return JSON.stringify(J);if(J.toJSON instanceof Function)return $(J.toJSON());if(Array.isArray(J))return`[${J.reduce((X,Q,G)=>{return`${X}${G===0?"":","}${$(Q===void 0||typeof Q==="symbol"?null:Q)}`},"")}]`;return`{${Object.keys(J).sort().reduce((q,X)=>{if(J[X]===void 0||typeof J[X]==="symbol")return q;let Q=q.length===0?"":",";return`${q}${Q}${$(X)}:${$(J[X])}`},"")}}`}});class l${runAutoCopy(){document.querySelectorAll("[data-copy-from]").forEach(($)=>{if(!$.dataset.dirty){let J=$.dataset.copyFrom;if(J){let X=($.closest("tr")||document).querySelector(`[data-base-key="${J}"], [data-json-path="${J}"]`);if(X&&X.value!==$.value)$.value=X.value,$.dispatchEvent(new Event("input",{bubbles:!0}))}}})}recalculate(){document.querySelectorAll("[data-formula]").forEach(($)=>{let J=$.dataset.formula;if(!J)return;let Z=$.closest("tr"),q=$.closest("table"),X=(G)=>{let Y=0,U="none";if(Z){let z=`[data-base-key="${G}"], [data-json-path="${G}"]`,W=Z.querySelector(z);if(W){if(U="row-input",W.value!=="")Y=parseFloat(W.value)}}if(U==="none"){let z=document.querySelector(`[data-json-path="${G}"]`);if(z){if(U="static-input",z.value!=="")Y=parseFloat(z.value)}}return Y},Q=J.replace(/SUM\(([a-zA-Z0-9_\-\u0080-\uFFFF]+)\)/g,(G,Y)=>{let U=0,z=q||document,W=z.querySelectorAll(`[data-base-key="${Y}"], [data-json-path="${Y}"]`);if(W.length===0&&z!==document)W=document.querySelectorAll(`[data-base-key="${Y}"], [data-json-path="${Y}"]`);return W.forEach((M)=>{let V=parseFloat(M.value);if(!isNaN(V))U+=V}),U});Q=Q.replace(/([a-zA-Z_\u0080-\uFFFF][a-zA-Z0-9_\-\u0080-\uFFFF]*)/g,(G)=>{if(["Math","round","floor","ceil","abs","min","max"].includes(G))return G;return String(X(G))});try{let G=new Function("return "+Q)();if(typeof G==="number"&&!isNaN(G))$.value=Number.isInteger(G)?G:G.toFixed(0);else $.value=""}catch(G){console.error("Calc Error:",G),$.value="Err"}}),this.runAutoCopy()}}/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function x8($){return $ instanceof Uint8Array||ArrayBuffer.isView($)&&$.constructor.name==="Uint8Array"}function T0($,J=""){if(!Number.isSafeInteger($)||$<0){let Z=J&&`"${J}" `;throw new Error(`${Z}expected integer >= 0, got ${$}`)}}function l($,J,Z=""){let q=x8($),X=$?.length,Q=J!==void 0;if(!q||Q&&X!==J){let G=Z&&`"${Z}" `,Y=Q?` of length ${J}`:"",U=q?`length=${X}`:`type=${typeof $}`;throw new Error(G+"expected Uint8Array"+Y+", got "+U)}return $}function v8($){if(typeof $!=="function"||typeof $.create!=="function")throw new Error("Hash must wrapped by utils.createHasher");T0($.outputLen),T0($.blockLen)}function b0($,J=!0){if($.destroyed)throw new Error("Hash instance has been destroyed");if(J&&$.finished)throw new Error("Hash#digest() has already been called")}function Z$($,J){l($,void 0,"digestInto() output");let Z=J.outputLen;if($.length<Z)throw new Error('"digestInto() output" expected to be of length >='+Z)}function q$($){return new Uint32Array($.buffer,$.byteOffset,Math.floor($.byteLength/4))}function B0(...$){for(let J=0;J<$.length;J++)$[J].fill(0)}function X$($){return new DataView($.buffer,$.byteOffset,$.byteLength)}function f0($,J){return $<<32-J|$>>>J}var _X=(()=>new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68)();function gX($){return $<<24&4278190080|$<<8&16711680|$>>>8&65280|$>>>24&255}function mX($){for(let J=0;J<$.length;J++)$[J]=gX($[J]);return $}var c$=_X?($)=>$:mX,z9=(()=>typeof Uint8Array.from([]).toHex==="function"&&typeof Uint8Array.fromHex==="function")(),yX=Array.from({length:256},($,J)=>J.toString(16).padStart(2,"0"));function H8($){if(l($),z9)return $.toHex();let J="";for(let Z=0;Z<$.length;Z++)J+=yX[$[Z]];return J}var y0={_0:48,_9:57,A:65,F:70,a:97,f:102};function W9($){if($>=y0._0&&$<=y0._9)return $-y0._0;if($>=y0.A&&$<=y0.F)return $-(y0.A-10);if($>=y0.a&&$<=y0.f)return $-(y0.a-10);return}function k8($){if(typeof $!=="string")throw new Error("hex string expected, got "+typeof $);if(z9)return Uint8Array.fromHex($);let J=$.length,Z=J/2;if(J%2)throw new Error("hex string expected, got unpadded hex of length "+J);let q=new Uint8Array(Z);for(let X=0,Q=0;X<Z;X++,Q+=2){let G=W9($.charCodeAt(Q)),Y=W9($.charCodeAt(Q+1));if(G===void 0||Y===void 0){let U=$[Q]+$[Q+1];throw new Error('hex string expected, got non-hex character "'+U+'" at index '+Q)}q[X]=G*16+Y}return q}function B8(...$){let J=0;for(let q=0;q<$.length;q++){let X=$[q];l(X),J+=X.length}let Z=new Uint8Array(J);for(let q=0,X=0;q<$.length;q++){let Q=$[q];Z.set(Q,X),X+=Q.length}return Z}function R8($,J={}){let Z=(X,Q)=>$(Q).update(X).digest(),q=$(void 0);return Z.outputLen=q.outputLen,Z.blockLen=q.blockLen,Z.create=(X)=>$(X),Object.assign(Z,J),Object.freeze(Z)}function Q8($=32){let J=typeof globalThis==="object"?globalThis.crypto:null;if(typeof J?.getRandomValues!=="function")throw new Error("crypto.getRandomValues must be defined");return J.getRandomValues(new Uint8Array($))}var o0=($)=>({oid:Uint8Array.from([6,9,96,134,72,1,101,3,4,2,$])});function M9($,J,Z){return $&J^~$&Z}function D9($,J,Z){return $&J^$&Z^J&Z}class Q${blockLen;outputLen;padOffset;isLE;buffer;view;finished=!1;length=0;pos=0;destroyed=!1;constructor($,J,Z,q){this.blockLen=$,this.outputLen=J,this.padOffset=Z,this.isLE=q,this.buffer=new Uint8Array($),this.view=X$(this.buffer)}update($){b0(this),l($);let{view:J,buffer:Z,blockLen:q}=this,X=$.length;for(let Q=0;Q<X;){let G=Math.min(q-this.pos,X-Q);if(G===q){let Y=X$($);for(;q<=X-Q;Q+=q)this.process(Y,Q);continue}if(Z.set($.subarray(Q,Q+G),this.pos),this.pos+=G,Q+=G,this.pos===q)this.process(J,0),this.pos=0}return this.length+=$.length,this.roundClean(),this}digestInto($){b0(this),Z$($,this),this.finished=!0;let{buffer:J,view:Z,blockLen:q,isLE:X}=this,{pos:Q}=this;if(J[Q++]=128,B0(this.buffer.subarray(Q)),this.padOffset>q-Q)this.process(Z,0),Q=0;for(let W=Q;W<q;W++)J[W]=0;Z.setBigUint64(q-8,BigInt(this.length*8),X),this.process(Z,0);let G=X$($),Y=this.outputLen;if(Y%4)throw new Error("_sha2: outputLen must be aligned to 32bit");let U=Y/4,z=this.get();if(U>z.length)throw new Error("_sha2: outputLen bigger than state");for(let W=0;W<U;W++)G.setUint32(4*W,z[W],X)}digest(){let{buffer:$,outputLen:J}=this;this.digestInto($);let Z=$.slice(0,J);return this.destroy(),Z}_cloneInto($){$||=new this.constructor,$.set(...this.get());let{blockLen:J,buffer:Z,length:q,finished:X,destroyed:Q,pos:G}=this;if($.destroyed=Q,$.finished=X,$.length=q,$.pos=G,q%J)$.buffer.set(Z);return $}clone(){return this._cloneInto()}}var h0=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),u0=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]),X0=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),Q0=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]);var G$=BigInt(4294967295),V9=BigInt(32);function bX($,J=!1){if(J)return{h:Number($&G$),l:Number($>>V9&G$)};return{h:Number($>>V9&G$)|0,l:Number($&G$)|0}}function Y$($,J=!1){let Z=$.length,q=new Uint32Array(Z),X=new Uint32Array(Z);for(let Q=0;Q<Z;Q++){let{h:G,l:Y}=bX($[Q],J);[q[Q],X[Q]]=[G,Y]}return[q,X]}var i$=($,J,Z)=>$>>>Z,n$=($,J,Z)=>$<<32-Z|J>>>Z,G8=($,J,Z)=>$>>>Z|J<<32-Z,Y8=($,J,Z)=>$<<32-Z|J>>>Z,_8=($,J,Z)=>$<<64-Z|J>>>Z-32,g8=($,J,Z)=>$>>>Z-32|J<<64-Z;var K9=($,J,Z)=>$<<Z|J>>>32-Z,O9=($,J,Z)=>J<<Z|$>>>32-Z,N9=($,J,Z)=>J<<Z-32|$>>>64-Z,H9=($,J,Z)=>$<<Z-32|J>>>64-Z;function x0($,J,Z,q){let X=(J>>>0)+(q>>>0);return{h:$+Z+(X/4294967296|0)|0,l:X|0}}var B9=($,J,Z)=>($>>>0)+(J>>>0)+(Z>>>0),R9=($,J,Z,q)=>J+Z+q+($/4294967296|0)|0,C9=($,J,Z,q)=>($>>>0)+(J>>>0)+(Z>>>0)+(q>>>0),F9=($,J,Z,q,X)=>J+Z+q+X+($/4294967296|0)|0,j9=($,J,Z,q,X)=>($>>>0)+(J>>>0)+(Z>>>0)+(q>>>0)+(X>>>0),T9=($,J,Z,q,X,Q)=>J+Z+q+X+Q+($/4294967296|0)|0;var uX=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),r0=new Uint32Array(64);class o$ extends Q${constructor($){super(64,$,8,!1)}get(){let{A:$,B:J,C:Z,D:q,E:X,F:Q,G,H:Y}=this;return[$,J,Z,q,X,Q,G,Y]}set($,J,Z,q,X,Q,G,Y){this.A=$|0,this.B=J|0,this.C=Z|0,this.D=q|0,this.E=X|0,this.F=Q|0,this.G=G|0,this.H=Y|0}process($,J){for(let W=0;W<16;W++,J+=4)r0[W]=$.getUint32(J,!1);for(let W=16;W<64;W++){let M=r0[W-15],V=r0[W-2],O=f0(M,7)^f0(M,18)^M>>>3,B=f0(V,17)^f0(V,19)^V>>>10;r0[W]=B+r0[W-7]+O+r0[W-16]|0}let{A:Z,B:q,C:X,D:Q,E:G,F:Y,G:U,H:z}=this;for(let W=0;W<64;W++){let M=f0(G,6)^f0(G,11)^f0(G,25),V=z+M+M9(G,Y,U)+uX[W]+r0[W]|0,B=(f0(Z,2)^f0(Z,13)^f0(Z,22))+D9(Z,q,X)|0;z=U,U=Y,Y=G,G=Q+V|0,Q=X,X=q,q=Z,Z=V+B|0}Z=Z+this.A|0,q=q+this.B|0,X=X+this.C|0,Q=Q+this.D|0,G=G+this.E|0,Y=Y+this.F|0,U=U+this.G|0,z=z+this.H|0,this.set(Z,q,X,Q,G,Y,U,z)}roundClean(){B0(r0)}destroy(){this.set(0,0,0,0,0,0,0,0),B0(this.buffer)}}class L9 extends o${A=h0[0]|0;B=h0[1]|0;C=h0[2]|0;D=h0[3]|0;E=h0[4]|0;F=h0[5]|0;G=h0[6]|0;H=h0[7]|0;constructor(){super(32)}}class pX extends o${A=u0[0]|0;B=u0[1]|0;C=u0[2]|0;D=u0[3]|0;E=u0[4]|0;F=u0[5]|0;G=u0[6]|0;H=u0[7]|0;constructor(){super(28)}}var I9=(()=>Y$(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(($)=>BigInt($))))(),dX=(()=>I9[0])(),lX=(()=>I9[1])(),s0=new Uint32Array(80),a0=new Uint32Array(80);class m8 extends Q${constructor($){super(128,$,16,!1)}get(){let{Ah:$,Al:J,Bh:Z,Bl:q,Ch:X,Cl:Q,Dh:G,Dl:Y,Eh:U,El:z,Fh:W,Fl:M,Gh:V,Gl:O,Hh:B,Hl:E}=this;return[$,J,Z,q,X,Q,G,Y,U,z,W,M,V,O,B,E]}set($,J,Z,q,X,Q,G,Y,U,z,W,M,V,O,B,E){this.Ah=$|0,this.Al=J|0,this.Bh=Z|0,this.Bl=q|0,this.Ch=X|0,this.Cl=Q|0,this.Dh=G|0,this.Dl=Y|0,this.Eh=U|0,this.El=z|0,this.Fh=W|0,this.Fl=M|0,this.Gh=V|0,this.Gl=O|0,this.Hh=B|0,this.Hl=E|0}process($,J){for(let N=0;N<16;N++,J+=4)s0[N]=$.getUint32(J),a0[N]=$.getUint32(J+=4);for(let N=16;N<80;N++){let F=s0[N-15]|0,f=a0[N-15]|0,k=G8(F,f,1)^G8(F,f,8)^i$(F,f,7),g=Y8(F,f,1)^Y8(F,f,8)^n$(F,f,7),y=s0[N-2]|0,w=a0[N-2]|0,T=G8(y,w,19)^_8(y,w,61)^i$(y,w,6),S=Y8(y,w,19)^g8(y,w,61)^n$(y,w,6),x=C9(g,S,a0[N-7],a0[N-16]),d=F9(x,k,T,s0[N-7],s0[N-16]);s0[N]=d|0,a0[N]=x|0}let{Ah:Z,Al:q,Bh:X,Bl:Q,Ch:G,Cl:Y,Dh:U,Dl:z,Eh:W,El:M,Fh:V,Fl:O,Gh:B,Gl:E,Hh:H,Hl:I}=this;for(let N=0;N<80;N++){let F=G8(W,M,14)^G8(W,M,18)^_8(W,M,41),f=Y8(W,M,14)^Y8(W,M,18)^g8(W,M,41),k=W&V^~W&B,g=M&O^~M&E,y=j9(I,f,g,lX[N],a0[N]),w=T9(y,H,F,k,dX[N],s0[N]),T=y|0,S=G8(Z,q,28)^_8(Z,q,34)^_8(Z,q,39),x=Y8(Z,q,28)^g8(Z,q,34)^g8(Z,q,39),d=Z&X^Z&G^X&G,D=q&Q^q&Y^Q&Y;H=B|0,I=E|0,B=V|0,E=O|0,V=W|0,O=M|0,{h:W,l:M}=x0(U|0,z|0,w|0,T|0),U=G|0,z=Y|0,G=X|0,Y=Q|0,X=Z|0,Q=q|0;let L=B9(T,x,D);Z=R9(L,w,S,d),q=L|0}({h:Z,l:q}=x0(this.Ah|0,this.Al|0,Z|0,q|0)),{h:X,l:Q}=x0(this.Bh|0,this.Bl|0,X|0,Q|0),{h:G,l:Y}=x0(this.Ch|0,this.Cl|0,G|0,Y|0),{h:U,l:z}=x0(this.Dh|0,this.Dl|0,U|0,z|0),{h:W,l:M}=x0(this.Eh|0,this.El|0,W|0,M|0),{h:V,l:O}=x0(this.Fh|0,this.Fl|0,V|0,O|0),{h:B,l:E}=x0(this.Gh|0,this.Gl|0,B|0,E|0),{h:H,l:I}=x0(this.Hh|0,this.Hl|0,H|0,I|0),this.set(Z,q,X,Q,G,Y,U,z,W,M,V,O,B,E,H,I)}roundClean(){B0(s0,a0)}destroy(){B0(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class w9 extends m8{Ah=Q0[0]|0;Al=Q0[1]|0;Bh=Q0[2]|0;Bl=Q0[3]|0;Ch=Q0[4]|0;Cl=Q0[5]|0;Dh=Q0[6]|0;Dl=Q0[7]|0;Eh=Q0[8]|0;El=Q0[9]|0;Fh=Q0[10]|0;Fl=Q0[11]|0;Gh=Q0[12]|0;Gl=Q0[13]|0;Hh=Q0[14]|0;Hl=Q0[15]|0;constructor(){super(64)}}class cX extends m8{Ah=X0[0]|0;Al=X0[1]|0;Bh=X0[2]|0;Bl=X0[3]|0;Ch=X0[4]|0;Cl=X0[5]|0;Dh=X0[6]|0;Dl=X0[7]|0;Eh=X0[8]|0;El=X0[9]|0;Fh=X0[10]|0;Fl=X0[11]|0;Gh=X0[12]|0;Gl=X0[13]|0;Hh=X0[14]|0;Hl=X0[15]|0;constructor(){super(48)}}var W0=Uint32Array.from([2352822216,424955298,1944164710,2312950998,502970286,855612546,1738396948,1479516111,258812777,2077511080,2011393907,79989058,1067287976,1780299464,286451373,2446758561]),z0=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);class iX extends m8{Ah=W0[0]|0;Al=W0[1]|0;Bh=W0[2]|0;Bl=W0[3]|0;Ch=W0[4]|0;Cl=W0[5]|0;Dh=W0[6]|0;Dl=W0[7]|0;Eh=W0[8]|0;El=W0[9]|0;Fh=W0[10]|0;Fl=W0[11]|0;Gh=W0[12]|0;Gl=W0[13]|0;Hh=W0[14]|0;Hl=W0[15]|0;constructor(){super(28)}}class nX extends m8{Ah=z0[0]|0;Al=z0[1]|0;Bh=z0[2]|0;Bl=z0[3]|0;Ch=z0[4]|0;Cl=z0[5]|0;Dh=z0[6]|0;Dl=z0[7]|0;Eh=z0[8]|0;El=z0[9]|0;Fh=z0[10]|0;Fl=z0[11]|0;Gh=z0[12]|0;Gl=z0[13]|0;Hh=z0[14]|0;Hl=z0[15]|0;constructor(){super(32)}}var R0=R8(()=>new L9,o0(1));var P9=R8(()=>new w9,o0(3));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */var E9=BigInt(0),A9=BigInt(1);function W$($,J=""){if(typeof $!=="boolean"){let Z=J&&`"${J}" `;throw new Error(Z+"expected boolean, got type="+typeof $)}return $}function oX($){if(typeof $==="bigint"){if(!U$($))throw new Error("positive bigint expected, got "+$)}else T0($);return $}function f9($){if(typeof $!=="string")throw new Error("hex string expected, got "+typeof $);return $===""?E9:BigInt("0x"+$)}function S9($){return f9(H8($))}function p0($){return f9(H8(U8(l($)).reverse()))}function r$($,J){T0(J),$=oX($);let Z=k8($.toString(16).padStart(J*2,"0"));if(Z.length!==J)throw new Error("number too large");return Z}function z$($,J){return r$($,J).reverse()}function U8($){return Uint8Array.from($)}var U$=($)=>typeof $==="bigint"&&E9<=$;function rX($,J,Z){return U$($)&&U$(J)&&U$(Z)&&J<=$&&$<Z}function C8($,J,Z,q){if(!rX(J,Z,q))throw new Error("expected valid "+$+": "+Z+" <= n < "+q+", got "+J)}var x9=($)=>(A9<<BigInt($))-A9;function W8($,J={},Z={}){if(!$||typeof $!=="object")throw new Error("expected valid options object");function q(Q,G,Y){let U=$[Q];if(Y&&U===void 0)return;let z=typeof U;if(z!==G||U===null)throw new Error(`param "${Q}" is invalid: expected ${G}, got ${z}`)}let X=(Q,G)=>Object.entries(Q).forEach(([Y,U])=>q(Y,U,G));X(J,!1),X(Z,!0)}function s$($){let J=new WeakMap;return(Z,...q)=>{let X=J.get(Z);if(X!==void 0)return X;let Q=$(Z,...q);return J.set(Z,Q),Q}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */var K0=BigInt(0),M0=BigInt(1),z8=BigInt(2),_9=BigInt(3),g9=BigInt(4),m9=BigInt(5),sX=BigInt(7),y9=BigInt(8),aX=BigInt(9),b9=BigInt(16);function r($,J){let Z=$%J;return Z>=K0?Z:J+Z}function w0($,J,Z){let q=$;while(J-- >K0)q*=q,q%=Z;return q}function v9($,J){if($===K0)throw new Error("invert: expected non-zero number");if(J<=K0)throw new Error("invert: expected positive modulus, got "+J);let Z=r($,J),q=J,X=K0,Q=M0,G=M0,Y=K0;while(Z!==K0){let z=q/Z,W=q%Z,M=X-G*z,V=Q-Y*z;q=Z,Z=W,X=G,Q=Y,G=M,Y=V}if(q!==M0)throw new Error("invert: does not exist");return r(X,J)}function a$($,J,Z){if(!$.eql($.sqr(J),Z))throw new Error("Cannot find square root")}function h9($,J){let Z=($.ORDER+M0)/g9,q=$.pow(J,Z);return a$($,q,J),q}function tX($,J){let Z=($.ORDER-m9)/y9,q=$.mul(J,z8),X=$.pow(q,Z),Q=$.mul(J,X),G=$.mul($.mul(Q,z8),X),Y=$.mul(Q,$.sub(G,$.ONE));return a$($,Y,J),Y}function eX($){let J=D$($),Z=u9($),q=Z(J,J.neg(J.ONE)),X=Z(J,q),Q=Z(J,J.neg(q)),G=($+sX)/b9;return(Y,U)=>{let z=Y.pow(U,G),W=Y.mul(z,q),M=Y.mul(z,X),V=Y.mul(z,Q),O=Y.eql(Y.sqr(W),U),B=Y.eql(Y.sqr(M),U);z=Y.cmov(z,W,O),W=Y.cmov(V,M,B);let E=Y.eql(Y.sqr(W),U),H=Y.cmov(z,W,E);return a$(Y,H,U),H}}function u9($){if($<_9)throw new Error("sqrt is not defined for small field");let J=$-M0,Z=0;while(J%z8===K0)J/=z8,Z++;let q=z8,X=D$($);while(k9(X,q)===1)if(q++>1000)throw new Error("Cannot find square root: probably non-prime P");if(Z===1)return h9;let Q=X.pow(q,J),G=(J+M0)/z8;return function Y(U,z){if(U.is0(z))return z;if(k9(U,z)!==1)throw new Error("Cannot find square root");let W=Z,M=U.mul(U.ONE,Q),V=U.pow(z,J),O=U.pow(z,G);while(!U.eql(V,U.ONE)){if(U.is0(V))return U.ZERO;let B=1,E=U.sqr(V);while(!U.eql(E,U.ONE))if(B++,E=U.sqr(E),B===W)throw new Error("Cannot find square root");let H=M0<<BigInt(W-B-1),I=U.pow(M,H);W=B,M=U.sqr(I),V=U.mul(V,M),O=U.mul(O,I)}return O}}function $Q($){if($%g9===_9)return h9;if($%y9===m9)return tX;if($%b9===aX)return eX($);return u9($)}var p9=($,J)=>(r($,J)&M0)===M0,JQ=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function d9($){let J={ORDER:"bigint",BYTES:"number",BITS:"number"},Z=JQ.reduce((q,X)=>{return q[X]="function",q},J);return W8($,Z),$}function ZQ($,J,Z){if(Z<K0)throw new Error("invalid exponent, negatives unsupported");if(Z===K0)return $.ONE;if(Z===M0)return J;let q=$.ONE,X=J;while(Z>K0){if(Z&M0)q=$.mul(q,X);X=$.sqr(X),Z>>=M0}return q}function M$($,J,Z=!1){let q=new Array(J.length).fill(Z?$.ZERO:void 0),X=J.reduce((G,Y,U)=>{if($.is0(Y))return G;return q[U]=G,$.mul(G,Y)},$.ONE),Q=$.inv(X);return J.reduceRight((G,Y,U)=>{if($.is0(Y))return G;return q[U]=$.mul(G,q[U]),$.mul(G,Y)},Q),q}function k9($,J){let Z=($.ORDER-M0)/z8,q=$.pow(J,Z),X=$.eql(q,$.ONE),Q=$.eql(q,$.ZERO),G=$.eql(q,$.neg($.ONE));if(!X&&!Q&&!G)throw new Error("invalid Legendre symbol result");return X?1:Q?0:-1}function qQ($,J){if(J!==void 0)T0(J);let Z=J!==void 0?J:$.toString(2).length,q=Math.ceil(Z/8);return{nBitLength:Z,nByteLength:q}}class l9{ORDER;BITS;BYTES;isLE;ZERO=K0;ONE=M0;_lengths;_sqrt;_mod;constructor($,J={}){if($<=K0)throw new Error("invalid field: expected ORDER > 0, got "+$);let Z=void 0;if(this.isLE=!1,J!=null&&typeof J==="object"){if(typeof J.BITS==="number")Z=J.BITS;if(typeof J.sqrt==="function")this.sqrt=J.sqrt;if(typeof J.isLE==="boolean")this.isLE=J.isLE;if(J.allowedLengths)this._lengths=J.allowedLengths?.slice();if(typeof J.modFromBytes==="boolean")this._mod=J.modFromBytes}let{nBitLength:q,nByteLength:X}=qQ($,Z);if(X>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");this.ORDER=$,this.BITS=q,this.BYTES=X,this._sqrt=void 0,Object.preventExtensions(this)}create($){return r($,this.ORDER)}isValid($){if(typeof $!=="bigint")throw new Error("invalid field element: expected bigint, got "+typeof $);return K0<=$&&$<this.ORDER}is0($){return $===K0}isValidNot0($){return!this.is0($)&&this.isValid($)}isOdd($){return($&M0)===M0}neg($){return r(-$,this.ORDER)}eql($,J){return $===J}sqr($){return r($*$,this.ORDER)}add($,J){return r($+J,this.ORDER)}sub($,J){return r($-J,this.ORDER)}mul($,J){return r($*J,this.ORDER)}pow($,J){return ZQ(this,$,J)}div($,J){return r($*v9(J,this.ORDER),this.ORDER)}sqrN($){return $*$}addN($,J){return $+J}subN($,J){return $-J}mulN($,J){return $*J}inv($){return v9($,this.ORDER)}sqrt($){if(!this._sqrt)this._sqrt=$Q(this.ORDER);return this._sqrt(this,$)}toBytes($){return this.isLE?z$($,this.BYTES):r$($,this.BYTES)}fromBytes($,J=!1){l($);let{_lengths:Z,BYTES:q,isLE:X,ORDER:Q,_mod:G}=this;if(Z){if(!Z.includes($.length)||$.length>q)throw new Error("Field.fromBytes: expected "+Z+" bytes, got "+$.length);let U=new Uint8Array(q);U.set($,X?0:U.length-$.length),$=U}if($.length!==q)throw new Error("Field.fromBytes: expected "+q+" bytes, got "+$.length);let Y=X?p0($):S9($);if(G)Y=r(Y,Q);if(!J){if(!this.isValid(Y))throw new Error("invalid field element: outside of range 0..ORDER")}return Y}invertBatch($){return M$(this,$)}cmov($,J,Z){return Z?J:$}}function D$($,J={}){return new l9($,J)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */var V$=BigInt(0),JJ=BigInt(1);function c9($,J){let Z=J.negate();return $?Z:J}function K$($,J){let Z=M$($.Fp,J.map((q)=>q.Z));return J.map((q,X)=>$.fromAffine(q.toAffine(Z[X])))}function r9($,J){if(!Number.isSafeInteger($)||$<=0||$>J)throw new Error("invalid window size, expected [1.."+J+"], got W="+$)}function t$($,J){r9($,J);let Z=Math.ceil(J/$)+1,q=2**($-1),X=2**$,Q=x9($),G=BigInt($);return{windows:Z,windowSize:q,mask:Q,maxNumber:X,shiftBy:G}}function i9($,J,Z){let{windowSize:q,mask:X,maxNumber:Q,shiftBy:G}=Z,Y=Number($&X),U=$>>G;if(Y>q)Y-=Q,U+=JJ;let z=J*q,W=z+Math.abs(Y)-1,M=Y===0,V=Y<0,O=J%2!==0;return{nextN:U,offset:W,isZero:M,isNeg:V,isNegF:O,offsetF:z}}var e$=new WeakMap,s9=new WeakMap;function $J($){return s9.get($)||1}function n9($){if($!==V$)throw new Error("invalid wNAF")}class ZJ{BASE;ZERO;Fn;bits;constructor($,J){this.BASE=$.BASE,this.ZERO=$.ZERO,this.Fn=$.Fn,this.bits=J}_unsafeLadder($,J,Z=this.ZERO){let q=$;while(J>V$){if(J&JJ)Z=Z.add(q);q=q.double(),J>>=JJ}return Z}precomputeWindow($,J){let{windows:Z,windowSize:q}=t$(J,this.bits),X=[],Q=$,G=Q;for(let Y=0;Y<Z;Y++){G=Q,X.push(G);for(let U=1;U<q;U++)G=G.add(Q),X.push(G);Q=G.double()}return X}wNAF($,J,Z){if(!this.Fn.isValid(Z))throw new Error("invalid scalar");let q=this.ZERO,X=this.BASE,Q=t$($,this.bits);for(let G=0;G<Q.windows;G++){let{nextN:Y,offset:U,isZero:z,isNeg:W,isNegF:M,offsetF:V}=i9(Z,G,Q);if(Z=Y,z)X=X.add(c9(M,J[V]));else q=q.add(c9(W,J[U]))}return n9(Z),{p:q,f:X}}wNAFUnsafe($,J,Z,q=this.ZERO){let X=t$($,this.bits);for(let Q=0;Q<X.windows;Q++){if(Z===V$)break;let{nextN:G,offset:Y,isZero:U,isNeg:z}=i9(Z,Q,X);if(Z=G,U)continue;else{let W=J[Y];q=q.add(z?W.negate():W)}}return n9(Z),q}getPrecomputes($,J,Z){let q=e$.get(J);if(!q){if(q=this.precomputeWindow(J,$),$!==1){if(typeof Z==="function")q=Z(q);e$.set(J,q)}}return q}cached($,J,Z){let q=$J($);return this.wNAF(q,this.getPrecomputes(q,$,Z),J)}unsafe($,J,Z,q){let X=$J($);if(X===1)return this._unsafeLadder($,J,q);return this.wNAFUnsafe(X,this.getPrecomputes(X,$,Z),J,q)}createCache($,J){r9(J,this.bits),s9.set($,J),e$.delete($)}hasCache($){return $J($)!==1}}function o9($,J,Z){if(J){if(J.ORDER!==$)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return d9(J),J}else return D$($,{isLE:Z})}function a9($,J,Z={},q){if(q===void 0)q=$==="edwards";if(!J||typeof J!=="object")throw new Error(`expected valid ${$} CURVE object`);for(let U of["p","n","h"]){let z=J[U];if(!(typeof z==="bigint"&&z>V$))throw new Error(`CURVE.${U} must be positive bigint`)}let X=o9(J.p,Z.Fp,q),Q=o9(J.n,Z.Fn,q),Y=["Gx","Gy","a",$==="weierstrass"?"b":"d"];for(let U of Y)if(!X.isValid(J[U]))throw new Error(`CURVE.${U} must be valid field element of CURVE.Fp`);return J=Object.freeze(Object.assign({},J)),{CURVE:J,Fp:X,Fn:Q}}function O$($,J){return function Z(q){let X=$(q);return{secretKey:X,publicKey:J(X)}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */var t0=BigInt(0),Z0=BigInt(1),qJ=BigInt(2),XQ=BigInt(8);function QQ($,J,Z,q){let X=$.sqr(Z),Q=$.sqr(q),G=$.add($.mul(J.a,X),Q),Y=$.add($.ONE,$.mul(J.d,$.mul(X,Q)));return $.eql(G,Y)}function t9($,J={}){let Z=a9("edwards",$,J,J.FpFnLE),{Fp:q,Fn:X}=Z,Q=Z.CURVE,{h:G}=Q;W8(J,{},{uvRatio:"function"});let Y=qJ<<BigInt(X.BYTES*8)-Z0,U=(H)=>q.create(H),z=J.uvRatio||((H,I)=>{try{return{isValid:!0,value:q.sqrt(q.div(H,I))}}catch(N){return{isValid:!1,value:t0}}});if(!QQ(q,Q,Q.Gx,Q.Gy))throw new Error("bad curve params: generator point");function W(H,I,N=!1){let F=N?Z0:t0;return C8("coordinate "+H,I,F,Y),I}function M(H){if(!(H instanceof B))throw new Error("EdwardsPoint expected")}let V=s$((H,I)=>{let{X:N,Y:F,Z:f}=H,k=H.is0();if(I==null)I=k?XQ:q.inv(f);let g=U(N*I),y=U(F*I),w=q.mul(f,I);if(k)return{x:t0,y:Z0};if(w!==Z0)throw new Error("invZ was invalid");return{x:g,y}}),O=s$((H)=>{let{a:I,d:N}=Q;if(H.is0())throw new Error("bad point: ZERO");let{X:F,Y:f,Z:k,T:g}=H,y=U(F*F),w=U(f*f),T=U(k*k),S=U(T*T),x=U(y*I),d=U(T*U(x+w)),D=U(S+U(N*U(y*w)));if(d!==D)throw new Error("bad point: equation left != right (1)");let L=U(F*f),C=U(k*g);if(L!==C)throw new Error("bad point: equation left != right (2)");return!0});class B{static BASE=new B(Q.Gx,Q.Gy,Z0,U(Q.Gx*Q.Gy));static ZERO=new B(t0,Z0,Z0,t0);static Fp=q;static Fn=X;X;Y;Z;T;constructor(H,I,N,F){this.X=W("x",H),this.Y=W("y",I),this.Z=W("z",N,!0),this.T=W("t",F),Object.freeze(this)}static CURVE(){return Q}static fromAffine(H){if(H instanceof B)throw new Error("extended point not allowed");let{x:I,y:N}=H||{};return W("x",I),W("y",N),new B(I,N,Z0,U(I*N))}static fromBytes(H,I=!1){let N=q.BYTES,{a:F,d:f}=Q;H=U8(l(H,N,"point")),W$(I,"zip215");let k=U8(H),g=H[N-1];k[N-1]=g&-129;let y=p0(k),w=I?Y:q.ORDER;C8("point.y",y,t0,w);let T=U(y*y),S=U(T-Z0),x=U(f*T-F),{isValid:d,value:D}=z(S,x);if(!d)throw new Error("bad point: invalid y coordinate");let L=(D&Z0)===Z0,C=(g&128)!==0;if(!I&&D===t0&&C)throw new Error("bad point: x=0 and x_0=1");if(C!==L)D=U(-D);return B.fromAffine({x:D,y})}static fromHex(H,I=!1){return B.fromBytes(k8(H),I)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(H=8,I=!0){if(E.createCache(this,H),!I)this.multiply(qJ);return this}assertValidity(){O(this)}equals(H){M(H);let{X:I,Y:N,Z:F}=this,{X:f,Y:k,Z:g}=H,y=U(I*g),w=U(f*F),T=U(N*g),S=U(k*F);return y===w&&T===S}is0(){return this.equals(B.ZERO)}negate(){return new B(U(-this.X),this.Y,this.Z,U(-this.T))}double(){let{a:H}=Q,{X:I,Y:N,Z:F}=this,f=U(I*I),k=U(N*N),g=U(qJ*U(F*F)),y=U(H*f),w=I+N,T=U(U(w*w)-f-k),S=y+k,x=S-g,d=y-k,D=U(T*x),L=U(S*d),C=U(T*d),j=U(x*S);return new B(D,L,j,C)}add(H){M(H);let{a:I,d:N}=Q,{X:F,Y:f,Z:k,T:g}=this,{X:y,Y:w,Z:T,T:S}=H,x=U(F*y),d=U(f*w),D=U(g*N*S),L=U(k*T),C=U((F+f)*(y+w)-x-d),j=L-D,A=L+D,v=U(d-I*x),_=U(C*j),h=U(A*v),m=U(C*v),p=U(j*A);return new B(_,h,p,m)}subtract(H){return this.add(H.negate())}multiply(H){if(!X.isValidNot0(H))throw new Error("invalid scalar: expected 1 <= sc < curve.n");let{p:I,f:N}=E.cached(this,H,(F)=>K$(B,F));return K$(B,[I,N])[0]}multiplyUnsafe(H,I=B.ZERO){if(!X.isValid(H))throw new Error("invalid scalar: expected 0 <= sc < curve.n");if(H===t0)return B.ZERO;if(this.is0()||H===Z0)return this;return E.unsafe(this,H,(N)=>K$(B,N),I)}isSmallOrder(){return this.multiplyUnsafe(G).is0()}isTorsionFree(){return E.unsafe(this,Q.n).is0()}toAffine(H){return V(this,H)}clearCofactor(){if(G===Z0)return this;return this.multiplyUnsafe(G)}toBytes(){let{x:H,y:I}=this.toAffine(),N=q.toBytes(I);return N[N.length-1]|=H&Z0?128:0,N}toHex(){return H8(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}let E=new ZJ(B,X.BITS);return B.BASE.precompute(8),B}function e9($,J,Z={}){if(typeof J!=="function")throw new Error('"hash" function param is required');W8(Z,{},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});let{prehash:q}=Z,{BASE:X,Fp:Q,Fn:G}=$,Y=Z.randomBytes||Q8,U=Z.adjustScalarBytes||((w)=>w),z=Z.domain||((w,T,S)=>{if(W$(S,"phflag"),T.length||S)throw new Error("Contexts/pre-hash are not supported");return w});function W(w){return G.create(p0(w))}function M(w){let T=F.secretKey;l(w,F.secretKey,"secretKey");let S=l(J(w),2*T,"hashedSecretKey"),x=U(S.slice(0,T)),d=S.slice(T,2*T),D=W(x);return{head:x,prefix:d,scalar:D}}function V(w){let{head:T,prefix:S,scalar:x}=M(w),d=X.multiply(x),D=d.toBytes();return{head:T,prefix:S,scalar:x,point:d,pointBytes:D}}function O(w){return V(w).pointBytes}function B(w=Uint8Array.of(),...T){let S=B8(...T);return W(J(z(S,l(w,void 0,"context"),!!q)))}function E(w,T,S={}){if(w=l(w,void 0,"message"),q)w=q(w);let{prefix:x,scalar:d,pointBytes:D}=V(T),L=B(S.context,x,w),C=X.multiply(L).toBytes(),j=B(S.context,C,D,w),A=G.create(L+j*d);if(!G.isValid(A))throw new Error("sign failed: invalid s");let v=B8(C,G.toBytes(A));return l(v,F.signature,"result")}let H={zip215:!0};function I(w,T,S,x=H){let{context:d,zip215:D}=x,L=F.signature;if(w=l(w,L,"signature"),T=l(T,void 0,"message"),S=l(S,F.publicKey,"publicKey"),D!==void 0)W$(D,"zip215");if(q)T=q(T);let C=L/2,j=w.subarray(0,C),A=p0(w.subarray(C,L)),v,_,h;try{v=$.fromBytes(S,D),_=$.fromBytes(j,D),h=X.multiplyUnsafe(A)}catch(U0){return!1}if(!D&&v.isSmallOrder())return!1;let m=B(d,_.toBytes(),v.toBytes(),T);return _.add(v.multiplyUnsafe(m)).subtract(h).clearCofactor().is0()}let N=Q.BYTES,F={secretKey:N,publicKey:N,signature:2*N,seed:N};function f(w=Y(F.seed)){return l(w,F.seed,"seed")}function k(w){return x8(w)&&w.length===G.BYTES}function g(w,T){try{return!!$.fromBytes(w,T)}catch(S){return!1}}let y={getExtendedPublicKey:V,randomSecretKey:f,isValidSecretKey:k,isValidPublicKey:g,toMontgomery(w){let{y:T}=$.fromBytes(w),S=F.publicKey,x=S===32;if(!x&&S!==57)throw new Error("only defined for 25519 and 448");let d=x?Q.div(Z0+T,Z0-T):Q.div(T-Z0,T+Z0);return Q.toBytes(d)},toMontgomerySecret(w){let T=F.secretKey;l(w,T);let S=J(w.subarray(0,T));return U(S).subarray(0,T)}};return Object.freeze({keygen:O$(f,O),getPublicKey:O,sign:E,verify:I,utils:y,Point:$,lengths:F})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */var y8=BigInt(0),F8=BigInt(1),N$=BigInt(2);function GQ($){return W8($,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...$})}function $Z($){let J=GQ($),{P:Z,type:q,adjustScalarBytes:X,powPminus2:Q,randomBytes:G}=J,Y=q==="x25519";if(!Y&&q!=="x448")throw new Error("invalid type");let U=G||Q8,z=Y?255:448,W=Y?32:56,M=Y?BigInt(9):BigInt(5),V=Y?BigInt(121665):BigInt(39081),O=Y?N$**BigInt(254):N$**BigInt(447),B=Y?BigInt(8)*N$**BigInt(251)-F8:BigInt(4)*N$**BigInt(445)-F8,E=O+B+F8,H=(L)=>r(L,Z),I=N(M);function N(L){return z$(H(L),W)}function F(L){let C=U8(l(L,W,"uCoordinate"));if(Y)C[31]&=127;return H(p0(C))}function f(L){return p0(X(U8(l(L,W,"scalar"))))}function k(L,C){let j=S(F(C),f(L));if(j===y8)throw new Error("invalid private or public key received");return N(j)}function g(L){return k(L,I)}let y=g,w=k;function T(L,C,j){let A=H(L*(C-j));return C=H(C-A),j=H(j+A),{x_2:C,x_3:j}}function S(L,C){C8("u",L,y8,Z),C8("scalar",C,O,E);let j=C,A=L,v=F8,_=y8,h=L,m=F8,p=y8;for(let i0=BigInt(z-1);i0>=y8;i0--){let I0=j>>i0&F8;p^=I0,{x_2:v,x_3:h}=T(p,v,h),{x_2:_,x_3:m}=T(p,_,m),p=I0;let n0=v+_,N8=H(n0*n0),f8=v-_,S8=H(f8*f8),Z9=N8-S8,AX=h+m,EX=h-m,q9=H(EX*n0),X9=H(AX*f8),Q9=q9+X9,G9=q9-X9;h=H(Q9*Q9),m=H(A*H(G9*G9)),v=H(N8*S8),_=H(Z9*(N8+H(V*Z9)))}({x_2:v,x_3:h}=T(p,v,h)),{x_2:_,x_3:m}=T(p,_,m);let U0=Q(_);return H(v*U0)}let x={secretKey:W,publicKey:W,seed:W},d=(L=U(W))=>{return l(L,x.seed,"seed"),L},D={randomSecretKey:d};return Object.freeze({keygen:O$(d,y),getSharedSecret:w,getPublicKey:y,scalarMult:k,scalarMultBase:g,utils:D,GuBytes:I.slice(),lengths:x})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */var YQ=BigInt(1),JZ=BigInt(2),UQ=BigInt(3),WQ=BigInt(5),zQ=BigInt(8),H$=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),MQ=(()=>({p:H$,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:zQ,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")}))();function qZ($){let J=BigInt(10),Z=BigInt(20),q=BigInt(40),X=BigInt(80),Q=H$,Y=$*$%Q*$%Q,U=w0(Y,JZ,Q)*Y%Q,z=w0(U,YQ,Q)*$%Q,W=w0(z,WQ,Q)*z%Q,M=w0(W,J,Q)*W%Q,V=w0(M,Z,Q)*M%Q,O=w0(V,q,Q)*V%Q,B=w0(O,X,Q)*O%Q,E=w0(B,X,Q)*O%Q,H=w0(E,J,Q)*W%Q;return{pow_p_5_8:w0(H,JZ,Q)*$%Q,b2:Y}}function XZ($){return $[0]&=248,$[31]&=127,$[31]|=64,$}var ZZ=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");function DQ($,J){let Z=H$,q=r(J*J*J,Z),X=r(q*q*J,Z),Q=qZ($*X).pow_p_5_8,G=r($*q*Q,Z),Y=r(J*G*G,Z),U=G,z=r(G*ZZ,Z),W=Y===$,M=Y===r(-$,Z),V=Y===r(-$*ZZ,Z);if(W)G=U;if(M||V)G=z;if(p9(G,Z))G=r(-G,Z);return{isValid:W||M,value:G}}var VQ=t9(MQ,{uvRatio:DQ});function KQ($){return e9(VQ,P9,Object.assign({adjustScalarBytes:XZ},$))}var e0=KQ({});var b8=(()=>{let $=H$;return $Z({P:$,type:"x25519",powPminus2:(J)=>{let{pow_p_5_8:Z,b2:q}=qZ(J);return r(w0(Z,UQ,$)*q,$)},adjustScalarBytes:XZ})})();var PZ=U9(XJ(),1);var QJ;try{QJ=new TextDecoder}catch($){}var b,D8,P=0;var zZ=[],OQ=105,NQ=57342,HQ=57343,GZ=57337;var YZ=6,j8={},h8=112810000,d0=16810000;var GJ=zZ,YJ=0,c={},s,C$,F$=0,p8=0,e,P0,a=[],UJ=[],C0,O0,u8,UZ={useRecords:!1,mapsAsObjects:!0},d8=!1,MZ=2;try{new Function("")}catch($){MZ=1/0}class $8{constructor($){if($){if(($.keyMap||$._keyMap)&&!$.useRecords)$.useRecords=!1,$.mapsAsObjects=!0;if($.useRecords===!1&&$.mapsAsObjects===void 0)$.mapsAsObjects=!0;if($.getStructures)$.getShared=$.getStructures;if($.getShared&&!$.structures)($.structures=[]).uninitialized=!0;if($.keyMap){this.mapKey=new Map;for(let[J,Z]of Object.entries($.keyMap))this.mapKey.set(Z,J)}}Object.assign(this,$)}decodeKey($){return this.keyMap?this.mapKey.get($)||$:$}encodeKey($){return this.keyMap&&this.keyMap.hasOwnProperty($)?this.keyMap[$]:$}encodeKeys($){if(!this._keyMap)return $;let J=new Map;for(let[Z,q]of Object.entries($))J.set(this._keyMap.hasOwnProperty(Z)?this._keyMap[Z]:Z,q);return J}decodeKeys($){if(!this._keyMap||$.constructor.name!="Map")return $;if(!this._mapKey){this._mapKey=new Map;for(let[Z,q]of Object.entries(this._keyMap))this._mapKey.set(q,Z)}let J={};return $.forEach((Z,q)=>J[A0(this._mapKey.has(q)?this._mapKey.get(q):q)]=Z),J}mapDecode($,J){let Z=this.decode($);if(this._keyMap)switch(Z.constructor.name){case"Array":return Z.map((q)=>this.decodeKeys(q))}return Z}decode($,J){if(b)return OZ(()=>{return j$(),this?this.decode($,J):$8.prototype.decode.call(UZ,$,J)});D8=J>-1?J:$.length,P=0,YJ=0,p8=0,C$=null,GJ=zZ,e=null,b=$;try{O0=$.dataView||($.dataView=new DataView($.buffer,$.byteOffset,$.byteLength))}catch(Z){if(b=null,$ instanceof Uint8Array)throw Z;throw new Error("Source must be a Uint8Array or Buffer but was a "+($&&typeof $=="object"?$.constructor.name:typeof $))}if(this instanceof $8){if(c=this,C0=this.sharedValues&&(this.pack?new Array(this.maxPrivatePackedValues||16).concat(this.sharedValues):this.sharedValues),this.structures)return s=this.structures,B$();else if(!s||s.length>0)s=[]}else{if(c=UZ,!s||s.length>0)s=[];C0=null}return B$()}decodeMultiple($,J){let Z,q=0;try{let X=$.length;d8=!0;let Q=this?this.decode($,X):KJ.decode($,X);if(J){if(J(Q)===!1)return;while(P<X)if(q=P,J(B$())===!1)return}else{Z=[Q];while(P<X)q=P,Z.push(B$());return Z}}catch(X){throw X.lastPosition=q,X.values=Z,X}finally{d8=!1,j$()}}}function B$(){try{let $=i();if(e){if(P>=e.postBundlePosition){let J=new Error("Unexpected bundle position");throw J.incomplete=!0,J}P=e.postBundlePosition,e=null}if(P==D8){if(s=null,b=null,P0)P0=null}else if(P>D8){let J=new Error("Unexpected end of CBOR data");throw J.incomplete=!0,J}else if(!d8)throw new Error("Data read, but end of buffer not reached");return $}catch($){if(j$(),$ instanceof RangeError||$.message.startsWith("Unexpected end of buffer"))$.incomplete=!0;throw $}}function i(){let $=b[P++],J=$>>5;if($=$&31,$>23)switch($){case 24:$=b[P++];break;case 25:if(J==7)return FQ();$=O0.getUint16(P),P+=2;break;case 26:if(J==7){let Z=O0.getFloat32(P);if(c.useFloat32>2){let q=T$[(b[P]&127)<<1|b[P+1]>>7];return P+=4,(q*Z+(Z>0?0.5:-0.5)>>0)/q}return P+=4,Z}$=O0.getUint32(P),P+=4;break;case 27:if(J==7){let Z=O0.getFloat64(P);return P+=8,Z}if(J>1){if(O0.getUint32(P)>0)throw new Error("JavaScript does not support arrays, maps, or strings with length over 4294967295");$=O0.getUint32(P+4)}else if(c.int64AsNumber)$=O0.getUint32(P)*4294967296,$+=O0.getUint32(P+4);else $=O0.getBigUint64(P);P+=8;break;case 31:switch(J){case 2:case 3:throw new Error("Indefinite length not supported for byte or text strings");case 4:let Z=[],q,X=0;while((q=i())!=j8){if(X>=h8)throw new Error(`Array length exceeds ${h8}`);Z[X++]=q}return J==4?Z:J==3?Z.join(""):Buffer.concat(Z);case 5:let Q;if(c.mapsAsObjects){let G={},Y=0;if(c.keyMap)while((Q=i())!=j8){if(Y++>=d0)throw new Error(`Property count exceeds ${d0}`);G[A0(c.decodeKey(Q))]=i()}else while((Q=i())!=j8){if(Y++>=d0)throw new Error(`Property count exceeds ${d0}`);G[A0(Q)]=i()}return G}else{if(u8)c.mapsAsObjects=!0,u8=!1;let G=new Map;if(c.keyMap){let Y=0;while((Q=i())!=j8){if(Y++>=d0)throw new Error(`Map size exceeds ${d0}`);G.set(c.decodeKey(Q),i())}}else{let Y=0;while((Q=i())!=j8){if(Y++>=d0)throw new Error(`Map size exceeds ${d0}`);G.set(Q,i())}}return G}case 7:return j8;default:throw new Error("Invalid major type for indefinite length "+J)}default:throw new Error("Unknown token "+$)}switch(J){case 0:return $;case 1:return~$;case 2:return CQ($);case 3:if(p8>=P)return C$.slice(P-F$,(P+=$)-F$);if(p8==0&&D8<140&&$<32){let X=$<16?DZ($):RQ($);if(X!=null)return X}return BQ($);case 4:if($>=h8)throw new Error(`Array length exceeds ${h8}`);let Z=new Array($);for(let X=0;X<$;X++)Z[X]=i();return Z;case 5:if($>=d0)throw new Error(`Map size exceeds ${h8}`);if(c.mapsAsObjects){let X={};if(c.keyMap)for(let Q=0;Q<$;Q++)X[A0(c.decodeKey(i()))]=i();else for(let Q=0;Q<$;Q++)X[A0(i())]=i();return X}else{if(u8)c.mapsAsObjects=!0,u8=!1;let X=new Map;if(c.keyMap)for(let Q=0;Q<$;Q++)X.set(c.decodeKey(i()),i());else for(let Q=0;Q<$;Q++)X.set(i(),i());return X}case 6:if($>=GZ){let X=s[$&8191];if(X){if(!X.read)X.read=WJ(X);return X.read()}if($<65536){if($==HQ){let Q=L8(),G=i(),Y=i();MJ(G,Y);let U={};if(c.keyMap)for(let z=2;z<Q;z++){let W=c.decodeKey(Y[z-2]);U[A0(W)]=i()}else for(let z=2;z<Q;z++){let W=Y[z-2];U[A0(W)]=i()}return U}else if($==NQ){let Q=L8(),G=i();for(let Y=2;Y<Q;Y++)MJ(G++,i());return i()}else if($==GZ)return PQ();if(c.getShared){if(VJ(),X=s[$&8191],X){if(!X.read)X.read=WJ(X);return X.read()}}}}let q=a[$];if(q)if(q.handlesRead)return q(i);else return q(i());else{let X=i();for(let Q=0;Q<UJ.length;Q++){let G=UJ[Q]($,X);if(G!==void 0)return G}return new v0(X,$)}case 7:switch($){case 20:return!1;case 21:return!0;case 22:return null;case 23:return;case 31:default:let X=(C0||M8())[$];if(X!==void 0)return X;throw new Error("Unknown token "+$)}default:if(isNaN($)){let X=new Error("Unexpected end of CBOR data");throw X.incomplete=!0,X}throw new Error("Unknown CBOR token "+$)}}var WZ=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function WJ($){if(!$)throw new Error("Structure is required in record definition");function J(){let Z=b[P++];if(Z=Z&31,Z>23)switch(Z){case 24:Z=b[P++];break;case 25:Z=O0.getUint16(P),P+=2;break;case 26:Z=O0.getUint32(P),P+=4;break;default:throw new Error("Expected array header, but got "+b[P-1])}let q=this.compiledReader;while(q){if(q.propertyCount===Z)return q(i);q=q.next}if(this.slowReads++>=MZ){let Q=this.length==Z?this:this.slice(0,Z);if(q=c.keyMap?new Function("r","return {"+Q.map((G)=>c.decodeKey(G)).map((G)=>WZ.test(G)?A0(G)+":r()":"["+JSON.stringify(G)+"]:r()").join(",")+"}"):new Function("r","return {"+Q.map((G)=>WZ.test(G)?A0(G)+":r()":"["+JSON.stringify(G)+"]:r()").join(",")+"}"),this.compiledReader)q.next=this.compiledReader;return q.propertyCount=Z,this.compiledReader=q,q(i)}let X={};if(c.keyMap)for(let Q=0;Q<Z;Q++)X[A0(c.decodeKey(this[Q]))]=i();else for(let Q=0;Q<Z;Q++)X[A0(this[Q])]=i();return X}return $.slowReads=0,J}function A0($){if(typeof $==="string")return $==="__proto__"?"__proto_":$;if(typeof $==="number"||typeof $==="boolean"||typeof $==="bigint")return $.toString();if($==null)return $+"";throw new Error("Invalid property name type "+typeof $)}var BQ=zJ;function zJ($){let J;if($<16){if(J=DZ($))return J}if($>64&&QJ)return QJ.decode(b.subarray(P,P+=$));let Z=P+$,q=[];J="";while(P<Z){let X=b[P++];if((X&128)===0)q.push(X);else if((X&224)===192){let Q=b[P++]&63;q.push((X&31)<<6|Q)}else if((X&240)===224){let Q=b[P++]&63,G=b[P++]&63;q.push((X&31)<<12|Q<<6|G)}else if((X&248)===240){let Q=b[P++]&63,G=b[P++]&63,Y=b[P++]&63,U=(X&7)<<18|Q<<12|G<<6|Y;if(U>65535)U-=65536,q.push(U>>>10&1023|55296),U=56320|U&1023;q.push(U)}else q.push(X);if(q.length>=4096)J+=q0.apply(String,q),q.length=0}if(q.length>0)J+=q0.apply(String,q);return J}var q0=String.fromCharCode;function RQ($){let J=P,Z=new Array($);for(let q=0;q<$;q++){let X=b[P++];if((X&128)>0){P=J;return}Z[q]=X}return q0.apply(String,Z)}function DZ($){if($<4)if($<2)if($===0)return"";else{let J=b[P++];if((J&128)>1){P-=1;return}return q0(J)}else{let J=b[P++],Z=b[P++];if((J&128)>0||(Z&128)>0){P-=2;return}if($<3)return q0(J,Z);let q=b[P++];if((q&128)>0){P-=3;return}return q0(J,Z,q)}else{let J=b[P++],Z=b[P++],q=b[P++],X=b[P++];if((J&128)>0||(Z&128)>0||(q&128)>0||(X&128)>0){P-=4;return}if($<6)if($===4)return q0(J,Z,q,X);else{let Q=b[P++];if((Q&128)>0){P-=5;return}return q0(J,Z,q,X,Q)}else if($<8){let Q=b[P++],G=b[P++];if((Q&128)>0||(G&128)>0){P-=6;return}if($<7)return q0(J,Z,q,X,Q,G);let Y=b[P++];if((Y&128)>0){P-=7;return}return q0(J,Z,q,X,Q,G,Y)}else{let Q=b[P++],G=b[P++],Y=b[P++],U=b[P++];if((Q&128)>0||(G&128)>0||(Y&128)>0||(U&128)>0){P-=8;return}if($<10)if($===8)return q0(J,Z,q,X,Q,G,Y,U);else{let z=b[P++];if((z&128)>0){P-=9;return}return q0(J,Z,q,X,Q,G,Y,U,z)}else if($<12){let z=b[P++],W=b[P++];if((z&128)>0||(W&128)>0){P-=10;return}if($<11)return q0(J,Z,q,X,Q,G,Y,U,z,W);let M=b[P++];if((M&128)>0){P-=11;return}return q0(J,Z,q,X,Q,G,Y,U,z,W,M)}else{let z=b[P++],W=b[P++],M=b[P++],V=b[P++];if((z&128)>0||(W&128)>0||(M&128)>0||(V&128)>0){P-=12;return}if($<14)if($===12)return q0(J,Z,q,X,Q,G,Y,U,z,W,M,V);else{let O=b[P++];if((O&128)>0){P-=13;return}return q0(J,Z,q,X,Q,G,Y,U,z,W,M,V,O)}else{let O=b[P++],B=b[P++];if((O&128)>0||(B&128)>0){P-=14;return}if($<15)return q0(J,Z,q,X,Q,G,Y,U,z,W,M,V,O,B);let E=b[P++];if((E&128)>0){P-=15;return}return q0(J,Z,q,X,Q,G,Y,U,z,W,M,V,O,B,E)}}}}}function CQ($){return c.copyBuffers?Uint8Array.prototype.slice.call(b,P,P+=$):b.subarray(P,P+=$)}var VZ=new Float32Array(1),R$=new Uint8Array(VZ.buffer,0,4);function FQ(){let $=b[P++],J=b[P++],Z=($&127)>>2;if(Z===31){if(J||$&3)return NaN;return $&128?-1/0:1/0}if(Z===0){let q=(($&3)<<8|J)/16777216;return $&128?-q:q}return R$[3]=$&128|(Z>>1)+56,R$[2]=($&7)<<5|J>>3,R$[1]=J<<5,R$[0]=0,VZ[0]}var L5=new Array(4096);class v0{constructor($,J){this.value=$,this.tag=J}}a[0]=($)=>{return new Date($)};a[1]=($)=>{return new Date(Math.round($*1000))};a[2]=($)=>{let J=BigInt(0);for(let Z=0,q=$.byteLength;Z<q;Z++)J=BigInt($[Z])+(J<<BigInt(8));return J};a[3]=($)=>{return BigInt(-1)-a[2]($)};a[4]=($)=>{return+($[1]+"e"+$[0])};a[5]=($)=>{return $[1]*Math.exp($[0]*Math.log(2))};var MJ=($,J)=>{$=$-57344;let Z=s[$];if(Z&&Z.isShared)(s.restoreStructures||(s.restoreStructures=[]))[$]=Z;s[$]=J,J.read=WJ(J)};a[OQ]=($)=>{let J=$.length,Z=$[1];MJ($[0],Z);let q={};for(let X=2;X<J;X++){let Q=Z[X-2];q[A0(Q)]=$[X]}return q};a[14]=($)=>{if(e)return e[0].slice(e.position0,e.position0+=$);return new v0($,14)};a[15]=($)=>{if(e)return e[1].slice(e.position1,e.position1+=$);return new v0($,15)};var jQ={Error,RegExp};a[27]=($)=>{return(jQ[$[0]]||Error)($[1],$[2])};var KZ=($)=>{if(b[P++]!=132){let Z=new Error("Packed values structure must be followed by a 4 element array");if(b.length<P)Z.incomplete=!0;throw Z}let J=$();if(!J||!J.length){let Z=new Error("Packed values structure must be followed by a 4 element array");throw Z.incomplete=!0,Z}return C0=C0?J.concat(C0.slice(J.length)):J,C0.prefixes=$(),C0.suffixes=$(),$()};KZ.handlesRead=!0;a[51]=KZ;a[YZ]=($)=>{if(!C0)if(c.getShared)VJ();else return new v0($,YZ);if(typeof $=="number")return C0[16+($>=0?2*$:-2*$-1)];let J=new Error("No support for non-integer packed references yet");if($===void 0)J.incomplete=!0;throw J};a[28]=($)=>{if(!P0)P0=new Map,P0.id=0;let J=P0.id++,Z=P,q=b[P],X;if(q>>5==4)X=[];else X={};let Q={target:X};P0.set(J,Q);let G=$();if(Q.used){if(Object.getPrototypeOf(X)!==Object.getPrototypeOf(G))P=Z,X=G,P0.set(J,{target:X}),G=$();return Object.assign(X,G)}return Q.target=G,G};a[28].handlesRead=!0;a[29]=($)=>{let J=P0.get($);return J.used=!0,J.target};a[258]=($)=>new Set($);(a[259]=($)=>{if(c.mapsAsObjects)c.mapsAsObjects=!1,u8=!0;return $()}).handlesRead=!0;function T8($,J){if(typeof $==="string")return $+J;if($ instanceof Array)return $.concat(J);return Object.assign({},$,J)}function M8(){if(!C0)if(c.getShared)VJ();else throw new Error("No packed values available");return C0}var TQ=1399353956;UJ.push(($,J)=>{if($>=225&&$<=255)return T8(M8().prefixes[$-224],J);if($>=28704&&$<=32767)return T8(M8().prefixes[$-28672],J);if($>=1879052288&&$<=2147483647)return T8(M8().prefixes[$-1879048192],J);if($>=216&&$<=223)return T8(J,M8().suffixes[$-216]);if($>=27647&&$<=28671)return T8(J,M8().suffixes[$-27639]);if($>=1811940352&&$<=1879048191)return T8(J,M8().suffixes[$-1811939328]);if($==TQ)return{packedValues:C0,structures:s.slice(0),version:J};if($==55799)return J});var LQ=new Uint8Array(new Uint16Array([1]).buffer)[0]==1,DJ=[Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,typeof BigUint64Array=="undefined"?{name:"BigUint64Array"}:BigUint64Array,Int8Array,Int16Array,Int32Array,typeof BigInt64Array=="undefined"?{name:"BigInt64Array"}:BigInt64Array,Float32Array,Float64Array],IQ=[64,68,69,70,71,72,77,78,79,85,86];for(let $=0;$<DJ.length;$++)wQ(DJ[$],IQ[$]);function wQ($,J){let Z="get"+$.name.slice(0,-5),q;if(typeof $==="function")q=$.BYTES_PER_ELEMENT;else $=null;for(let X=0;X<2;X++){if(!X&&q==1)continue;let Q=q==2?1:q==4?2:q==8?3:0;a[X?J:J-4]=q==1||X==LQ?(G)=>{if(!$)throw new Error("Could not find typed array for code "+J);if(!c.copyBuffers){if(q===1||q===2&&!(G.byteOffset&1)||q===4&&!(G.byteOffset&3)||q===8&&!(G.byteOffset&7))return new $(G.buffer,G.byteOffset,G.byteLength>>Q)}return new $(Uint8Array.prototype.slice.call(G,0).buffer)}:(G)=>{if(!$)throw new Error("Could not find typed array for code "+J);let Y=new DataView(G.buffer,G.byteOffset,G.byteLength),U=G.length>>Q,z=new $(U),W=Y[Z];for(let M=0;M<U;M++)z[M]=W.call(Y,M<<Q,X);return z}}}function PQ(){let $=L8(),J=P+i();for(let q=2;q<$;q++){let X=L8();P+=X}let Z=P;return P=J,e=[zJ(L8()),zJ(L8())],e.position0=0,e.position1=0,e.postBundlePosition=P,P=Z,i()}function L8(){let $=b[P++]&31;if($>23)switch($){case 24:$=b[P++];break;case 25:$=O0.getUint16(P),P+=2;break;case 26:$=O0.getUint32(P),P+=4;break}return $}function VJ(){if(c.getShared){let $=OZ(()=>{return b=null,c.getShared()})||{},J=$.structures||[];if(c.sharedVersion=$.version,C0=c.sharedValues=$.packedValues,s===!0)c.structures=s=J;else s.splice.apply(s,[0,J.length].concat(J))}}function OZ($){let J=D8,Z=P,q=YJ,X=F$,Q=p8,G=C$,Y=GJ,U=P0,z=e,W=new Uint8Array(b.slice(0,D8)),M=s,V=c,O=d8,B=$();return D8=J,P=Z,YJ=q,F$=X,p8=Q,C$=G,GJ=Y,P0=U,e=z,b=W,d8=O,s=M,c=V,O0=new DataView(b.buffer,b.byteOffset,b.byteLength),B}function j$(){b=null,P0=null,s=null}var T$=new Array(147);for(let $=0;$<256;$++)T$[$]=+("1e"+Math.floor(45.15-$*0.30103));var KJ=new $8({useRecords:!1}),L$=KJ.decode,AQ=KJ.decodeMultiple;var I$;try{I$=new TextEncoder}catch($){}var RJ,jZ,P$=typeof globalThis==="object"&&globalThis.Buffer,l8=typeof P$!=="undefined",OJ=l8?P$.allocUnsafeSlow:Uint8Array,NZ=l8?P$:Uint8Array,HZ=256,BZ=l8?4294967296:2144337920;var NJ,R,n,K=0,J8,$0=null,EQ=61440,fQ=/[\u0080-\uFFFF]/,L0=Symbol("record-id");class A$ extends $8{constructor($){super($);this.offset=0;let J,Z,q,X,Q,G;$=$||{};let Y=NZ.prototype.utf8Write?function(D,L,C){return R.utf8Write(D,L,C)}:I$&&I$.encodeInto?function(D,L){return I$.encodeInto(D,R.subarray(L)).written}:!1,U=this,z=$.structures||$.saveStructures,W=$.maxSharedStructures;if(W==null)W=z?128:0;if(W>8190)throw new Error("Maximum maxSharedStructure is 8190");let M=$.sequential;if(M)W=0;if(!this.structures)this.structures=[];if(this.saveStructures)this.saveShared=this.saveStructures;let V,O,B=$.sharedValues,E;if(B){E=Object.create(null);for(let D=0,L=B.length;D<L;D++)E[B[D]]=D}let H=[],I=0,N=0;this.mapEncode=function(D,L){if(this._keyMap&&!this._mapped)switch(D.constructor.name){case"Array":D=D.map((C)=>this.encodeKeys(C));break}return this.encode(D,L)},this.encode=function(D,L){if(!R)R=new OJ(8192),n=new DataView(R.buffer,0,8192),K=0;if(J8=R.length-10,J8-K<2048)R=new OJ(R.length),n=new DataView(R.buffer,0,R.length),J8=R.length-10,K=0;else if(L===FJ)K=K+7&2147483640;if(Z=K,U.useSelfDescribedHeader)n.setUint32(K,3654940416),K+=3;if(G=U.structuredClone?new Map:null,U.bundleStrings&&typeof D!=="string")$0=[],$0.size=1/0;else $0=null;if(q=U.structures,q){if(q.uninitialized){let j=U.getShared()||{};U.structures=q=j.structures||[],U.sharedVersion=j.version;let A=U.sharedValues=j.packedValues;if(A){E={};for(let v=0,_=A.length;v<_;v++)E[A[v]]=v}}let C=q.length;if(C>W&&!M)C=W;if(!q.transitions){q.transitions=Object.create(null);for(let j=0;j<C;j++){let A=q[j];if(!A)continue;let v,_=q.transitions;for(let h=0,m=A.length;h<m;h++){if(_[L0]===void 0)_[L0]=j;let p=A[h];if(v=_[p],!v)v=_[p]=Object.create(null);_=v}_[L0]=j|1048576}}if(!M)q.nextId=C}if(X)X=!1;if(Q=q||[],O=E,$.pack){let C=new Map;if(C.values=[],C.encoder=U,C.maxValues=$.maxPrivatePackedValues||(E?16:1/0),C.objectMap=E||!1,C.samplingPackedValues=V,w$(D,C),C.values.length>0){R[K++]=216,R[K++]=51,_0(4);let j=C.values;F(j),_0(0),_0(0),O=Object.create(E||null);for(let A=0,v=j.length;A<v;A++)O[j[A]]=A}}NJ=L&BJ;try{if(NJ)return;if(F(D),$0)CZ(Z,F);if(U.offset=K,G&&G.idsToInsert){if(K+=G.idsToInsert.length*2,K>J8)k(K);U.offset=K;let C=vQ(R.subarray(Z,K),G.idsToInsert);return G=null,C}if(L&FJ)return R.start=Z,R.end=K,R;return R.subarray(Z,K)}finally{if(q){if(N<10)N++;if(q.length>W)q.length=W;if(I>1e4){if(q.transitions=null,N=0,I=0,H.length>0)H=[]}else if(H.length>0&&!M){for(let C=0,j=H.length;C<j;C++)H[C][L0]=void 0;H=[]}}if(X&&U.saveShared){if(U.structures.length>W)U.structures=U.structures.slice(0,W);let C=R.subarray(Z,K);if(U.updateSharedData()===!1)return U.encode(D);return C}if(L&mQ)K=Z}},this.findCommonStringsToPack=()=>{if(V=new Map,!E)E=Object.create(null);return(D)=>{let L=D&&D.threshold||4,C=this.pack?D.maxPrivatePackedValues||16:0;if(!B)B=this.sharedValues=[];for(let[j,A]of V)if(A.count>L)E[j]=C++,B.push(j),X=!0;while(this.saveShared&&this.updateSharedData()===!1);V=null}};let F=(D)=>{if(K>J8)R=k(K);var L=typeof D,C;if(L==="string"){if(O){let _=O[D];if(_>=0){if(_<16)R[K++]=_+224;else if(R[K++]=198,_&1)F(15-_>>1);else F(_-16>>1);return}else if(V&&!$.pack){let h=V.get(D);if(h)h.count++;else V.set(D,{count:1})}}let j=D.length;if($0&&j>=4&&j<1024){if(($0.size+=j)>EQ){let h,m=($0[0]?$0[0].length*3+$0[1].length:0)+10;if(K+m>J8)R=k(K+m);if(R[K++]=217,R[K++]=223,R[K++]=249,R[K++]=$0.position?132:130,R[K++]=26,h=K-Z,K+=4,$0.position)CZ(Z,F);$0=["",""],$0.size=0,$0.position=h}let _=fQ.test(D);$0[_?0:1]+=D,R[K++]=_?206:207,F(j);return}let A;if(j<32)A=1;else if(j<256)A=2;else if(j<65536)A=3;else A=5;let v=j*3;if(K+v>J8)R=k(K+v);if(j<64||!Y){let _,h,m,p=K+A;for(_=0;_<j;_++)if(h=D.charCodeAt(_),h<128)R[p++]=h;else if(h<2048)R[p++]=h>>6|192,R[p++]=h&63|128;else if((h&64512)===55296&&((m=D.charCodeAt(_+1))&64512)===56320)h=65536+((h&1023)<<10)+(m&1023),_++,R[p++]=h>>18|240,R[p++]=h>>12&63|128,R[p++]=h>>6&63|128,R[p++]=h&63|128;else R[p++]=h>>12|224,R[p++]=h>>6&63|128,R[p++]=h&63|128;C=p-K-A}else C=Y(D,K+A,v);if(C<24)R[K++]=96|C;else if(C<256){if(A<2)R.copyWithin(K+2,K+1,K+1+C);R[K++]=120,R[K++]=C}else if(C<65536){if(A<3)R.copyWithin(K+3,K+2,K+2+C);R[K++]=121,R[K++]=C>>8,R[K++]=C&255}else{if(A<5)R.copyWithin(K+5,K+3,K+3+C);R[K++]=122,n.setUint32(K,C),K+=4}K+=C}else if(L==="number")if(!this.alwaysUseFloat&&D>>>0===D)if(D<24)R[K++]=D;else if(D<256)R[K++]=24,R[K++]=D;else if(D<65536)R[K++]=25,R[K++]=D>>8,R[K++]=D&255;else R[K++]=26,n.setUint32(K,D),K+=4;else if(!this.alwaysUseFloat&&D>>0===D)if(D>=-24)R[K++]=31-D;else if(D>=-256)R[K++]=56,R[K++]=~D;else if(D>=-65536)R[K++]=57,n.setUint16(K,~D),K+=2;else R[K++]=58,n.setUint32(K,~D),K+=4;else{let j;if((j=this.useFloat32)>0&&D<4294967296&&D>=-2147483648){R[K++]=250,n.setFloat32(K,D);let A;if(j<4||(A=D*T$[(R[K]&127)<<1|R[K+1]>>7])>>0===A){K+=4;return}else K--}R[K++]=251,n.setFloat64(K,D),K+=8}else if(L==="object")if(!D)R[K++]=246;else{if(G){let A=G.get(D);if(A){if(R[K++]=216,R[K++]=29,R[K++]=25,!A.references){let v=G.idsToInsert||(G.idsToInsert=[]);A.references=[],v.push(A)}A.references.push(K-Z),K+=2;return}else G.set(D,{offset:K-Z})}let j=D.constructor;if(j===Object)f(D);else if(j===Array){if(C=D.length,C<24)R[K++]=128|C;else _0(C);for(let A=0;A<C;A++)F(D[A])}else if(j===Map){if(this.mapsAsObjects?this.useTag259ForMaps!==!1:this.useTag259ForMaps)R[K++]=217,R[K++]=1,R[K++]=3;if(C=D.size,C<24)R[K++]=160|C;else if(C<256)R[K++]=184,R[K++]=C;else if(C<65536)R[K++]=185,R[K++]=C>>8,R[K++]=C&255;else R[K++]=186,n.setUint32(K,C),K+=4;if(U.keyMap)for(let[A,v]of D)F(U.encodeKey(A)),F(v);else for(let[A,v]of D)F(A),F(v)}else{for(let A=0,v=RJ.length;A<v;A++){let _=jZ[A];if(D instanceof _){let h=RJ[A],m=h.tag;if(m==null)m=h.getTag&&h.getTag.call(this,D);if(m<24)R[K++]=192|m;else if(m<256)R[K++]=216,R[K++]=m;else if(m<65536)R[K++]=217,R[K++]=m>>8,R[K++]=m&255;else if(m>-1)R[K++]=218,n.setUint32(K,m),K+=4;h.encode.call(this,D,F,k);return}}if(D[Symbol.iterator]){if(NJ){let A=new Error("Iterable should be serialized as iterator");throw A.iteratorNotHandled=!0,A}R[K++]=159;for(let A of D)F(A);R[K++]=255;return}if(D[Symbol.asyncIterator]||HJ(D)){let A=new Error("Iterable/blob should be serialized as iterator");throw A.iteratorNotHandled=!0,A}if(this.useToJSON&&D.toJSON){let A=D.toJSON();if(A!==D)return F(A)}f(D)}}else if(L==="boolean")R[K++]=D?245:244;else if(L==="bigint"){if(D<BigInt(1)<<BigInt(64)&&D>=0)R[K++]=27,n.setBigUint64(K,D);else if(D>-(BigInt(1)<<BigInt(64))&&D<0)R[K++]=59,n.setBigUint64(K,-D-BigInt(1));else if(this.largeBigIntToFloat)R[K++]=251,n.setFloat64(K,Number(D));else{if(D>=BigInt(0))R[K++]=194;else R[K++]=195,D=BigInt(-1)-D;let j=[];while(D)j.push(Number(D&BigInt(255))),D>>=BigInt(8);CJ(new Uint8Array(j.reverse()),k);return}K+=8}else if(L==="undefined")R[K++]=247;else throw new Error("Unknown type: "+L)},f=this.useRecords===!1?this.variableMapSize?(D)=>{let L=Object.keys(D),C=Object.values(D),j=L.length;if(j<24)R[K++]=160|j;else if(j<256)R[K++]=184,R[K++]=j;else if(j<65536)R[K++]=185,R[K++]=j>>8,R[K++]=j&255;else R[K++]=186,n.setUint32(K,j),K+=4;let A;if(U.keyMap)for(let v=0;v<j;v++)F(U.encodeKey(L[v])),F(C[v]);else for(let v=0;v<j;v++)F(L[v]),F(C[v])}:(D)=>{R[K++]=185;let L=K-Z;K+=2;let C=0;if(U.keyMap){for(let j in D)if(typeof D.hasOwnProperty!=="function"||D.hasOwnProperty(j))F(U.encodeKey(j)),F(D[j]),C++}else for(let j in D)if(typeof D.hasOwnProperty!=="function"||D.hasOwnProperty(j))F(j),F(D[j]),C++;R[L+++Z]=C>>8,R[L+Z]=C&255}:(D,L)=>{let C,j=Q.transitions||(Q.transitions=Object.create(null)),A=0,v=0,_,h;if(this.keyMap){h=Object.keys(D).map((p)=>this.encodeKey(p)),v=h.length;for(let p=0;p<v;p++){let U0=h[p];if(C=j[U0],!C)C=j[U0]=Object.create(null),A++;j=C}}else for(let p in D)if(typeof D.hasOwnProperty!=="function"||D.hasOwnProperty(p)){if(C=j[p],!C){if(j[L0]&1048576)_=j[L0]&65535;C=j[p]=Object.create(null),A++}j=C,v++}let m=j[L0];if(m!==void 0)m&=65535,R[K++]=217,R[K++]=m>>8|224,R[K++]=m&255;else{if(!h)h=j.__keys__||(j.__keys__=Object.keys(D));if(_===void 0){if(m=Q.nextId++,!m)m=0,Q.nextId=1;if(m>=HZ)Q.nextId=(m=W)+1}else m=_;if(Q[m]=h,m<W){R[K++]=217,R[K++]=m>>8|224,R[K++]=m&255,j=Q.transitions;for(let p=0;p<v;p++){if(j[L0]===void 0||j[L0]&1048576)j[L0]=m;j=j[h[p]]}j[L0]=m|1048576,X=!0}else{if(j[L0]=m,n.setUint32(K,3655335680),K+=3,A)I+=N*A;if(H.length>=HZ-W)H.shift()[L0]=void 0;if(H.push(j),_0(v+2),F(57344+m),F(h),L)return;for(let p in D)if(typeof D.hasOwnProperty!=="function"||D.hasOwnProperty(p))F(D[p]);return}}if(v<24)R[K++]=128|v;else _0(v);if(L)return;for(let p in D)if(typeof D.hasOwnProperty!=="function"||D.hasOwnProperty(p))F(D[p])},k=(D)=>{let L;if(D>16777216){if(D-Z>BZ)throw new Error("Encoded buffer would be larger than maximum buffer size");L=Math.min(BZ,Math.round(Math.max((D-Z)*(D>67108864?1.25:2),4194304)/4096)*4096)}else L=(Math.max(D-Z<<2,R.length-1)>>12)+1<<12;let C=new OJ(L);if(n=new DataView(C.buffer,0,L),R.copy)R.copy(C,0,Z,D);else C.set(R.slice(Z,D));return K-=Z,Z=0,J8=C.length-10,R=C},g=100,y=1000;this.encodeAsIterable=function(D,L){return x(D,L,w)},this.encodeAsAsyncIterable=function(D,L){return x(D,L,d)};function*w(D,L,C){let j=D.constructor;if(j===Object){let A=U.useRecords!==!1;if(A)f(D,!0);else RZ(Object.keys(D).length,160);for(let v in D){let _=D[v];if(!A)F(v);if(_&&typeof _==="object")if(L[v])yield*w(_,L[v]);else yield*T(_,L,v);else F(_)}}else if(j===Array){let A=D.length;_0(A);for(let v=0;v<A;v++){let _=D[v];if(_&&(typeof _==="object"||K-Z>g))if(L.element)yield*w(_,L.element);else yield*T(_,L,"element");else F(_)}}else if(D[Symbol.iterator]&&!D.buffer){R[K++]=159;for(let A of D)if(A&&(typeof A==="object"||K-Z>g))if(L.element)yield*w(A,L.element);else yield*T(A,L,"element");else F(A);R[K++]=255}else if(HJ(D))RZ(D.size,64),yield R.subarray(Z,K),yield D,S();else if(D[Symbol.asyncIterator])R[K++]=159,yield R.subarray(Z,K),yield D,S(),R[K++]=255;else F(D);if(C&&K>Z)yield R.subarray(Z,K);else if(K-Z>g)yield R.subarray(Z,K),S()}function*T(D,L,C){let j=K-Z;try{if(F(D),K-Z>g)yield R.subarray(Z,K),S()}catch(A){if(A.iteratorNotHandled)L[C]={},K=Z+j,yield*w.call(this,D,L[C]);else throw A}}function S(){g=y,U.encode(null,BJ)}function x(D,L,C){if(L&&L.chunkThreshold)g=y=L.chunkThreshold;else g=100;if(D&&typeof D==="object")return U.encode(null,BJ),C(D,U.iterateProperties||(U.iterateProperties={}),!0);return[U.encode(D)]}async function*d(D,L){for(let C of w(D,L,!0)){let j=C.constructor;if(j===NZ||j===Uint8Array)yield C;else if(HJ(C)){let A=C.stream().getReader(),v;while(!(v=await A.read()).done)yield v.value}else if(C[Symbol.asyncIterator])for await(let A of C)if(S(),A)yield*d(A,L.async||(L.async={}));else yield U.encode(A);else yield C}}}useBuffer($){R=$,n=new DataView(R.buffer,R.byteOffset,R.byteLength),K=0}clearSharedData(){if(this.structures)this.structures=[];if(this.sharedValues)this.sharedValues=void 0}updateSharedData(){let $=this.sharedVersion||0;this.sharedVersion=$+1;let J=this.structures.slice(0),Z=new jJ(J,this.sharedValues,this.sharedVersion),q=this.saveShared(Z,(X)=>(X&&X.version||0)==$);if(q===!1)Z=this.getShared()||{},this.structures=Z.structures||[],this.sharedValues=Z.packedValues,this.sharedVersion=Z.version,this.structures.nextId=this.structures.length;else J.forEach((X,Q)=>this.structures[Q]=X);return q}}function RZ($,J){if($<24)R[K++]=J|$;else if($<256)R[K++]=J|24,R[K++]=$;else if($<65536)R[K++]=J|25,R[K++]=$>>8,R[K++]=$&255;else R[K++]=J|26,n.setUint32(K,$),K+=4}class jJ{constructor($,J,Z){this.structures=$,this.packedValues=J,this.version=Z}}function _0($){if($<24)R[K++]=128|$;else if($<256)R[K++]=152,R[K++]=$;else if($<65536)R[K++]=153,R[K++]=$>>8,R[K++]=$&255;else R[K++]=154,n.setUint32(K,$),K+=4}var SQ=typeof Blob==="undefined"?function(){}:Blob;function HJ($){if($ instanceof SQ)return!0;let J=$[Symbol.toStringTag];return J==="Blob"||J==="File"}function w$($,J){switch(typeof $){case"string":if($.length>3){if(J.objectMap[$]>-1||J.values.length>=J.maxValues)return;let q=J.get($);if(q){if(++q.count==2)J.values.push($)}else if(J.set($,{count:1}),J.samplingPackedValues){let X=J.samplingPackedValues.get($);if(X)X.count++;else J.samplingPackedValues.set($,{count:1})}}break;case"object":if($)if($ instanceof Array)for(let q=0,X=$.length;q<X;q++)w$($[q],J);else{let q=!J.encoder.useRecords;for(var Z in $)if($.hasOwnProperty(Z)){if(q)w$(Z,J);w$($[Z],J)}}break;case"function":console.log($)}}var xQ=new Uint8Array(new Uint16Array([1]).buffer)[0]==1;jZ=[Date,Set,Error,RegExp,v0,ArrayBuffer,Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,typeof BigUint64Array=="undefined"?function(){}:BigUint64Array,Int8Array,Int16Array,Int32Array,typeof BigInt64Array=="undefined"?function(){}:BigInt64Array,Float32Array,Float64Array,jJ];RJ=[{tag:1,encode($,J){let Z=$.getTime()/1000;if((this.useTimestamp32||$.getMilliseconds()===0)&&Z>=0&&Z<4294967296)R[K++]=26,n.setUint32(K,Z),K+=4;else R[K++]=251,n.setFloat64(K,Z),K+=8}},{tag:258,encode($,J){let Z=Array.from($);J(Z)}},{tag:27,encode($,J){J([$.name,$.message])}},{tag:27,encode($,J){J(["RegExp",$.source,$.flags])}},{getTag($){return $.tag},encode($,J){J($.value)}},{encode($,J,Z){CJ($,Z)}},{getTag($){if($.constructor===Uint8Array){if(this.tagUint8Array||l8&&this.tagUint8Array!==!1)return 64}},encode($,J,Z){CJ($,Z)}},k0(68,1),k0(69,2),k0(70,4),k0(71,8),k0(72,1),k0(77,2),k0(78,4),k0(79,8),k0(85,4),k0(86,8),{encode($,J){let Z=$.packedValues||[],q=$.structures||[];if(Z.values.length>0){R[K++]=216,R[K++]=51,_0(4);let X=Z.values;J(X),_0(0),_0(0),packedObjectMap=Object.create(sharedPackedObjectMap||null);for(let Q=0,G=X.length;Q<G;Q++)packedObjectMap[X[Q]]=Q}if(q){n.setUint32(K,3655335424),K+=3;let X=q.slice(0);X.unshift(57344),X.push(new v0($.version,1399353956)),J(X)}else J(new v0($.version,1399353956))}}];function k0($,J){if(!xQ&&J>1)$-=4;return{tag:$,encode:function Z(q,X){let Q=q.byteLength,G=q.byteOffset||0,Y=q.buffer||q;X(l8?P$.from(Y,G,Q):new Uint8Array(Y,G,Q))}}}function CJ($,J){let Z=$.byteLength;if(Z<24)R[K++]=64+Z;else if(Z<256)R[K++]=88,R[K++]=Z;else if(Z<65536)R[K++]=89,R[K++]=Z>>8,R[K++]=Z&255;else R[K++]=90,n.setUint32(K,Z),K+=4;if(K+Z>=R.length)J(K+Z);R.set($.buffer?$:new Uint8Array($),K),K+=Z}function vQ($,J){let Z,q=J.length*2,X=$.length-q;J.sort((Q,G)=>Q.offset>G.offset?1:-1);for(let Q=0;Q<J.length;Q++){let G=J[Q];G.id=Q;for(let Y of G.references)$[Y++]=Q>>8,$[Y]=Q&255}while(Z=J.pop()){let Q=Z.offset;$.copyWithin(Q+q,Q,X),q-=2;let G=Q+q;$[G++]=216,$[G++]=28,X=Q}return $}function CZ($,J){n.setUint32($0.position+$,K-$0.position-$+1);let Z=$0;$0=null,J(Z[0]),J(Z[1])}var TJ=new A$({useRecords:!1}),kQ=TJ.encode,_Q=TJ.encodeAsIterable,gQ=TJ.encodeAsAsyncIterable;var FJ=512,mQ=1024,BJ=2048;var E$=($)=>{let J=new Uint8Array($);return btoa(String.fromCharCode(...J)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")},TZ=($)=>{let J=atob($.replace(/-/g,"+").replace(/_/g,"/")),Z=new Uint8Array(J.length);for(let q=0;q<J.length;q++)Z[q]=J.charCodeAt(q);return Z.buffer};async function LZ($){let J=crypto.getRandomValues(new Uint8Array(32)),q=new TextEncoder().encode($),X=await crypto.subtle.digest("SHA-256",q),Q=new Uint8Array(X).slice(0,16),G=await navigator.credentials.create({publicKey:{challenge:J,rp:{name:"Sorane Web/A Form"},user:{id:Q,name:$,displayName:$},pubKeyCredParams:[{alg:-7,type:"public-key"}],authenticatorSelection:{authenticatorAttachment:"platform",userVerification:"required",residentKey:"required"},timeout:60000,attestation:"none",extensions:{prf:{}}}});if(!G)throw new Error("Credential creation failed");return{id:G.id,rawId:E$(G.rawId),response:G.response}}async function IZ($,J){let Z=await navigator.credentials.get({publicKey:{challenge:J,allowCredentials:[{id:TZ($),type:"public-key"}],userVerification:"required"}});if(!Z)throw new Error("Assertion failed");let q=Z.response;return{id:Z.id,signature:E$(q.signature),authenticatorData:E$(q.authenticatorData),clientDataJSON:E$(q.clientDataJSON)}}async function I8($,J){let Z=crypto.getRandomValues(new Uint8Array(32)),q=await navigator.credentials.get({publicKey:{challenge:Z,allowCredentials:[{id:TZ($),type:"public-key"}],userVerification:"required",extensions:{prf:{eval:{first:J}}}}});if(!q)throw new Error("Assertion failed");let Q=q.getClientExtensionResults()?.prf?.results?.first;if(!Q)throw new Error("PRF extension not available");return new Uint8Array(Q)}function c8($){return Array.from($).map((J)=>J.toString(16).padStart(2,"0")).join("")}function wZ($){let J=new Uint8Array($.length/2);for(let Z=0;Z<J.length;Z++)J[Z]=parseInt($.substring(Z*2,Z*2+2),16);return J}class AZ{usePasskey=!0;credentialId=null;publicKey=null;publicKeyType="ed25519";edPrivateKey=null;constructor(){this.loadKey()}loadKey(){if(typeof localStorage==="undefined")return;let $=localStorage.getItem("weba_passkey_id"),J=localStorage.getItem("weba_passkey_pub");if($&&J){this.credentialId=$,this.publicKey=wZ(J),this.publicKeyType="p256",this.usePasskey=!0;return}let Z=localStorage.getItem("weba_private_key");if(Z)this.edPrivateKey=wZ(Z),this.publicKey=e0.getPublicKey(this.edPrivateKey),this.publicKeyType="ed25519",this.usePasskey=!1}resetKey(){if(typeof localStorage!=="undefined")localStorage.removeItem("weba_passkey_id"),localStorage.removeItem("weba_passkey_pub"),localStorage.removeItem("weba_private_key");this.credentialId=null,this.publicKey=null,this.edPrivateKey=null}async register(){try{let $=prompt("Enter a name for this Passkey:","demo-user")||"User";console.log(`Registering Passkey for ${$}...`);let J=await LZ($),Z=new Uint8Array(J.response.attestationObject),X=L$(Z).authData,Q=new DataView(X.buffer,X.byteOffset,X.byteLength),G=53,Y=Q.getUint16(G);G+=2,G+=Y;let U=X.slice(G),z=L$(U),W=z.get(-2),M=z.get(-3);if(!W||!M)throw new Error("Invalid COSE Key: x or y missing");let V=new Uint8Array(65);if(V[0]=4,V.set(W,1),V.set(M,33),this.credentialId=J.rawId,this.publicKey=V,this.publicKeyType="p256",this.usePasskey=!0,typeof localStorage!=="undefined")localStorage.setItem("weba_passkey_id",this.credentialId),localStorage.setItem("weba_passkey_pub",c8(this.publicKey));return console.log("Passkey Registered:",this.credentialId),!0}catch($){return console.warn("Passkey registration failed, falling back to Ed25519",$),this.generateEdKey(),!1}}generateEdKey(){if(this.edPrivateKey=e0.utils.randomSecretKey(),this.publicKey=e0.getPublicKey(this.edPrivateKey),this.publicKeyType="ed25519",this.usePasskey=!1,typeof localStorage!=="undefined")localStorage.setItem("weba_private_key",c8(this.edPrivateKey))}getIssuerDid(){if(!this.publicKey)return"";return`did:key:z${c8(this.publicKey)}`}getPublicKey(){return this.publicKey?c8(this.publicKey):""}async sign($,J="authentication"){if(!this.publicKey)await this.register();let Z=PZ.default($),q=new TextEncoder().encode(Z);if(this.usePasskey&&this.credentialId){let X=await crypto.subtle.digest("SHA-256",q),Q=await IZ(this.credentialId,X);return{...$,proof:{type:"PasskeySignature2025",created:new Date().toISOString(),verificationMethod:this.getIssuerDid(),proofPurpose:J,proofValue:Q.signature,"srn:authenticatorData":Q.authenticatorData,"srn:clientDataJSON":Q.clientDataJSON,"srn:credentialId":Q.id}}}else{if(!this.edPrivateKey)this.generateEdKey();let X=e0.sign(q,this.edPrivateKey);return{...$,proof:{type:"Ed25519Signature2020",created:new Date().toISOString(),verificationMethod:this.getIssuerDid(),proofPurpose:J,proofValue:c8(X)}}}}async derivePrf($){if(!this.credentialId)return null;try{return await I8(this.credentialId,$)}catch(J){return console.error("PRF derivation failed",J),null}}}var S0=new AZ;class LJ{oHash;iHash;blockLen;outputLen;finished=!1;destroyed=!1;constructor($,J){if(v8($),l(J,void 0,"key"),this.iHash=$.create(),typeof this.iHash.update!=="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let Z=this.blockLen,q=new Uint8Array(Z);q.set(J.length>Z?$.create().update(J).digest():J);for(let X=0;X<q.length;X++)q[X]^=54;this.iHash.update(q),this.oHash=$.create();for(let X=0;X<q.length;X++)q[X]^=106;this.oHash.update(q),B0(q)}update($){return b0(this),this.iHash.update($),this}digestInto($){b0(this),l($,this.outputLen,"output"),this.finished=!0,this.iHash.digestInto($),this.oHash.update($),this.oHash.digestInto($),this.destroy()}digest(){let $=new Uint8Array(this.oHash.outputLen);return this.digestInto($),$}_cloneInto($){$||=Object.create(Object.getPrototypeOf(this),{});let{oHash:J,iHash:Z,finished:q,destroyed:X,blockLen:Q,outputLen:G}=this;return $=$,$.finished=q,$.destroyed=X,$.blockLen=Q,$.outputLen=G,$.oHash=J._cloneInto($.oHash),$.iHash=Z._cloneInto($.iHash),$}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}var f$=($,J,Z)=>new LJ($,J).update(Z).digest();f$.create=($,J)=>new LJ($,J);function yQ($,J,Z){if(v8($),Z===void 0)Z=new Uint8Array($.outputLen);return f$($,Z,J)}var IJ=Uint8Array.of(0),EZ=Uint8Array.of();function bQ($,J,Z,q=32){v8($),T0(q,"length");let X=$.outputLen;if(q>255*X)throw new Error("Length must be <= 255*HashLen");let Q=Math.ceil(q/X);if(Z===void 0)Z=EZ;else l(Z,void 0,"info");let G=new Uint8Array(Q*X),Y=f$.create($,J),U=Y._cloneInto(),z=new Uint8Array(Y.outputLen);for(let W=0;W<Q;W++)IJ[0]=W+1,U.update(W===0?EZ:z).update(Z).update(IJ).digestInto(z),G.set(z,X*W),Y._cloneInto(U);return Y.destroy(),U.destroy(),B0(z,IJ),G.slice(0,q)}var F0=($,J,Z,q,X)=>bQ($,yQ($,J,Z),q,X);var SZ=U9(XJ(),1),fZ="weba_l2_ed25519_sk";function N0($){if(typeof Buffer!=="undefined")return Buffer.from($).toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/g,"");let J="";return $.forEach((q)=>{J+=String.fromCharCode(q)}),btoa(J).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/g,"")}function G0($){let J=$.length%4===0?"":"=".repeat(4-$.length%4),Z=$.replace(/-/g,"+").replace(/_/g,"/")+J;if(typeof Buffer!=="undefined")return new Uint8Array(Buffer.from(Z,"base64"));let q=atob(Z),X=new Uint8Array(q.length);for(let Q=0;Q<q.length;Q+=1)X[Q]=q.charCodeAt(Q);return X}function S$($){let J=SZ.default($);if(J===void 0)throw new Error("Failed to canonicalize JSON");return J}function wJ($){let J=new Uint8Array($);return crypto.getRandomValues(J),J}function hQ(){let $=localStorage.getItem(fZ);if($)return G0($);let J=e0.utils.randomSecretKey();return localStorage.setItem(fZ,N0(J)),J}function uQ($,J,Z){let q={layer1_ref:$,recipient:J,weba_version:Z};return new TextEncoder().encode(S$(q))}function xZ($,J){let Z=new Uint8Array($.length+J.length);return Z.set($,0),Z.set(J,$.length),Z}function vZ($){let J=new TextEncoder().encode("weba-l2/user-x25519"),Z=F0(R0,$,void 0,J,32);return{publicKey:b8.getPublicKey(Z),privateKey:Z}}async function kZ($,J,Z,q){let X=await crypto.subtle.importKey("raw",J,"AES-GCM",!1,["encrypt"]),Q=await crypto.subtle.encrypt({name:"AES-GCM",iv:Z,additionalData:q},X,$);return new Uint8Array(Q)}async function _Z($){let J=F0(R0,$.prfKey,void 0,void 0,32),Z=F0(R0,J,void 0,new TextEncoder().encode("weba-l2/kw"),32),q=F0(R0,J,void 0,new TextEncoder().encode("weba-l2/kw-iv"),12),X=$.aad??new Uint8Array;return kZ($.recipientSk,Z,q,X)}async function gZ($,J,Z,q){let X=await crypto.subtle.importKey("raw",J,"AES-GCM",!1,["decrypt"]),Q=await crypto.subtle.decrypt({name:"AES-GCM",iv:Z,additionalData:q},X,$);return new Uint8Array(Q)}async function mZ($){let J=$.config.weba_version??"0.1",Z=$.config.recipient_kid,q=$.config.layer1_ref,X=$.user_kid??"user#sig-1",Q=hQ(),G=S$($.layer2_plain),Y=new TextEncoder().encode(G),U=e0.sign(Y,Q),z={alg:"Ed25519",kid:X,sig:N0(U),created_at:new Date().toISOString()},W={layer2_plain:$.layer2_plain,layer2_sig:z},M=Math.floor(Math.random()*256),V=wJ(M),O="";V.forEach((x)=>{O+=x.toString(16).padStart(2,"0")}),W._padding=O;let B=uQ(q,Z,J),E=new TextEncoder().encode(S$(W)),H=G0($.config.recipient_x25519),I=wJ(32),N=b8.getPublicKey(I),F=b8.getSharedSecret(I,H),f=F,k,g="X25519";if($.config.recipient_pqc){let x=$.pqcProvider;if(!x)throw new Error("PQC requested but no provider is available");let d=G0($.config.recipient_pqc),D=x.encapsulate(d);k=D.encapsulation,f=xZ(F,D.sharedSecret),g=`X25519+${x.kemId}`}let y=F0(R0,f,B,void 0,32),w=F0(R0,y,void 0,new TextEncoder().encode("weba-l2/key"),32),T=F0(R0,y,void 0,new TextEncoder().encode("weba-l2/iv"),12),S=await kZ(E,w,T,B);return{weba_version:J,layer1_ref:q,layer2:{enc:"HPKE-v1",suite:{kem:g,kdf:"HKDF-SHA256",aead:"AES-256-GCM"},recipient:Z,encapsulated:{classical:N0(N),...k?{pqc:N0(k)}:{}},ciphertext:N0(S),aad:N0(B)},meta:{created_at:new Date().toISOString(),nonce:N0(wJ(16)),...$.config.campaign_id?{campaign_id:$.config.campaign_id}:{},...$.config.key_policy?{key_policy:$.config.key_policy}:{}}}}function yZ(){let $=document.getElementById("weba-l2-config");if(!$||!$.textContent)return null;try{return JSON.parse($.textContent)}catch{return null}}async function x$($,J,Z){let q=G0($.layer2.aad),X={layer1_ref:$.layer1_ref,recipient:$.layer2.recipient,weba_version:$.weba_version},Q=new TextEncoder().encode(S$(X));if(N0(Q)!==$.layer2.aad)throw new Error("AAD mismatch");let G=G0($.layer2.encapsulated.classical),Y=b8.getSharedSecret(J,G),U=Y;if($.layer2.encapsulated.pqc){let B=Z?.pqcProvider,E=Z?.pqcRecipientSk;if(!B||!E)throw new Error("Missing PQC KEM for envelope");let H=G0($.layer2.encapsulated.pqc),I=B.decapsulate(E,H);U=xZ(Y,I)}let z=F0(R0,U,q,void 0,32),W=F0(R0,z,void 0,new TextEncoder().encode("weba-l2/key"),32),M=F0(R0,z,void 0,new TextEncoder().encode("weba-l2/iv"),12),V=G0($.layer2.ciphertext),O=await gZ(V,W,M,q);return JSON.parse(new TextDecoder().decode(O))}async function bZ($){let J=F0(R0,$.prfKey,void 0,void 0,32),Z=F0(R0,J,void 0,new TextEncoder().encode("weba-l2/kw"),32),q=F0(R0,J,void 0,new TextEncoder().encode("weba-l2/kw-iv"),12),X=$.keywrap.aad?G0($.keywrap.aad):new Uint8Array,Q=G0($.keywrap.wrapped_key);return gZ(Q,Z,q,X)}function pQ($){$.querySelectorAll("input").forEach((Z)=>{if(Z.type==="checkbox"||Z.type==="radio")Z.checked=!1,Z.removeAttribute("checked");else Z.value="",Z.removeAttribute("value")}),$.querySelectorAll("textarea").forEach((Z)=>{Z.value="",Z.textContent=""}),$.querySelectorAll("select").forEach((Z)=>{Z.selectedIndex=-1,Z.querySelectorAll("option").forEach((q)=>q.removeAttribute("selected"))}),$.getElementById("json-ld")?.remove(),$.getElementById("data-layer")?.remove();let J=$.getElementById("json-debug");if(J)J.textContent=""}function dQ($,J){let Z=JSON.stringify(J,null,2),q=$.createElement("script");q.type="application/ld+json",q.id="weba-user-vc",q.textContent=Z,$.body.appendChild(q);let X=$.createElement("div");X.className="weba-user-verification no-print",X.style.cssText="margin-top:2rem;padding:1rem;border:1px solid #10b981;border-radius:8px;background:#f0fdf4;font-size:0.85rem;",X.innerHTML=`
    <details>
      <summary style="cursor: pointer; display: flex; align-items: center; gap: 0.5rem; color: #047857; font-weight: 600;">
        <span></span> 
      </summary>
      <div style="padding: 1rem 0;">
        <pre style="background: #1e1e1e; color: #d4d4d4; padding: 1rem; border-radius: 6px; overflow-x: auto; font-size: 0.8rem; line-height: 1.4;"></pre>
      </div>
    </details>
  `;let Q=X.querySelector("pre");if(Q)Q.textContent=Z;$.body.appendChild(X)}function lQ($,J){let Z=$.createElement("script");Z.id="weba-l2-envelope",Z.type="application/json",Z.textContent=JSON.stringify(J,null,2),$.body.appendChild(Z)}function cQ($,J){let Z=new Date,q=Z.getFullYear()+("0"+(Z.getMonth()+1)).slice(-2)+("0"+Z.getDate()).slice(-2)+"-"+("0"+Z.getHours()).slice(-2)+("0"+Z.getMinutes()).slice(-2),X=Math.random().toString(36).substring(2,8);return`${$}_${q}_${J}_${X}.html`}function iQ($,J){let q=new DOMParser().parseFromString($,"text/html");if(J?.stripPlaintext)pQ(q);if(J?.embeddedVc)dQ(q,J.embeddedVc);if(J?.l2Envelope)lQ(q,J.l2Envelope);return q.documentElement.outerHTML}function hZ($){let J=iQ($.documentHtml,$.options),Z=new Blob([J],{type:"text/html"}),q=URL.createObjectURL(Z),X=document.createElement("a");if(X.href=q,X.download=cQ($.title,$.filenameSuffix),X.click(),$.isFinal)setTimeout(()=>window.location.reload(),1000)}class PJ{formId;constructor(){this.formId="WebA_"+window.location.pathname}updateJsonLd(){let J=window.generatedJsonStructure||{};document.querySelectorAll("[data-json-path]").forEach((X)=>{let Q=X.dataset.jsonPath;if(Q)J[Q]=X.value}),document.querySelectorAll('[type="radio"]:checked').forEach((X)=>{J[X.name]=X.value}),document.querySelectorAll("table.data-table.dynamic").forEach((X)=>{let Q=X.dataset.tableKey;if(Q){let G=[];X.querySelectorAll("tbody tr").forEach((Y)=>{let U={},z=!1;if(Y.querySelectorAll("[data-base-key]").forEach((W)=>{if(W.type==="checkbox"){if(U[W.dataset.baseKey]=W.checked,W.checked)z=!0}else if(U[W.dataset.baseKey]=W.value,W.value)z=!0}),z)G.push(U)}),J[Q]=G}});let Z=document.getElementById("json-ld");if(Z)Z.textContent=JSON.stringify(J,null,2);let q=document.getElementById("json-debug");if(q)q.textContent=JSON.stringify(J,null,2);return J}getL2Config(){return window.webaL2Config||null}async signAndDownload(){let $=this.updateJsonLd(),J=window,Z=J.generatedJsonStructure&&J.generatedJsonStructure.name||"Response",q=window.location.href.split("#")[0],X=this.getL2Config(),Q=document.getElementById("weba-l2-encrypt");if(!!(X?.enabled&&(Q?Q.checked:X.default_enabled))){if(!X?.recipient_kid||!X?.recipient_x25519||!X?.layer1_ref){alert("L2 encryption config is missing required fields.");return}try{let U=await mZ({layer2_plain:$,config:X,user_kid:X.user_kid});this.downloadHtml("submit",!0,{l2Envelope:U,stripPlaintext:!0})}catch(U){console.error(U),alert("L2 encryption failed. Please check your recipient key settings.")}return}if(!S0.getPublicKey()){if(!await S0.register()){alert("Key registration failed.");return}}let Y={"@context":["https://www.w3.org/2018/credentials/v1"],type:["VerifiableCredential","WebAFormResponse"],issuer:S0.getIssuerDid(),issuanceDate:new Date().toISOString(),credentialSubject:{id:`urn:uuid:${crypto.randomUUID()}`,type:"WebAFormResponse",templateId:q,answers:$}};try{let U=await S0.sign(Y);this.downloadHtml("submitted",!0,{embeddedVc:U})}catch(U){console.error(U),alert("Signing failed. Please ensure you are in a secure context (HTTPS/localhost).")}}saveToLS(){let $=this.updateJsonLd();localStorage.setItem(this.formId,JSON.stringify($))}restoreFromLS(){let $=localStorage.getItem(this.formId);if(!$)return;try{let J=JSON.parse($);document.querySelectorAll("[data-json-path]").forEach((Z)=>{let q=Z.dataset.jsonPath;if(J[q]!==void 0)Z.value=J[q]}),document.querySelectorAll("table.data-table.dynamic").forEach((Z)=>{let q=Z.dataset.tableKey,X=J[q];if(Array.isArray(X)){let Q=Z.querySelector("tbody");if(!Q)return;let G=Q.querySelectorAll(".template-row");X.forEach((Y,U)=>{let z;if(U===0)z=Q.querySelector(".template-row");else{let W=Q.querySelector(".template-row");if(W){z=W.cloneNode(!0),z.classList.remove("template-row");let M=z.querySelector(".remove-row-btn");if(M)M.style.visibility="visible";Q.appendChild(z)}}if(z)z.querySelectorAll("input, select").forEach((W)=>{let M=W.dataset.baseKey;if(M&&Y[M]!==void 0)if(W.type==="checkbox")W.checked=!!Y[M];else W.value=Y[M]})})}})}catch(J){console.error(J)}}clearData(){if(confirm("Clear all saved data? / "))localStorage.removeItem(this.formId),window.location.reload()}bakeValues(){this.updateJsonLd(),document.querySelectorAll("input, textarea, select").forEach(($)=>{if($.closest(".template-row"))return;if($.type==="checkbox"||$.type==="radio")if($.checked)$.setAttribute("checked","checked");else $.removeAttribute("checked");else if($.setAttribute("value",$.value),$.tagName==="TEXTAREA")$.textContent=$.value})}downloadHtml($,J,Z){let q=window,X=q.generatedJsonStructure&&q.generatedJsonStructure.name||"web-a-form";hZ({documentHtml:document.documentElement.outerHTML,title:X,filenameSuffix:$,isFinal:J,options:Z})}saveDraft(){this.bakeValues(),this.downloadHtml("draft",!1)}submitDocument(){this.bakeValues(),document.querySelectorAll(".search-suggestions").forEach(($)=>$.remove()),this.downloadHtml("submit",!0)}}class AJ{calc;data;constructor($,J){this.calc=$,this.data=J}applyI18n(){let $={en:{add_row:"+ Add Row",work_save_btn:"Save Progress",clear_btn:"Clear Data",sign_btn:"Submit"},ja:{add_row:"+ ",work_save_btn:"",clear_btn:"",sign_btn:""}},J=(navigator.language||"en").startsWith("ja")?"ja":"en",Z=$[J]||$.en;document.querySelectorAll("[data-i18n]").forEach((q)=>{let X=q.dataset.i18n;if(Z[X])q.textContent=Z[X]})}initTables(){document.querySelectorAll(".data-table.dynamic tbody").forEach(($)=>{this.renumberRows($)})}renumberRows($){Array.from($.querySelectorAll("tr")).filter((Z)=>{return Z.querySelectorAll("td").length>0}).forEach((Z,q)=>{let X=q+1;Z.querySelectorAll(".auto-num").forEach((Q)=>{if(Q.value!=X)Q.value=X.toString(),Q.dispatchEvent(new Event("input",{bubbles:!0}))})})}removeTableRow($){let J=$.closest("tr"),Z=J.parentElement;if(J.classList.contains("template-row"))J.querySelectorAll("input").forEach((q)=>{if(q.type==="checkbox")q.checked=!1;else q.value=""});else{if(J.remove(),Z)this.renumberRows(Z);this.calc.recalculate(),this.data.updateJsonLd()}}addTableRow($,J){let Z=document.getElementById("tbl_"+J);if(!Z)return;let q=Z.querySelector("tbody");if(!q)return;let X=q.querySelector(".template-row");if(!X)return;let Q=X.cloneNode(!0);Q.classList.remove("template-row"),Q.querySelectorAll("input").forEach((Y)=>{if(Y.type==="checkbox")Y.checked=Y.hasAttribute("checked");else Y.value=Y.getAttribute("value")||""});let G=Q.querySelector(".remove-row-btn");if(G)G.style.visibility="visible";Q.querySelectorAll("[data-copy-from]").forEach((Y)=>{let U=Y.dataset.copyFrom;if(U){let z=Q.querySelector(`[data-base-key="${U}"]`);if(z&&z.value)Y.value=z.value}}),q.appendChild(Q),this.renumberRows(q),this.calc.recalculate()}switchTab($,J){document.querySelectorAll(".tab-btn").forEach((q)=>q.classList.remove("active")),document.querySelectorAll(".tab-content").forEach((q)=>q.classList.remove("active")),$.classList.add("active");let Z=document.getElementById(J);if(Z)Z.classList.add("active")}}function uZ($){let J=document.getElementById($);if(!J||!J.textContent)return null;try{return JSON.parse(J.textContent)}catch{return null}}function pZ(){let $=uZ("weba-l2-envelope");if(!$)return;let J=uZ("weba-l2-keywrap"),Z=document.querySelector(".weba-form-container")||document.body,q=document.createElement("div");q.className="weba-l2-unlock",q.style.cssText="margin-top:2rem;padding:1rem;border:1px solid #cbd5f5;border-radius:10px;background:#f8fafc;";let X=document.createElement("div");X.textContent="Encrypted Submission",X.style.cssText="font-weight:600;color:#334155;margin-bottom:0.5rem;",q.appendChild(X);let Q=document.createElement("div");Q.textContent="Locked. Unlock with Passkey.",Q.style.cssText="color:#64748b;margin-bottom:0.75rem;",q.appendChild(Q);let G=document.createElement("button");G.textContent="Unlock (Passkey)",G.style.cssText="padding:0.5rem 1rem;border:1px solid #94a3b8;border-radius:6px;background:#fff;cursor:pointer;",q.appendChild(G);let Y=document.createElement("pre");Y.style.cssText="margin-top:1rem;padding:1rem;background:#0f172a;color:#e2e8f0;border-radius:8px;overflow:auto;font-size:0.85rem;display:none;",q.appendChild(Y);let U=document.createElement("details");U.style.cssText="margin-top:0.75rem; display:none;",U.innerHTML='<summary style="cursor:pointer;color:#64748b;">Show signature</summary><pre style="margin-top:0.5rem;padding:0.75rem;background:#0b1220;color:#cbd5f5;border-radius:6px;overflow:auto;font-size:0.8rem;"></pre>',q.appendChild(U);let z=document.createElement("button");z.textContent="Export JSON",z.style.cssText="margin-top:0.75rem;padding:0.45rem 0.9rem;border:1px solid #94a3b8;border-radius:6px;background:#fff;cursor:pointer;display:none;",z.disabled=!0,q.appendChild(z),G.addEventListener("click",async()=>{if(!J){Q.textContent="Key wrap package not found.";return}G.disabled=!0,Q.textContent="Waiting for passkey...";try{let W=G0(J.prf_salt),M=await I8(J.credential_id,W),V=await bZ({keywrap:J,prfKey:M}),O=await x$($,V);nQ(O.layer2_plain),document.body.classList.add("weba-l2-readonly"),Y.textContent=JSON.stringify(O.layer2_plain,null,2),Y.style.display="block";let B=U.querySelector("pre");if(B)B.textContent=JSON.stringify(O.layer2_sig,null,2);U.style.display="block",z.style.display="inline-block",z.disabled=!1,Q.textContent="Unlocked.",z.onclick=()=>{let E=new Blob([JSON.stringify(O,null,2)],{type:"application/json"}),H=URL.createObjectURL(E),I=document.createElement("a");I.href=H,I.download="weba-l2-decrypted.json",I.click()}}catch(W){console.error(W),Q.textContent="Unlock failed.",G.disabled=!1}}),Z.appendChild(q)}function nQ($){if(!$||typeof $!=="object")return;let J=$;document.querySelectorAll("[data-json-path]").forEach((Z)=>{let q=Z.dataset.jsonPath;if(!q||!(q in J))return;let X=J[q];if(Z.type==="checkbox")Z.checked=Boolean(X);else if(Z.type==="radio")Z.checked=Z.value===String(X);else Z.value=X===null||X===void 0?"":String(X)}),document.querySelectorAll('input[type="radio"]').forEach((Z)=>{let q=Z.name;if(!q||!(q in J))return;let X=J[q];Z.checked=Z.value===String(X)}),document.querySelectorAll("table.data-table.dynamic").forEach((Z)=>{let q=Z.dataset.tableKey;if(!q)return;let X=J[q];if(!Array.isArray(X))return;let Q=Z.querySelector("tbody");if(!Q)return;let G=Q.querySelector("tr.template-row");if(!G)return;Array.from(Q.querySelectorAll("tr")).forEach((Y)=>{if(!Y.classList.contains("template-row"))Y.remove()}),X.forEach((Y,U)=>{let z=U===0?G:G.cloneNode(!0);if(U>0){z.classList.remove("template-row");let W=z.querySelector(".remove-row-btn");if(W)W.style.visibility="visible";Q.appendChild(z)}if(Y&&typeof Y==="object")z.querySelectorAll("input, select, textarea").forEach((W)=>{let M=W.dataset.baseKey;if(!M)return;let V=Y[M];if(W.type==="checkbox")W.checked=Boolean(V);else W.value=V===null||V===void 0?"":String(V)})})}),document.querySelectorAll("input").forEach((Z)=>{if(Z.type==="checkbox"||Z.type==="radio")Z.disabled=!0;else Z.readOnly=!0}),document.querySelectorAll("textarea").forEach((Z)=>{Z.readOnly=!0}),document.querySelectorAll("select").forEach((Z)=>{Z.disabled=!0}),document.querySelectorAll(".form-toolbar button, .add-row-btn, .remove-row-btn").forEach((Z)=>{Z.disabled=!0})}function g0($){return document.getElementById($)}function dZ(){if(!g0("weba-l2-keywrap-tool"))return;let J=g0("kwp-recipient-sk"),Z=g0("kwp-credential-id"),q=g0("kwp-prf-salt"),X=g0("kwp-aad"),Q=g0("kwp-kid"),G=g0("kwp-status"),Y=g0("kwp-output"),U=g0("kwp-generate-salt"),z=g0("kwp-wrap");if(!J||!Z||!q||!G||!Y||!z)return;U?.addEventListener("click",()=>{let W=new Uint8Array(32);crypto.getRandomValues(W),q.value=N0(W)}),z.addEventListener("click",async()=>{G.textContent="Waiting for passkey...",z.disabled=!0;try{if(!J.value||!Z.value||!q.value)throw new Error("Missing required fields.");let W=G0(J.value.trim()),M=G0(q.value.trim()),V=await I8(Z.value.trim(),M),O=X?.value?G0(X.value.trim()):void 0,B=await _Z({recipientSk:W,prfKey:V,aad:O}),E={alg:"WebAuthn-PRF-AESGCM-v1",kid:Q?.value||"issuer#passkey-1",credential_id:Z.value.trim(),prf_salt:N0(M),wrapped_key:N0(B),...O?{aad:N0(O)}:{}};Y.textContent=JSON.stringify(E,null,2),G.textContent="Key wrap ready."}catch(W){console.error(W),G.textContent="Key wrap failed."}finally{z.disabled=!1}})}function lZ($){if(typeof DOMParser!=="undefined")return new DOMParser().parseFromString($,"text/html");if(typeof document!=="undefined"){let J=document.implementation.createHTMLDocument("");return J.documentElement.innerHTML=$,J}return null}function cZ($,J){let Z=lZ($);if(Z)return Z.getElementById(J)?.textContent??null;let q=new RegExp(`<script[^>]*id=["']${J}["'][^>]*>([\\s\\S]*?)<\\/script>`,"i"),X=$.match(q);return X?X[1]:null}function oQ($){return $.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function rQ($,J){let Z=lZ($);if(Z)return Z.querySelector(`script[type="${J}"]`)?.textContent??null;let q=new RegExp(`<script[^>]*type=["']${oQ(J)}["'][^>]*>([\\s\\S]*?)<\\/script>`,"i"),X=$.match(q);return X?X[1]:null}function iZ($){let J=cZ($,"data-layer");if(J)try{return JSON.parse(J)}catch{return null}let Z=rQ($,"application/ld+json");if(Z)try{return JSON.parse(Z)}catch{return null}return null}function nZ($){let J=cZ($,"weba-l2-envelope");if(!J)return null;try{return JSON.parse(J)}catch{return null}}function sQ($){let J={},Z=(q,X)=>{if(q===null||q===void 0){J[X]=null;return}if(Array.isArray(q)){q.forEach((Q,G)=>{Z(Q,X?`${X}[${G}]`:`[${G}]`)});return}if(typeof q==="object"){Object.entries(q).forEach(([Q,G])=>{let Y=X?`${X}.${Q}`:Q;Z(G,Y)});return}J[X]=q};if(Z($,""),""in J)delete J[""];return J}function rZ($){let J={_filename:$.filename},Z=new Set(["_filename"]);if($.includeJson)Z.add("_json"),J._json=JSON.stringify($.plain);let q=sQ($.plain||{});for(let X of Object.keys(q)){if($.omitKey&&$.omitKey(X))continue;Z.add(X),J[X]=q[X]}if($.sig)Z.add("_l2_sig"),J._l2_sig=JSON.stringify($.sig);return{row:J,keys:Z}}function oZ($){if($===null||$===void 0)return"";let J=String($);if(/[",\n]/.test(J))return`"${J.replace(/"/g,'""')}"`;return J}function sZ($,J){let Z=[];return Z.push(J.map(oZ).join(",")),$.forEach((q)=>{let X=J.map((Q)=>oZ(q[Q])).join(",");Z.push(X)}),"\uFEFF"+Z.join(`
`)}var o={_context:{masterData:{}},setMasterData($){this._context.masterData=$},escapeHtml($){if(!$)return"";return $.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},formatHint($){return this.escapeHtml($).replace(/&lt;br\s*\/?&gt;/gi,"<br>").replace(/\r?\n/g,"<br>")},getStyle($){if(!$)return"";let J="";if($.includes("size:L"))J+="font-size: 1.25em;";if($.includes("size:S"))J+="font-size: 0.8em;";if($.includes("size:XL"))J+="font-size: 1.5em; font-weight: bold;";if($.includes("align:R"))J+="text-align: right;";if($.includes("align:C"))J+="text-align: center;";if($.includes("bold"))J+="font-weight: bold;";return J},getExtraAttrs($){if(!$)return"";let J="",Z=$.match(/(?:len|max):(\d+)/);if(Z)J+=` maxlength="${Z[1]}"`;let q=$.match(/(?:val|value)="([^"]+)"/);if(q)J+=` value="${this.escapeHtml(q[1])}"`;else{let X=$.match(/(?:val|value)=([^\s\)]+)/);if(X)J+=` value="${this.escapeHtml(X[1])}"`}return J},text:function($,J,Z){let q=(Z||"").match(/(?:val|value)="([^"]+)"/)||(Z||"").match(/(?:val|value)='([^']+)'/)||(Z||"").match(/(?:val|value)=([^ ]+)/),X=(Z||"").match(/placeholder="([^"]+)"/)||(Z||"").match(/placeholder='([^']+)'/),Q=(Z||"").match(/hint="([^"]+)"/)||(Z||"").match(/hint='([^']+)'/),G=q?q[1]:"",Y=X?X[1]:"",U=Q?`<div class="form-hint">${this.formatHint(Q[1])}</div>`:"";return`
        <div class="form-row" style="${this.getStyle(Z)}">
            <label class="form-label">${this.escapeHtml(J)}</label>
            <input type="text" class="form-input" data-json-path="${$}" value="${this.escapeHtml(G)}" placeholder="${this.escapeHtml(Y)}" style="${this.getStyle(Z)}"${this.getExtraAttrs(Z)}>
            ${U}
        </div>`},number:function($,J,Z){let q=(Z||"").match(/placeholder="([^"]+)"/)||(Z||"").match(/placeholder='([^']+)'/),X=(Z||"").match(/hint="([^"]+)"/)||(Z||"").match(/hint='([^']+)'/),Q=q?q[1]:"",G=X?`<div class="form-row"><div class="form-hint">${this.formatHint(X[1])}</div></div>`:"";return`
        <div class="form-row">
            <label class="form-label">${this.escapeHtml(J)}</label>
            <input type="number" class="form-input" data-json-path="${$}" placeholder="${this.escapeHtml(Q)}" style="${this.getStyle(Z)}"${this.getExtraAttrs(Z)}>
            ${G}
        </div>`},date:function($,J,Z){return`
        <div class="form-row">
            <label class="form-label">${this.escapeHtml(J)}</label>
            <input type="date" class="form-input" data-json-path="${$}" style="${this.getStyle(Z)}"${this.getExtraAttrs(Z)}>
        </div>`},textarea:function($,J,Z){let q=(Z||"").match(/placeholder="([^"]+)"/)||(Z||"").match(/placeholder='([^']+)'/),X=(Z||"").match(/hint="([^"]+)"/)||(Z||"").match(/hint='([^']+)'/),Q=q?q[1]:"",G=X?`<div class="form-hint">${this.formatHint(X[1])}</div>`:"",Y=(Z||"").match(/(?:val|value)="([^"]+)"/)||(Z||"").match(/(?:val|value)='([^']+)'/)||(Z||"").match(/(?:val|value)=([^ ]+)/),U=Y?Y[1]:"";return`
        <div class="form-row vertical" style="${this.getStyle(Z)}">
            <label class="form-label">${this.escapeHtml(J)}</label>
            <textarea class="form-input" rows="5" data-json-path="${$}" placeholder="${this.escapeHtml(Q)}" style="${this.getStyle(Z)}"${this.getExtraAttrs(Z)}>${this.escapeHtml(U)}</textarea>
            ${G}
        </div>`},radioStart:function($,J,Z){return`
        <div class="form-row vertical" style="${this.getStyle(Z)}">
            <label class="form-label">${this.escapeHtml(J)}</label>
            <div class="radio-group" style="padding-left: 10px;">`},radioOption:function($,J,Z,q){return`
            <label style="display:block; margin-bottom:5px;">
                <input type="radio" name="${$}" value="${this.escapeHtml(J)}" ${q?"checked":""}> ${this.escapeHtml(Z)}
            </label>`},calc:function($,J,Z){let q=(Z||"").match(/formula="([^"]+)"/)||(Z||"").match(/formula='([^']+)'/),X=q?q[1]:"";return`
        <div class="form-row">
            <label class="form-label">${this.escapeHtml(J)}</label>
            <input type="text" readonly class="form-input" data-json-path="${$}" data-formula="${this.escapeHtml(X)}" style="background:#f9f9f9; ${this.getStyle(Z)}"${this.getExtraAttrs(Z)}>
        </div>`},search:function($,J,Z){let q=(Z||"").match(/src:([^\s)]+)/),X=(Z||"").match(/label:(\d+)/),Q=(Z||"").match(/value:(\d+)/),G=(Z||"").match(/placeholder="([^"]+)"/)||(Z||"").match(/placeholder='([^']+)'/),Y=(Z||"").match(/hint="([^"]+)"/)||(Z||"").match(/hint='([^']+)'/),U=q?q[1]:"",z=G?G[1]:"",W=Y?`<div class="form-hint">${this.formatHint(Y[1])}</div>`:"",M=X?` data-master-label-index="${X[1]}"`:"",V=Q?` data-master-value-index="${Q[1]}"`:"";return`
        <div class="form-row autocomplete-container" style="position:relative; z-index:100;">
            <label class="form-label">${this.escapeHtml(J)}</label>
            <div style="flex:1; position:relative;">
                <input type="text" class="form-input search-input" autocomplete="off" 
                    data-json-path="${$}" 
                    data-master-src="${U}"${M}${V}
                    placeholder="${this.escapeHtml(z)}" 
                    style="${this.getStyle(Z)}"${this.getExtraAttrs(Z)}>
                <div class="search-suggestions" style="display:none; position:absolute; top:100%; left:0; width:100%; background:white; border:1px solid #ccc; max-height:200px; overflow-y:auto; box-shadow:0 4px 6px rgba(0,0,0,0.1); border-radius:0 0 4px 4px; z-index:1001;"></div>
            </div>
            ${W}
        </div>`},renderInput($,J,Z,q=!1){let X=(Z||"").match(/placeholder="([^"]+)"/)||(Z||"").match(/placeholder='([^']+)'/),Q=X?`placeholder="${this.escapeHtml(X[1])}"`:"",G=q?"form-input template-input":"form-input",Y=q?`data-base-key="${J}"`:`data-json-path="${J}"`;if($==="calc"){let O=(Z||"").match(/formula="([^"]+)"/)||(Z||"").match(/formula='([^']+)'/),B=O?O[1]:"";return`<input type="text" readonly class="${G}" ${Y} data-formula="${this.escapeHtml(B)}" style="background:#f9f9f9; text-align:right; ${this.getStyle(Z)}"${this.getExtraAttrs(Z)}>`}if($==="datalist"){let O=(Z||"").match(/src:([a-zA-Z0-9_\-\u0080-\uFFFF]+)/),B=(Z||"").match(/label:(\d+)/),E="",H=O?O[1]:"";if(H&&this._context.masterData&&this._context.masterData[H]){let N=this._context.masterData[H],F=B?parseInt(B[1]||"1")-1:1;N.forEach((f)=>{if(f.length>F)E+=`<option value="${this.escapeHtml(f[F]||"")}"></option>`})}let I="list_"+J+"_"+Math.floor(Math.random()*1e4);return`<input type="text" list="${I}" class="${G}" ${Y} ${Q} style="${this.getStyle(Z)}"${this.getExtraAttrs(Z)}><datalist id="${I}">${E}</datalist>`}if($==="search"){let O=(Z||"").match(/src:([a-zA-Z0-9_\-\u0080-\uFFFF]+)/),B=(Z||"").match(/label:(\d+)/),E=(Z||"").match(/value:(\d+)/),H=O?O[1]:"",I=B?` data-master-label-index="${B[1]}"`:"",N=E?` data-master-value-index="${E[1]}"`:"",F=G+" search-input",f="";if((Z||"").includes("suggest:column"))f=' data-suggest-source="column"';let k=(Z||"").match(/copy:([^\s)]+)/),g=k?` data-copy-from="${k[1]}"`:"";return`<div style="display:inline-block; position:relative; width: 100%; min-width: 100px;">
                        <input type="text" class="${F}" ${Y} autocomplete="off" data-master-src="${H}"${I}${N} ${Q} style="${k?"background-color: #ffffea;":""} ${this.getStyle(Z)}"${this.getExtraAttrs(Z)}${f}${g}>
                    </div>`}if($==="number"){let O=(Z||"").match(/copy:([^\s)]+)/),B=O?` data-copy-from="${O[1]}"`:"";return`<input type="number" class="${G}" ${Y} ${Q} style="text-align:right; ${O?"background-color: #ffffea;":""} ${this.getStyle(Z)}"${this.getExtraAttrs(Z)}${B}>`}if($==="date")return`<input type="date" class="${G}" ${Y} style="${this.getStyle(Z)}"${this.getExtraAttrs(Z)}>`;if($==="checkbox")return`<input type="checkbox" class="${G}" ${Y} style="${this.getStyle(Z)}"${this.getExtraAttrs(Z)}>`;if($==="autonum"||(Z||"").includes("autonum"))return`<input type="number" readonly class="${G+" auto-num"}" ${Y} data-autonum="true" style="background:transparent; border:none; text-align:center; width:100%; font-weight:bold; cursor:default; ${this.getStyle(Z)}"${this.getExtraAttrs(Z)}>`;let U="",z="";if((Z||"").includes("suggest:column"))z=" search-input",U=' data-suggest-source="column"';let W=(Z||"").match(/copy:([^\s)]+)/),M=W?` data-copy-from="${W[1]}"`:"";return`<input type="text" class="${G}${z}" ${Y} ${Q} style="${W?"background-color: #ffffea;":""} ${this.getStyle(Z)}"${this.getExtraAttrs(Z)}${U}${M}>`},tableRow($,J=!1){let Z=$.map((q)=>{let X=q.trim(),Q=X.match(/^\[(?:([a-z]+):)?([^\]:\(\)]+)(?:\s*\((.*)\)|:([^\]]+))?\]$/);if(Q){let[G,Y,U,z,W]=Q,M=(U||"").trim(),V=z||W||"";if(M.includes(" ")){let B=M.split(/\s+/);M=B[0],V=B.slice(1).join(" ")+" "+V}return`<td>${this.renderInput(Y||"text",M,V,J)}</td>`}else return`<td>${this.escapeHtml(X)}</td>`}).join("");return`<tr ${J?'class="template-row"':""}>${Z}</tr>`}};/*! js-yaml 4.1.1 https://github.com/nodeca/js-yaml @license MIT */function Dq($){return typeof $==="undefined"||$===null}function aQ($){return typeof $==="object"&&$!==null}function tQ($){if(Array.isArray($))return $;else if(Dq($))return[];return[$]}function eQ($,J){var Z,q,X,Q;if(J){Q=Object.keys(J);for(Z=0,q=Q.length;Z<q;Z+=1)X=Q[Z],$[X]=J[X]}return $}function $1($,J){var Z="",q;for(q=0;q<J;q+=1)Z+=$;return Z}function J1($){return $===0&&Number.NEGATIVE_INFINITY===1/$}var Z1=Dq,q1=aQ,X1=tQ,Q1=$1,G1=J1,Y1=eQ,J0={isNothing:Z1,isObject:q1,toArray:X1,repeat:Q1,isNegativeZero:G1,extend:Y1};function Vq($,J){var Z="",q=$.reason||"(unknown reason)";if(!$.mark)return q;if($.mark.name)Z+='in "'+$.mark.name+'" ';if(Z+="("+($.mark.line+1)+":"+($.mark.column+1)+")",!J&&$.mark.snippet)Z+=`

`+$.mark.snippet;return q+" "+Z}function n8($,J){if(Error.call(this),this.name="YAMLException",this.reason=$,this.mark=J,this.message=Vq(this,!1),Error.captureStackTrace)Error.captureStackTrace(this,this.constructor);else this.stack=new Error().stack||""}n8.prototype=Object.create(Error.prototype);n8.prototype.constructor=n8;n8.prototype.toString=function $(J){return this.name+": "+Vq(this,J)};var H0=n8;function EJ($,J,Z,q,X){var Q="",G="",Y=Math.floor(X/2)-1;if(q-J>Y)Q=" ... ",J=q-Y+Q.length;if(Z-q>Y)G=" ...",Z=q+Y-G.length;return{str:Q+$.slice(J,Z).replace(/\t/g,"")+G,pos:q-J+Q.length}}function fJ($,J){return J0.repeat(" ",J-$.length)+$}function U1($,J){if(J=Object.create(J||null),!$.buffer)return null;if(!J.maxLength)J.maxLength=79;if(typeof J.indent!=="number")J.indent=1;if(typeof J.linesBefore!=="number")J.linesBefore=3;if(typeof J.linesAfter!=="number")J.linesAfter=2;var Z=/\r?\n|\r|\0/g,q=[0],X=[],Q,G=-1;while(Q=Z.exec($.buffer))if(X.push(Q.index),q.push(Q.index+Q[0].length),$.position<=Q.index&&G<0)G=q.length-2;if(G<0)G=q.length-1;var Y="",U,z,W=Math.min($.line+J.linesAfter,X.length).toString().length,M=J.maxLength-(J.indent+W+3);for(U=1;U<=J.linesBefore;U++){if(G-U<0)break;z=EJ($.buffer,q[G-U],X[G-U],$.position-(q[G]-q[G-U]),M),Y=J0.repeat(" ",J.indent)+fJ(($.line-U+1).toString(),W)+" | "+z.str+`
`+Y}z=EJ($.buffer,q[G],X[G],$.position,M),Y+=J0.repeat(" ",J.indent)+fJ(($.line+1).toString(),W)+" | "+z.str+`
`,Y+=J0.repeat("-",J.indent+W+3+z.pos)+`^
`;for(U=1;U<=J.linesAfter;U++){if(G+U>=X.length)break;z=EJ($.buffer,q[G+U],X[G+U],$.position-(q[G]-q[G+U]),M),Y+=J0.repeat(" ",J.indent)+fJ(($.line+U+1).toString(),W)+" | "+z.str+`
`}return Y.replace(/\n$/,"")}var W1=U1,z1=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],M1=["scalar","sequence","mapping"];function D1($){var J={};if($!==null)Object.keys($).forEach(function(Z){$[Z].forEach(function(q){J[String(q)]=Z})});return J}function V1($,J){if(J=J||{},Object.keys(J).forEach(function(Z){if(z1.indexOf(Z)===-1)throw new H0('Unknown option "'+Z+'" is met in definition of "'+$+'" YAML type.')}),this.options=J,this.tag=$,this.kind=J.kind||null,this.resolve=J.resolve||function(){return!0},this.construct=J.construct||function(Z){return Z},this.instanceOf=J.instanceOf||null,this.predicate=J.predicate||null,this.represent=J.represent||null,this.representName=J.representName||null,this.defaultStyle=J.defaultStyle||null,this.multi=J.multi||!1,this.styleAliases=D1(J.styleAliases||null),M1.indexOf(this.kind)===-1)throw new H0('Unknown kind "'+this.kind+'" is specified for "'+$+'" YAML type.')}var Y0=V1;function aZ($,J){var Z=[];return $[J].forEach(function(q){var X=Z.length;Z.forEach(function(Q,G){if(Q.tag===q.tag&&Q.kind===q.kind&&Q.multi===q.multi)X=G}),Z[X]=q}),Z}function K1(){var $={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},J,Z;function q(X){if(X.multi)$.multi[X.kind].push(X),$.multi.fallback.push(X);else $[X.kind][X.tag]=$.fallback[X.tag]=X}for(J=0,Z=arguments.length;J<Z;J+=1)arguments[J].forEach(q);return $}function xJ($){return this.extend($)}xJ.prototype.extend=function $(J){var Z=[],q=[];if(J instanceof Y0)q.push(J);else if(Array.isArray(J))q=q.concat(J);else if(J&&(Array.isArray(J.implicit)||Array.isArray(J.explicit))){if(J.implicit)Z=Z.concat(J.implicit);if(J.explicit)q=q.concat(J.explicit)}else throw new H0("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");Z.forEach(function(Q){if(!(Q instanceof Y0))throw new H0("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(Q.loadKind&&Q.loadKind!=="scalar")throw new H0("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(Q.multi)throw new H0("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),q.forEach(function(Q){if(!(Q instanceof Y0))throw new H0("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var X=Object.create(xJ.prototype);return X.implicit=(this.implicit||[]).concat(Z),X.explicit=(this.explicit||[]).concat(q),X.compiledImplicit=aZ(X,"implicit"),X.compiledExplicit=aZ(X,"explicit"),X.compiledTypeMap=K1(X.compiledImplicit,X.compiledExplicit),X};var Kq=xJ,Oq=new Y0("tag:yaml.org,2002:str",{kind:"scalar",construct:function($){return $!==null?$:""}}),Nq=new Y0("tag:yaml.org,2002:seq",{kind:"sequence",construct:function($){return $!==null?$:[]}}),Hq=new Y0("tag:yaml.org,2002:map",{kind:"mapping",construct:function($){return $!==null?$:{}}}),Bq=new Kq({explicit:[Oq,Nq,Hq]});function O1($){if($===null)return!0;var J=$.length;return J===1&&$==="~"||J===4&&($==="null"||$==="Null"||$==="NULL")}function N1(){return null}function H1($){return $===null}var Rq=new Y0("tag:yaml.org,2002:null",{kind:"scalar",resolve:O1,construct:N1,predicate:H1,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});function B1($){if($===null)return!1;var J=$.length;return J===4&&($==="true"||$==="True"||$==="TRUE")||J===5&&($==="false"||$==="False"||$==="FALSE")}function R1($){return $==="true"||$==="True"||$==="TRUE"}function C1($){return Object.prototype.toString.call($)==="[object Boolean]"}var Cq=new Y0("tag:yaml.org,2002:bool",{kind:"scalar",resolve:B1,construct:R1,predicate:C1,represent:{lowercase:function($){return $?"true":"false"},uppercase:function($){return $?"TRUE":"FALSE"},camelcase:function($){return $?"True":"False"}},defaultStyle:"lowercase"});function F1($){return 48<=$&&$<=57||65<=$&&$<=70||97<=$&&$<=102}function j1($){return 48<=$&&$<=55}function T1($){return 48<=$&&$<=57}function L1($){if($===null)return!1;var J=$.length,Z=0,q=!1,X;if(!J)return!1;if(X=$[Z],X==="-"||X==="+")X=$[++Z];if(X==="0"){if(Z+1===J)return!0;if(X=$[++Z],X==="b"){Z++;for(;Z<J;Z++){if(X=$[Z],X==="_")continue;if(X!=="0"&&X!=="1")return!1;q=!0}return q&&X!=="_"}if(X==="x"){Z++;for(;Z<J;Z++){if(X=$[Z],X==="_")continue;if(!F1($.charCodeAt(Z)))return!1;q=!0}return q&&X!=="_"}if(X==="o"){Z++;for(;Z<J;Z++){if(X=$[Z],X==="_")continue;if(!j1($.charCodeAt(Z)))return!1;q=!0}return q&&X!=="_"}}if(X==="_")return!1;for(;Z<J;Z++){if(X=$[Z],X==="_")continue;if(!T1($.charCodeAt(Z)))return!1;q=!0}if(!q||X==="_")return!1;return!0}function I1($){var J=$,Z=1,q;if(J.indexOf("_")!==-1)J=J.replace(/_/g,"");if(q=J[0],q==="-"||q==="+"){if(q==="-")Z=-1;J=J.slice(1),q=J[0]}if(J==="0")return 0;if(q==="0"){if(J[1]==="b")return Z*parseInt(J.slice(2),2);if(J[1]==="x")return Z*parseInt(J.slice(2),16);if(J[1]==="o")return Z*parseInt(J.slice(2),8)}return Z*parseInt(J,10)}function w1($){return Object.prototype.toString.call($)==="[object Number]"&&($%1===0&&!J0.isNegativeZero($))}var Fq=new Y0("tag:yaml.org,2002:int",{kind:"scalar",resolve:L1,construct:I1,predicate:w1,represent:{binary:function($){return $>=0?"0b"+$.toString(2):"-0b"+$.toString(2).slice(1)},octal:function($){return $>=0?"0o"+$.toString(8):"-0o"+$.toString(8).slice(1)},decimal:function($){return $.toString(10)},hexadecimal:function($){return $>=0?"0x"+$.toString(16).toUpperCase():"-0x"+$.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),P1=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function A1($){if($===null)return!1;if(!P1.test($)||$[$.length-1]==="_")return!1;return!0}function E1($){var J,Z;if(J=$.replace(/_/g,"").toLowerCase(),Z=J[0]==="-"?-1:1,"+-".indexOf(J[0])>=0)J=J.slice(1);if(J===".inf")return Z===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY;else if(J===".nan")return NaN;return Z*parseFloat(J,10)}var f1=/^[-+]?[0-9]+e/;function S1($,J){var Z;if(isNaN($))switch(J){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===$)switch(J){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===$)switch(J){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(J0.isNegativeZero($))return"-0.0";return Z=$.toString(10),f1.test(Z)?Z.replace("e",".e"):Z}function x1($){return Object.prototype.toString.call($)==="[object Number]"&&($%1!==0||J0.isNegativeZero($))}var jq=new Y0("tag:yaml.org,2002:float",{kind:"scalar",resolve:A1,construct:E1,predicate:x1,represent:S1,defaultStyle:"lowercase"}),Tq=Bq.extend({implicit:[Rq,Cq,Fq,jq]}),Lq=Tq,Iq=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),wq=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function v1($){if($===null)return!1;if(Iq.exec($)!==null)return!0;if(wq.exec($)!==null)return!0;return!1}function k1($){var J,Z,q,X,Q,G,Y,U=0,z=null,W,M,V;if(J=Iq.exec($),J===null)J=wq.exec($);if(J===null)throw new Error("Date resolve error");if(Z=+J[1],q=+J[2]-1,X=+J[3],!J[4])return new Date(Date.UTC(Z,q,X));if(Q=+J[4],G=+J[5],Y=+J[6],J[7]){U=J[7].slice(0,3);while(U.length<3)U+="0";U=+U}if(J[9]){if(W=+J[10],M=+(J[11]||0),z=(W*60+M)*60000,J[9]==="-")z=-z}if(V=new Date(Date.UTC(Z,q,X,Q,G,Y,U)),z)V.setTime(V.getTime()-z);return V}function _1($){return $.toISOString()}var Pq=new Y0("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:v1,construct:k1,instanceOf:Date,represent:_1});function g1($){return $==="<<"||$===null}var Aq=new Y0("tag:yaml.org,2002:merge",{kind:"scalar",resolve:g1}),mJ=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function m1($){if($===null)return!1;var J,Z,q=0,X=$.length,Q=mJ;for(Z=0;Z<X;Z++){if(J=Q.indexOf($.charAt(Z)),J>64)continue;if(J<0)return!1;q+=6}return q%8===0}function y1($){var J,Z,q=$.replace(/[\r\n=]/g,""),X=q.length,Q=mJ,G=0,Y=[];for(J=0;J<X;J++){if(J%4===0&&J)Y.push(G>>16&255),Y.push(G>>8&255),Y.push(G&255);G=G<<6|Q.indexOf(q.charAt(J))}if(Z=X%4*6,Z===0)Y.push(G>>16&255),Y.push(G>>8&255),Y.push(G&255);else if(Z===18)Y.push(G>>10&255),Y.push(G>>2&255);else if(Z===12)Y.push(G>>4&255);return new Uint8Array(Y)}function b1($){var J="",Z=0,q,X,Q=$.length,G=mJ;for(q=0;q<Q;q++){if(q%3===0&&q)J+=G[Z>>18&63],J+=G[Z>>12&63],J+=G[Z>>6&63],J+=G[Z&63];Z=(Z<<8)+$[q]}if(X=Q%3,X===0)J+=G[Z>>18&63],J+=G[Z>>12&63],J+=G[Z>>6&63],J+=G[Z&63];else if(X===2)J+=G[Z>>10&63],J+=G[Z>>4&63],J+=G[Z<<2&63],J+=G[64];else if(X===1)J+=G[Z>>2&63],J+=G[Z<<4&63],J+=G[64],J+=G[64];return J}function h1($){return Object.prototype.toString.call($)==="[object Uint8Array]"}var Eq=new Y0("tag:yaml.org,2002:binary",{kind:"scalar",resolve:m1,construct:y1,predicate:h1,represent:b1}),u1=Object.prototype.hasOwnProperty,p1=Object.prototype.toString;function d1($){if($===null)return!0;var J=[],Z,q,X,Q,G,Y=$;for(Z=0,q=Y.length;Z<q;Z+=1){if(X=Y[Z],G=!1,p1.call(X)!=="[object Object]")return!1;for(Q in X)if(u1.call(X,Q))if(!G)G=!0;else return!1;if(!G)return!1;if(J.indexOf(Q)===-1)J.push(Q);else return!1}return!0}function l1($){return $!==null?$:[]}var fq=new Y0("tag:yaml.org,2002:omap",{kind:"sequence",resolve:d1,construct:l1}),c1=Object.prototype.toString;function i1($){if($===null)return!0;var J,Z,q,X,Q,G=$;Q=new Array(G.length);for(J=0,Z=G.length;J<Z;J+=1){if(q=G[J],c1.call(q)!=="[object Object]")return!1;if(X=Object.keys(q),X.length!==1)return!1;Q[J]=[X[0],q[X[0]]]}return!0}function n1($){if($===null)return[];var J,Z,q,X,Q,G=$;Q=new Array(G.length);for(J=0,Z=G.length;J<Z;J+=1)q=G[J],X=Object.keys(q),Q[J]=[X[0],q[X[0]]];return Q}var Sq=new Y0("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:i1,construct:n1}),o1=Object.prototype.hasOwnProperty;function r1($){if($===null)return!0;var J,Z=$;for(J in Z)if(o1.call(Z,J)){if(Z[J]!==null)return!1}return!0}function s1($){return $!==null?$:{}}var xq=new Y0("tag:yaml.org,2002:set",{kind:"mapping",resolve:r1,construct:s1}),yJ=Lq.extend({implicit:[Pq,Aq],explicit:[Eq,fq,Sq,xq]}),X8=Object.prototype.hasOwnProperty,v$=1,vq=2,kq=3,k$=4,SJ=1,a1=2,tZ=3,t1=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,e1=/[\x85\u2028\u2029]/,$G=/[,\[\]\{\}]/,_q=/^(?:!|!!|![a-z\-]+!)$/i,gq=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function eZ($){return Object.prototype.toString.call($)}function m0($){return $===10||$===13}function V8($){return $===9||$===32}function j0($){return $===9||$===32||$===10||$===13}function P8($){return $===44||$===91||$===93||$===123||$===125}function JG($){var J;if(48<=$&&$<=57)return $-48;if(J=$|32,97<=J&&J<=102)return J-97+10;return-1}function ZG($){if($===120)return 2;if($===117)return 4;if($===85)return 8;return 0}function qG($){if(48<=$&&$<=57)return $-48;return-1}function $q($){return $===48?"\x00":$===97?"\x07":$===98?"\b":$===116?"\t":$===9?"\t":$===110?`
`:$===118?"\v":$===102?"\f":$===114?"\r":$===101?"\x1B":$===32?" ":$===34?'"':$===47?"/":$===92?"\\":$===78?"":$===95?"":$===76?"\u2028":$===80?"\u2029":""}function XG($){if($<=65535)return String.fromCharCode($);return String.fromCharCode(($-65536>>10)+55296,($-65536&1023)+56320)}function mq($,J,Z){if(J==="__proto__")Object.defineProperty($,J,{configurable:!0,enumerable:!0,writable:!0,value:Z});else $[J]=Z}var yq=new Array(256),bq=new Array(256);for(Z8=0;Z8<256;Z8++)yq[Z8]=$q(Z8)?1:0,bq[Z8]=$q(Z8);var Z8;function QG($,J){this.input=$,this.filename=J.filename||null,this.schema=J.schema||yJ,this.onWarning=J.onWarning||null,this.legacy=J.legacy||!1,this.json=J.json||!1,this.listener=J.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=$.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function hq($,J){var Z={name:$.filename,buffer:$.input.slice(0,-1),position:$.position,line:$.line,column:$.position-$.lineStart};return Z.snippet=W1(Z),new H0(J,Z)}function u($,J){throw hq($,J)}function _$($,J){if($.onWarning)$.onWarning.call(null,hq($,J))}var Jq={YAML:function $(J,Z,q){var X,Q,G;if(J.version!==null)u(J,"duplication of %YAML directive");if(q.length!==1)u(J,"YAML directive accepts exactly one argument");if(X=/^([0-9]+)\.([0-9]+)$/.exec(q[0]),X===null)u(J,"ill-formed argument of the YAML directive");if(Q=parseInt(X[1],10),G=parseInt(X[2],10),Q!==1)u(J,"unacceptable YAML version of the document");if(J.version=q[0],J.checkLineBreaks=G<2,G!==1&&G!==2)_$(J,"unsupported YAML version of the document")},TAG:function $(J,Z,q){var X,Q;if(q.length!==2)u(J,"TAG directive accepts exactly two arguments");if(X=q[0],Q=q[1],!_q.test(X))u(J,"ill-formed tag handle (first argument) of the TAG directive");if(X8.call(J.tagMap,X))u(J,'there is a previously declared suffix for "'+X+'" tag handle');if(!gq.test(Q))u(J,"ill-formed tag prefix (second argument) of the TAG directive");try{Q=decodeURIComponent(Q)}catch(G){u(J,"tag prefix is malformed: "+Q)}J.tagMap[X]=Q}};function q8($,J,Z,q){var X,Q,G,Y;if(J<Z){if(Y=$.input.slice(J,Z),q){for(X=0,Q=Y.length;X<Q;X+=1)if(G=Y.charCodeAt(X),!(G===9||32<=G&&G<=1114111))u($,"expected valid JSON character")}else if(t1.test(Y))u($,"the stream contains non-printable characters");$.result+=Y}}function Zq($,J,Z,q){var X,Q,G,Y;if(!J0.isObject(Z))u($,"cannot merge mappings; the provided source object is unacceptable");X=Object.keys(Z);for(G=0,Y=X.length;G<Y;G+=1)if(Q=X[G],!X8.call(J,Q))mq(J,Q,Z[Q]),q[Q]=!0}function A8($,J,Z,q,X,Q,G,Y,U){var z,W;if(Array.isArray(X)){X=Array.prototype.slice.call(X);for(z=0,W=X.length;z<W;z+=1){if(Array.isArray(X[z]))u($,"nested arrays are not supported inside keys");if(typeof X==="object"&&eZ(X[z])==="[object Object]")X[z]="[object Object]"}}if(typeof X==="object"&&eZ(X)==="[object Object]")X="[object Object]";if(X=String(X),J===null)J={};if(q==="tag:yaml.org,2002:merge")if(Array.isArray(Q))for(z=0,W=Q.length;z<W;z+=1)Zq($,J,Q[z],Z);else Zq($,J,Q,Z);else{if(!$.json&&!X8.call(Z,X)&&X8.call(J,X))$.line=G||$.line,$.lineStart=Y||$.lineStart,$.position=U||$.position,u($,"duplicated mapping key");mq(J,X,Q),delete Z[X]}return J}function bJ($){var J=$.input.charCodeAt($.position);if(J===10)$.position++;else if(J===13){if($.position++,$.input.charCodeAt($.position)===10)$.position++}else u($,"a line break is expected");$.line+=1,$.lineStart=$.position,$.firstTabInLine=-1}function t($,J,Z){var q=0,X=$.input.charCodeAt($.position);while(X!==0){while(V8(X)){if(X===9&&$.firstTabInLine===-1)$.firstTabInLine=$.position;X=$.input.charCodeAt(++$.position)}if(J&&X===35)do X=$.input.charCodeAt(++$.position);while(X!==10&&X!==13&&X!==0);if(m0(X)){bJ($),X=$.input.charCodeAt($.position),q++,$.lineIndent=0;while(X===32)$.lineIndent++,X=$.input.charCodeAt(++$.position)}else break}if(Z!==-1&&q!==0&&$.lineIndent<Z)_$($,"deficient indentation");return q}function y$($){var J=$.position,Z;if(Z=$.input.charCodeAt(J),(Z===45||Z===46)&&Z===$.input.charCodeAt(J+1)&&Z===$.input.charCodeAt(J+2)){if(J+=3,Z=$.input.charCodeAt(J),Z===0||j0(Z))return!0}return!1}function hJ($,J){if(J===1)$.result+=" ";else if(J>1)$.result+=J0.repeat(`
`,J-1)}function GG($,J,Z){var q,X,Q,G,Y,U,z,W,M=$.kind,V=$.result,O;if(O=$.input.charCodeAt($.position),j0(O)||P8(O)||O===35||O===38||O===42||O===33||O===124||O===62||O===39||O===34||O===37||O===64||O===96)return!1;if(O===63||O===45){if(X=$.input.charCodeAt($.position+1),j0(X)||Z&&P8(X))return!1}$.kind="scalar",$.result="",Q=G=$.position,Y=!1;while(O!==0){if(O===58){if(X=$.input.charCodeAt($.position+1),j0(X)||Z&&P8(X))break}else if(O===35){if(q=$.input.charCodeAt($.position-1),j0(q))break}else if($.position===$.lineStart&&y$($)||Z&&P8(O))break;else if(m0(O))if(U=$.line,z=$.lineStart,W=$.lineIndent,t($,!1,-1),$.lineIndent>=J){Y=!0,O=$.input.charCodeAt($.position);continue}else{$.position=G,$.line=U,$.lineStart=z,$.lineIndent=W;break}if(Y)q8($,Q,G,!1),hJ($,$.line-U),Q=G=$.position,Y=!1;if(!V8(O))G=$.position+1;O=$.input.charCodeAt(++$.position)}if(q8($,Q,G,!1),$.result)return!0;return $.kind=M,$.result=V,!1}function YG($,J){var Z,q,X;if(Z=$.input.charCodeAt($.position),Z!==39)return!1;$.kind="scalar",$.result="",$.position++,q=X=$.position;while((Z=$.input.charCodeAt($.position))!==0)if(Z===39)if(q8($,q,$.position,!0),Z=$.input.charCodeAt(++$.position),Z===39)q=$.position,$.position++,X=$.position;else return!0;else if(m0(Z))q8($,q,X,!0),hJ($,t($,!1,J)),q=X=$.position;else if($.position===$.lineStart&&y$($))u($,"unexpected end of the document within a single quoted scalar");else $.position++,X=$.position;u($,"unexpected end of the stream within a single quoted scalar")}function UG($,J){var Z,q,X,Q,G,Y;if(Y=$.input.charCodeAt($.position),Y!==34)return!1;$.kind="scalar",$.result="",$.position++,Z=q=$.position;while((Y=$.input.charCodeAt($.position))!==0)if(Y===34)return q8($,Z,$.position,!0),$.position++,!0;else if(Y===92){if(q8($,Z,$.position,!0),Y=$.input.charCodeAt(++$.position),m0(Y))t($,!1,J);else if(Y<256&&yq[Y])$.result+=bq[Y],$.position++;else if((G=ZG(Y))>0){X=G,Q=0;for(;X>0;X--)if(Y=$.input.charCodeAt(++$.position),(G=JG(Y))>=0)Q=(Q<<4)+G;else u($,"expected hexadecimal character");$.result+=XG(Q),$.position++}else u($,"unknown escape sequence");Z=q=$.position}else if(m0(Y))q8($,Z,q,!0),hJ($,t($,!1,J)),Z=q=$.position;else if($.position===$.lineStart&&y$($))u($,"unexpected end of the document within a double quoted scalar");else $.position++,q=$.position;u($,"unexpected end of the stream within a double quoted scalar")}function WG($,J){var Z=!0,q,X,Q,G=$.tag,Y,U=$.anchor,z,W,M,V,O,B=Object.create(null),E,H,I,N;if(N=$.input.charCodeAt($.position),N===91)W=93,O=!1,Y=[];else if(N===123)W=125,O=!0,Y={};else return!1;if($.anchor!==null)$.anchorMap[$.anchor]=Y;N=$.input.charCodeAt(++$.position);while(N!==0){if(t($,!0,J),N=$.input.charCodeAt($.position),N===W)return $.position++,$.tag=G,$.anchor=U,$.kind=O?"mapping":"sequence",$.result=Y,!0;else if(!Z)u($,"missed comma between flow collection entries");else if(N===44)u($,"expected the node content, but found ','");if(H=E=I=null,M=V=!1,N===63){if(z=$.input.charCodeAt($.position+1),j0(z))M=V=!0,$.position++,t($,!0,J)}if(q=$.line,X=$.lineStart,Q=$.position,E8($,J,v$,!1,!0),H=$.tag,E=$.result,t($,!0,J),N=$.input.charCodeAt($.position),(V||$.line===q)&&N===58)M=!0,N=$.input.charCodeAt(++$.position),t($,!0,J),E8($,J,v$,!1,!0),I=$.result;if(O)A8($,Y,B,H,E,I,q,X,Q);else if(M)Y.push(A8($,null,B,H,E,I,q,X,Q));else Y.push(E);if(t($,!0,J),N=$.input.charCodeAt($.position),N===44)Z=!0,N=$.input.charCodeAt(++$.position);else Z=!1}u($,"unexpected end of the stream within a flow collection")}function zG($,J){var Z,q,X=SJ,Q=!1,G=!1,Y=J,U=0,z=!1,W,M;if(M=$.input.charCodeAt($.position),M===124)q=!1;else if(M===62)q=!0;else return!1;$.kind="scalar",$.result="";while(M!==0)if(M=$.input.charCodeAt(++$.position),M===43||M===45)if(SJ===X)X=M===43?tZ:a1;else u($,"repeat of a chomping mode identifier");else if((W=qG(M))>=0)if(W===0)u($,"bad explicit indentation width of a block scalar; it cannot be less than one");else if(!G)Y=J+W-1,G=!0;else u($,"repeat of an indentation width identifier");else break;if(V8(M)){do M=$.input.charCodeAt(++$.position);while(V8(M));if(M===35)do M=$.input.charCodeAt(++$.position);while(!m0(M)&&M!==0)}while(M!==0){bJ($),$.lineIndent=0,M=$.input.charCodeAt($.position);while((!G||$.lineIndent<Y)&&M===32)$.lineIndent++,M=$.input.charCodeAt(++$.position);if(!G&&$.lineIndent>Y)Y=$.lineIndent;if(m0(M)){U++;continue}if($.lineIndent<Y){if(X===tZ)$.result+=J0.repeat(`
`,Q?1+U:U);else if(X===SJ){if(Q)$.result+=`
`}break}if(q)if(V8(M))z=!0,$.result+=J0.repeat(`
`,Q?1+U:U);else if(z)z=!1,$.result+=J0.repeat(`
`,U+1);else if(U===0){if(Q)$.result+=" "}else $.result+=J0.repeat(`
`,U);else $.result+=J0.repeat(`
`,Q?1+U:U);Q=!0,G=!0,U=0,Z=$.position;while(!m0(M)&&M!==0)M=$.input.charCodeAt(++$.position);q8($,Z,$.position,!1)}return!0}function qq($,J){var Z,q=$.tag,X=$.anchor,Q=[],G,Y=!1,U;if($.firstTabInLine!==-1)return!1;if($.anchor!==null)$.anchorMap[$.anchor]=Q;U=$.input.charCodeAt($.position);while(U!==0){if($.firstTabInLine!==-1)$.position=$.firstTabInLine,u($,"tab characters must not be used in indentation");if(U!==45)break;if(G=$.input.charCodeAt($.position+1),!j0(G))break;if(Y=!0,$.position++,t($,!0,-1)){if($.lineIndent<=J){Q.push(null),U=$.input.charCodeAt($.position);continue}}if(Z=$.line,E8($,J,kq,!1,!0),Q.push($.result),t($,!0,-1),U=$.input.charCodeAt($.position),($.line===Z||$.lineIndent>J)&&U!==0)u($,"bad indentation of a sequence entry");else if($.lineIndent<J)break}if(Y)return $.tag=q,$.anchor=X,$.kind="sequence",$.result=Q,!0;return!1}function MG($,J,Z){var q,X,Q,G,Y,U,z=$.tag,W=$.anchor,M={},V=Object.create(null),O=null,B=null,E=null,H=!1,I=!1,N;if($.firstTabInLine!==-1)return!1;if($.anchor!==null)$.anchorMap[$.anchor]=M;N=$.input.charCodeAt($.position);while(N!==0){if(!H&&$.firstTabInLine!==-1)$.position=$.firstTabInLine,u($,"tab characters must not be used in indentation");if(q=$.input.charCodeAt($.position+1),Q=$.line,(N===63||N===58)&&j0(q)){if(N===63){if(H)A8($,M,V,O,B,null,G,Y,U),O=B=E=null;I=!0,H=!0,X=!0}else if(H)H=!1,X=!0;else u($,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line");$.position+=1,N=q}else{if(G=$.line,Y=$.lineStart,U=$.position,!E8($,Z,vq,!1,!0))break;if($.line===Q){N=$.input.charCodeAt($.position);while(V8(N))N=$.input.charCodeAt(++$.position);if(N===58){if(N=$.input.charCodeAt(++$.position),!j0(N))u($,"a whitespace character is expected after the key-value separator within a block mapping");if(H)A8($,M,V,O,B,null,G,Y,U),O=B=E=null;I=!0,H=!1,X=!1,O=$.tag,B=$.result}else if(I)u($,"can not read an implicit mapping pair; a colon is missed");else return $.tag=z,$.anchor=W,!0}else if(I)u($,"can not read a block mapping entry; a multiline key may not be an implicit key");else return $.tag=z,$.anchor=W,!0}if($.line===Q||$.lineIndent>J){if(H)G=$.line,Y=$.lineStart,U=$.position;if(E8($,J,k$,!0,X))if(H)B=$.result;else E=$.result;if(!H)A8($,M,V,O,B,E,G,Y,U),O=B=E=null;t($,!0,-1),N=$.input.charCodeAt($.position)}if(($.line===Q||$.lineIndent>J)&&N!==0)u($,"bad indentation of a mapping entry");else if($.lineIndent<J)break}if(H)A8($,M,V,O,B,null,G,Y,U);if(I)$.tag=z,$.anchor=W,$.kind="mapping",$.result=M;return I}function DG($){var J,Z=!1,q=!1,X,Q,G;if(G=$.input.charCodeAt($.position),G!==33)return!1;if($.tag!==null)u($,"duplication of a tag property");if(G=$.input.charCodeAt(++$.position),G===60)Z=!0,G=$.input.charCodeAt(++$.position);else if(G===33)q=!0,X="!!",G=$.input.charCodeAt(++$.position);else X="!";if(J=$.position,Z){do G=$.input.charCodeAt(++$.position);while(G!==0&&G!==62);if($.position<$.length)Q=$.input.slice(J,$.position),G=$.input.charCodeAt(++$.position);else u($,"unexpected end of the stream within a verbatim tag")}else{while(G!==0&&!j0(G)){if(G===33)if(!q){if(X=$.input.slice(J-1,$.position+1),!_q.test(X))u($,"named tag handle cannot contain such characters");q=!0,J=$.position+1}else u($,"tag suffix cannot contain exclamation marks");G=$.input.charCodeAt(++$.position)}if(Q=$.input.slice(J,$.position),$G.test(Q))u($,"tag suffix cannot contain flow indicator characters")}if(Q&&!gq.test(Q))u($,"tag name cannot contain such characters: "+Q);try{Q=decodeURIComponent(Q)}catch(Y){u($,"tag name is malformed: "+Q)}if(Z)$.tag=Q;else if(X8.call($.tagMap,X))$.tag=$.tagMap[X]+Q;else if(X==="!")$.tag="!"+Q;else if(X==="!!")$.tag="tag:yaml.org,2002:"+Q;else u($,'undeclared tag handle "'+X+'"');return!0}function VG($){var J,Z;if(Z=$.input.charCodeAt($.position),Z!==38)return!1;if($.anchor!==null)u($,"duplication of an anchor property");Z=$.input.charCodeAt(++$.position),J=$.position;while(Z!==0&&!j0(Z)&&!P8(Z))Z=$.input.charCodeAt(++$.position);if($.position===J)u($,"name of an anchor node must contain at least one character");return $.anchor=$.input.slice(J,$.position),!0}function KG($){var J,Z,q;if(q=$.input.charCodeAt($.position),q!==42)return!1;q=$.input.charCodeAt(++$.position),J=$.position;while(q!==0&&!j0(q)&&!P8(q))q=$.input.charCodeAt(++$.position);if($.position===J)u($,"name of an alias node must contain at least one character");if(Z=$.input.slice(J,$.position),!X8.call($.anchorMap,Z))u($,'unidentified alias "'+Z+'"');return $.result=$.anchorMap[Z],t($,!0,-1),!0}function E8($,J,Z,q,X){var Q,G,Y,U=1,z=!1,W=!1,M,V,O,B,E,H;if($.listener!==null)$.listener("open",$);if($.tag=null,$.anchor=null,$.kind=null,$.result=null,Q=G=Y=k$===Z||kq===Z,q){if(t($,!0,-1)){if(z=!0,$.lineIndent>J)U=1;else if($.lineIndent===J)U=0;else if($.lineIndent<J)U=-1}}if(U===1)while(DG($)||VG($))if(t($,!0,-1)){if(z=!0,Y=Q,$.lineIndent>J)U=1;else if($.lineIndent===J)U=0;else if($.lineIndent<J)U=-1}else Y=!1;if(Y)Y=z||X;if(U===1||k$===Z){if(v$===Z||vq===Z)E=J;else E=J+1;if(H=$.position-$.lineStart,U===1)if(Y&&(qq($,H)||MG($,H,E))||WG($,E))W=!0;else{if(G&&zG($,E)||YG($,E)||UG($,E))W=!0;else if(KG($)){if(W=!0,$.tag!==null||$.anchor!==null)u($,"alias node should not have any properties")}else if(GG($,E,v$===Z)){if(W=!0,$.tag===null)$.tag="?"}if($.anchor!==null)$.anchorMap[$.anchor]=$.result}else if(U===0)W=Y&&qq($,H)}if($.tag===null){if($.anchor!==null)$.anchorMap[$.anchor]=$.result}else if($.tag==="?"){if($.result!==null&&$.kind!=="scalar")u($,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+$.kind+'"');for(M=0,V=$.implicitTypes.length;M<V;M+=1)if(B=$.implicitTypes[M],B.resolve($.result)){if($.result=B.construct($.result),$.tag=B.tag,$.anchor!==null)$.anchorMap[$.anchor]=$.result;break}}else if($.tag!=="!"){if(X8.call($.typeMap[$.kind||"fallback"],$.tag))B=$.typeMap[$.kind||"fallback"][$.tag];else{B=null,O=$.typeMap.multi[$.kind||"fallback"];for(M=0,V=O.length;M<V;M+=1)if($.tag.slice(0,O[M].tag.length)===O[M].tag){B=O[M];break}}if(!B)u($,"unknown tag !<"+$.tag+">");if($.result!==null&&B.kind!==$.kind)u($,"unacceptable node kind for !<"+$.tag+'> tag; it should be "'+B.kind+'", not "'+$.kind+'"');if(!B.resolve($.result,$.tag))u($,"cannot resolve a node with !<"+$.tag+"> explicit tag");else if($.result=B.construct($.result,$.tag),$.anchor!==null)$.anchorMap[$.anchor]=$.result}if($.listener!==null)$.listener("close",$);return $.tag!==null||$.anchor!==null||W}function OG($){var J=$.position,Z,q,X,Q=!1,G;$.version=null,$.checkLineBreaks=$.legacy,$.tagMap=Object.create(null),$.anchorMap=Object.create(null);while((G=$.input.charCodeAt($.position))!==0){if(t($,!0,-1),G=$.input.charCodeAt($.position),$.lineIndent>0||G!==37)break;Q=!0,G=$.input.charCodeAt(++$.position),Z=$.position;while(G!==0&&!j0(G))G=$.input.charCodeAt(++$.position);if(q=$.input.slice(Z,$.position),X=[],q.length<1)u($,"directive name must not be less than one character in length");while(G!==0){while(V8(G))G=$.input.charCodeAt(++$.position);if(G===35){do G=$.input.charCodeAt(++$.position);while(G!==0&&!m0(G));break}if(m0(G))break;Z=$.position;while(G!==0&&!j0(G))G=$.input.charCodeAt(++$.position);X.push($.input.slice(Z,$.position))}if(G!==0)bJ($);if(X8.call(Jq,q))Jq[q]($,q,X);else _$($,'unknown document directive "'+q+'"')}if(t($,!0,-1),$.lineIndent===0&&$.input.charCodeAt($.position)===45&&$.input.charCodeAt($.position+1)===45&&$.input.charCodeAt($.position+2)===45)$.position+=3,t($,!0,-1);else if(Q)u($,"directives end mark is expected");if(E8($,$.lineIndent-1,k$,!1,!0),t($,!0,-1),$.checkLineBreaks&&e1.test($.input.slice(J,$.position)))_$($,"non-ASCII line breaks are interpreted as content");if($.documents.push($.result),$.position===$.lineStart&&y$($)){if($.input.charCodeAt($.position)===46)$.position+=3,t($,!0,-1);return}if($.position<$.length-1)u($,"end of the stream or a document separator is expected");else return}function uq($,J){if($=String($),J=J||{},$.length!==0){if($.charCodeAt($.length-1)!==10&&$.charCodeAt($.length-1)!==13)$+=`
`;if($.charCodeAt(0)===65279)$=$.slice(1)}var Z=new QG($,J),q=$.indexOf("\x00");if(q!==-1)Z.position=q,u(Z,"null byte is not allowed in input");Z.input+="\x00";while(Z.input.charCodeAt(Z.position)===32)Z.lineIndent+=1,Z.position+=1;while(Z.position<Z.length-1)OG(Z);return Z.documents}function NG($,J,Z){if(J!==null&&typeof J==="object"&&typeof Z==="undefined")Z=J,J=null;var q=uq($,Z);if(typeof J!=="function")return q;for(var X=0,Q=q.length;X<Q;X+=1)J(q[X])}function HG($,J){var Z=uq($,J);if(Z.length===0)return;else if(Z.length===1)return Z[0];throw new H0("expected a single document in the stream, but found more")}var BG=NG,RG=HG,pq={loadAll:BG,load:RG},dq=Object.prototype.toString,lq=Object.prototype.hasOwnProperty,uJ=65279,CG=9,o8=10,FG=13,jG=32,TG=33,LG=34,vJ=35,IG=37,wG=38,PG=39,AG=42,cq=44,EG=45,g$=58,fG=61,SG=62,xG=63,vG=64,iq=91,nq=93,kG=96,oq=123,_G=124,rq=125,D0={};D0[0]="\\0";D0[7]="\\a";D0[8]="\\b";D0[9]="\\t";D0[10]="\\n";D0[11]="\\v";D0[12]="\\f";D0[13]="\\r";D0[27]="\\e";D0[34]="\\\"";D0[92]="\\\\";D0[133]="\\N";D0[160]="\\_";D0[8232]="\\L";D0[8233]="\\P";var gG=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],mG=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function yG($,J){var Z,q,X,Q,G,Y,U;if(J===null)return{};Z={},q=Object.keys(J);for(X=0,Q=q.length;X<Q;X+=1){if(G=q[X],Y=String(J[G]),G.slice(0,2)==="!!")G="tag:yaml.org,2002:"+G.slice(2);if(U=$.compiledTypeMap.fallback[G],U&&lq.call(U.styleAliases,Y))Y=U.styleAliases[Y];Z[G]=Y}return Z}function bG($){var J,Z,q;if(J=$.toString(16).toUpperCase(),$<=255)Z="x",q=2;else if($<=65535)Z="u",q=4;else if($<=4294967295)Z="U",q=8;else throw new H0("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+Z+J0.repeat("0",q-J.length)+J}var hG=1,r8=2;function uG($){this.schema=$.schema||yJ,this.indent=Math.max(1,$.indent||2),this.noArrayIndent=$.noArrayIndent||!1,this.skipInvalid=$.skipInvalid||!1,this.flowLevel=J0.isNothing($.flowLevel)?-1:$.flowLevel,this.styleMap=yG(this.schema,$.styles||null),this.sortKeys=$.sortKeys||!1,this.lineWidth=$.lineWidth||80,this.noRefs=$.noRefs||!1,this.noCompatMode=$.noCompatMode||!1,this.condenseFlow=$.condenseFlow||!1,this.quotingType=$.quotingType==='"'?r8:hG,this.forceQuotes=$.forceQuotes||!1,this.replacer=typeof $.replacer==="function"?$.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function Xq($,J){var Z=J0.repeat(" ",J),q=0,X=-1,Q="",G,Y=$.length;while(q<Y){if(X=$.indexOf(`
`,q),X===-1)G=$.slice(q),q=Y;else G=$.slice(q,X+1),q=X+1;if(G.length&&G!==`
`)Q+=Z;Q+=G}return Q}function kJ($,J){return`
`+J0.repeat(" ",$.indent*J)}function pG($,J){var Z,q,X;for(Z=0,q=$.implicitTypes.length;Z<q;Z+=1)if(X=$.implicitTypes[Z],X.resolve(J))return!0;return!1}function m$($){return $===jG||$===CG}function s8($){return 32<=$&&$<=126||161<=$&&$<=55295&&$!==8232&&$!==8233||57344<=$&&$<=65533&&$!==uJ||65536<=$&&$<=1114111}function Qq($){return s8($)&&$!==uJ&&$!==FG&&$!==o8}function Gq($,J,Z){var q=Qq($),X=q&&!m$($);return(Z?q:q&&$!==cq&&$!==iq&&$!==nq&&$!==oq&&$!==rq)&&$!==vJ&&!(J===g$&&!X)||Qq(J)&&!m$(J)&&$===vJ||J===g$&&X}function dG($){return s8($)&&$!==uJ&&!m$($)&&$!==EG&&$!==xG&&$!==g$&&$!==cq&&$!==iq&&$!==nq&&$!==oq&&$!==rq&&$!==vJ&&$!==wG&&$!==AG&&$!==TG&&$!==_G&&$!==fG&&$!==SG&&$!==PG&&$!==LG&&$!==IG&&$!==vG&&$!==kG}function lG($){return!m$($)&&$!==g$}function i8($,J){var Z=$.charCodeAt(J),q;if(Z>=55296&&Z<=56319&&J+1<$.length){if(q=$.charCodeAt(J+1),q>=56320&&q<=57343)return(Z-55296)*1024+q-56320+65536}return Z}function sq($){var J=/^\n* /;return J.test($)}var aq=1,_J=2,tq=3,eq=4,w8=5;function cG($,J,Z,q,X,Q,G,Y){var U,z=0,W=null,M=!1,V=!1,O=q!==-1,B=-1,E=dG(i8($,0))&&lG(i8($,$.length-1));if(J||G)for(U=0;U<$.length;z>=65536?U+=2:U++){if(z=i8($,U),!s8(z))return w8;E=E&&Gq(z,W,Y),W=z}else{for(U=0;U<$.length;z>=65536?U+=2:U++){if(z=i8($,U),z===o8){if(M=!0,O)V=V||U-B-1>q&&$[B+1]!==" ",B=U}else if(!s8(z))return w8;E=E&&Gq(z,W,Y),W=z}V=V||O&&(U-B-1>q&&$[B+1]!==" ")}if(!M&&!V){if(E&&!G&&!X($))return aq;return Q===r8?w8:_J}if(Z>9&&sq($))return w8;if(!G)return V?eq:tq;return Q===r8?w8:_J}function iG($,J,Z,q,X){$.dump=function(){if(J.length===0)return $.quotingType===r8?'""':"''";if(!$.noCompatMode){if(gG.indexOf(J)!==-1||mG.test(J))return $.quotingType===r8?'"'+J+'"':"'"+J+"'"}var Q=$.indent*Math.max(1,Z),G=$.lineWidth===-1?-1:Math.max(Math.min($.lineWidth,40),$.lineWidth-Q),Y=q||$.flowLevel>-1&&Z>=$.flowLevel;function U(z){return pG($,z)}switch(cG(J,Y,$.indent,G,U,$.quotingType,$.forceQuotes&&!q,X)){case aq:return J;case _J:return"'"+J.replace(/'/g,"''")+"'";case tq:return"|"+Yq(J,$.indent)+Uq(Xq(J,Q));case eq:return">"+Yq(J,$.indent)+Uq(Xq(nG(J,G),Q));case w8:return'"'+oG(J)+'"';default:throw new H0("impossible error: invalid scalar style")}}()}function Yq($,J){var Z=sq($)?String(J):"",q=$[$.length-1]===`
`,X=q&&($[$.length-2]===`
`||$===`
`),Q=X?"+":q?"":"-";return Z+Q+`
`}function Uq($){return $[$.length-1]===`
`?$.slice(0,-1):$}function nG($,J){var Z=/(\n+)([^\n]*)/g,q=function(){var z=$.indexOf(`
`);return z=z!==-1?z:$.length,Z.lastIndex=z,Wq($.slice(0,z),J)}(),X=$[0]===`
`||$[0]===" ",Q,G;while(G=Z.exec($)){var Y=G[1],U=G[2];Q=U[0]===" ",q+=Y+(!X&&!Q&&U!==""?`
`:"")+Wq(U,J),X=Q}return q}function Wq($,J){if($===""||$[0]===" ")return $;var Z=/ [^ ]/g,q,X=0,Q,G=0,Y=0,U="";while(q=Z.exec($)){if(Y=q.index,Y-X>J)Q=G>X?G:Y,U+=`
`+$.slice(X,Q),X=Q+1;G=Y}if(U+=`
`,$.length-X>J&&G>X)U+=$.slice(X,G)+`
`+$.slice(G+1);else U+=$.slice(X);return U.slice(1)}function oG($){var J="",Z=0,q;for(var X=0;X<$.length;Z>=65536?X+=2:X++)if(Z=i8($,X),q=D0[Z],!q&&s8(Z)){if(J+=$[X],Z>=65536)J+=$[X+1]}else J+=q||bG(Z);return J}function rG($,J,Z){var q="",X=$.tag,Q,G,Y;for(Q=0,G=Z.length;Q<G;Q+=1){if(Y=Z[Q],$.replacer)Y=$.replacer.call(Z,String(Q),Y);if(l0($,J,Y,!1,!1)||typeof Y==="undefined"&&l0($,J,null,!1,!1)){if(q!=="")q+=","+(!$.condenseFlow?" ":"");q+=$.dump}}$.tag=X,$.dump="["+q+"]"}function zq($,J,Z,q){var X="",Q=$.tag,G,Y,U;for(G=0,Y=Z.length;G<Y;G+=1){if(U=Z[G],$.replacer)U=$.replacer.call(Z,String(G),U);if(l0($,J+1,U,!0,!0,!1,!0)||typeof U==="undefined"&&l0($,J+1,null,!0,!0,!1,!0)){if(!q||X!=="")X+=kJ($,J);if($.dump&&o8===$.dump.charCodeAt(0))X+="-";else X+="- ";X+=$.dump}}$.tag=Q,$.dump=X||"[]"}function sG($,J,Z){var q="",X=$.tag,Q=Object.keys(Z),G,Y,U,z,W;for(G=0,Y=Q.length;G<Y;G+=1){if(W="",q!=="")W+=", ";if($.condenseFlow)W+='"';if(U=Q[G],z=Z[U],$.replacer)z=$.replacer.call(Z,U,z);if(!l0($,J,U,!1,!1))continue;if($.dump.length>1024)W+="? ";if(W+=$.dump+($.condenseFlow?'"':"")+":"+($.condenseFlow?"":" "),!l0($,J,z,!1,!1))continue;W+=$.dump,q+=W}$.tag=X,$.dump="{"+q+"}"}function aG($,J,Z,q){var X="",Q=$.tag,G=Object.keys(Z),Y,U,z,W,M,V;if($.sortKeys===!0)G.sort();else if(typeof $.sortKeys==="function")G.sort($.sortKeys);else if($.sortKeys)throw new H0("sortKeys must be a boolean or a function");for(Y=0,U=G.length;Y<U;Y+=1){if(V="",!q||X!=="")V+=kJ($,J);if(z=G[Y],W=Z[z],$.replacer)W=$.replacer.call(Z,z,W);if(!l0($,J+1,z,!0,!0,!0))continue;if(M=$.tag!==null&&$.tag!=="?"||$.dump&&$.dump.length>1024,M)if($.dump&&o8===$.dump.charCodeAt(0))V+="?";else V+="? ";if(V+=$.dump,M)V+=kJ($,J);if(!l0($,J+1,W,!0,M))continue;if($.dump&&o8===$.dump.charCodeAt(0))V+=":";else V+=": ";V+=$.dump,X+=V}$.tag=Q,$.dump=X||"{}"}function Mq($,J,Z){var q,X,Q,G,Y,U;X=Z?$.explicitTypes:$.implicitTypes;for(Q=0,G=X.length;Q<G;Q+=1)if(Y=X[Q],(Y.instanceOf||Y.predicate)&&(!Y.instanceOf||typeof J==="object"&&J instanceof Y.instanceOf)&&(!Y.predicate||Y.predicate(J))){if(Z)if(Y.multi&&Y.representName)$.tag=Y.representName(J);else $.tag=Y.tag;else $.tag="?";if(Y.represent){if(U=$.styleMap[Y.tag]||Y.defaultStyle,dq.call(Y.represent)==="[object Function]")q=Y.represent(J,U);else if(lq.call(Y.represent,U))q=Y.represent[U](J,U);else throw new H0("!<"+Y.tag+'> tag resolver accepts not "'+U+'" style');$.dump=q}return!0}return!1}function l0($,J,Z,q,X,Q,G){if($.tag=null,$.dump=Z,!Mq($,Z,!1))Mq($,Z,!0);var Y=dq.call($.dump),U=q,z;if(q)q=$.flowLevel<0||$.flowLevel>J;var W=Y==="[object Object]"||Y==="[object Array]",M,V;if(W)M=$.duplicates.indexOf(Z),V=M!==-1;if($.tag!==null&&$.tag!=="?"||V||$.indent!==2&&J>0)X=!1;if(V&&$.usedDuplicates[M])$.dump="*ref_"+M;else{if(W&&V&&!$.usedDuplicates[M])$.usedDuplicates[M]=!0;if(Y==="[object Object]"){if(q&&Object.keys($.dump).length!==0){if(aG($,J,$.dump,X),V)$.dump="&ref_"+M+$.dump}else if(sG($,J,$.dump),V)$.dump="&ref_"+M+" "+$.dump}else if(Y==="[object Array]"){if(q&&$.dump.length!==0){if($.noArrayIndent&&!G&&J>0)zq($,J-1,$.dump,X);else zq($,J,$.dump,X);if(V)$.dump="&ref_"+M+$.dump}else if(rG($,J,$.dump),V)$.dump="&ref_"+M+" "+$.dump}else if(Y==="[object String]"){if($.tag!=="?")iG($,$.dump,J,Q,U)}else if(Y==="[object Undefined]")return!1;else{if($.skipInvalid)return!1;throw new H0("unacceptable kind of an object to dump "+Y)}if($.tag!==null&&$.tag!=="?"){if(z=encodeURI($.tag[0]==="!"?$.tag.slice(1):$.tag).replace(/!/g,"%21"),$.tag[0]==="!")z="!"+z;else if(z.slice(0,18)==="tag:yaml.org,2002:")z="!!"+z.slice(18);else z="!<"+z+">";$.dump=z+" "+$.dump}}return!0}function tG($,J){var Z=[],q=[],X,Q;gJ($,Z,q);for(X=0,Q=q.length;X<Q;X+=1)J.duplicates.push(Z[q[X]]);J.usedDuplicates=new Array(Q)}function gJ($,J,Z){var q,X,Q;if($!==null&&typeof $==="object")if(X=J.indexOf($),X!==-1){if(Z.indexOf(X)===-1)Z.push(X)}else if(J.push($),Array.isArray($))for(X=0,Q=$.length;X<Q;X+=1)gJ($[X],J,Z);else{q=Object.keys($);for(X=0,Q=q.length;X<Q;X+=1)gJ($[q[X]],J,Z)}}function eG($,J){J=J||{};var Z=new uG(J);if(!Z.noRefs)tG($,Z);var q=$;if(Z.replacer)q=Z.replacer.call({"":q},"",q);if(l0(Z,0,q,!0,!0))return Z.dump+`
`;return""}var $4=eG,J4={dump:$4};function pJ($,J){return function(){throw new Error("Function yaml."+$+" is removed in js-yaml 4. Use yaml."+J+" instead, which is now safe by default.")}}var Z4=Y0,q4=Kq,X4=Bq,Q4=Tq,G4=Lq,Y4=yJ,U4=pq.load,W4=pq.loadAll,z4=J4.dump,M4=H0,D4={binary:Eq,float:jq,map:Hq,null:Rq,pairs:Sq,set:xq,timestamp:Pq,bool:Cq,int:Fq,merge:Aq,omap:fq,seq:Nq,str:Oq},V4=pJ("safeLoad","load"),K4=pJ("safeLoadAll","loadAll"),O4=pJ("safeDump","dump"),$X={Type:Z4,Schema:q4,FAILSAFE_SCHEMA:X4,JSON_SCHEMA:Q4,CORE_SCHEMA:G4,DEFAULT_SCHEMA:Y4,load:U4,loadAll:W4,dump:z4,YAMLException:M4,types:D4,safeLoad:V4,safeLoadAll:K4,safeDump:O4};function JX($){let J=$.split(`
`),Z="",q={"@context":"https://schema.org","@type":"CreativeWork"},X=[],Q=(w)=>{let T=w.trim();if(!T)return null;try{return JSON.parse(T)}catch{}try{return $X.load(T)}catch{}return null},G={},Y=!1,U="",z=!1;J.forEach((w)=>{let T=w.trim();if(T==="```agg"){z=!0;return}if(z){if(T==="```")z=!1;return}let S=T.match(/^\[master:([^\]]+)\]$/);if(S){U=S[1]||"",G[U]=[],Y=!0;return}if(Y&&U){if(T.startsWith("|")){let x=T.split("|").slice(1,-1).map((D)=>D.trim());if(!x.every((D)=>D.match(/^-+$/))&&U&&G[U])G[U].push(x)}else if(T.length>0)Y=!1}}),o.setMasterData(G);let W=null,M=null,V=!1,O=!1,B="";q.fields=[],q.tables={},q.masterData=G;let E=[],H=null,I="",N=!1,F=[],f=(w)=>{I+=w},k=(w)=>{return w.replace(/\[(?:([a-z]+):)?([^\]\s:\(\)]+)(?:\s*\((.*?)\))?\]/g,(T,S,x,d)=>{let D=(d||"").match(/placeholder="([^"]+)"/)||(d||"").match(/placeholder='([^']+)'/),L=D?D[1]:x;return q.fields.push({key:x,label:L,type:S||"text"}),o.renderInput(S||"text",x,d||"")})};if(J.forEach((w)=>{let T=w.trim();if(T==="```agg"){N=!0,F=[];return}if(N){if(T==="```"){N=!1;let D=Q(F.join(`
`));if(D)X.push(D);F=[]}else F.push(w);return}let S=T.match(/^\[master:([^\]]+)\]$/);if(S){B=S[1]||"";return}let x=T.match(/^\[dynamic\s*-?\s*table:([^\]]+)\]$/);if(x){M=x[1]||"",q.tables[M]=[];return}if(T.startsWith("|")){if(!V){f('<div class="form-row vertical"><div class="table-wrapper">');let C="data-table",j="";if(M)C+=" dynamic",j=`id="tbl_${M}" data-table-key="${M}"`;else if(B)C+=" master",j=`data-master-key="${B}"`;f(`<table class="${C}" ${j}>`),f("<tbody>"),V=!0,O=!!B}let D=T.split("|").slice(1,-1).map((C)=>C.trim());if(D.every((C)=>C.match(/^-+$/)));else if(M)if(!D.some((j)=>j.includes("[")))f(`<tr>${D.map((j)=>`<th>${o.escapeHtml(j)}</th>`).join("")}<th class="row-action-cell"></th></tr>`);else{let j=M;D.forEach((v)=>{let _=v.trim().match(/^\[(?:([a-z]+):)?([^\]:\(\)]+)(?:\s*\((.*)\)|:([^\]]+))?\]$/);if(_){let[h,m,p,U0,i0]=_,I0=p.trim(),n0=U0||i0||"";if(I0.includes(" ")){let S8=I0.split(/\s+/);I0=S8[0],n0=S8.slice(1).join(" ")+" "+n0}let N8=n0.match(/placeholder="([^"]+)"/)||n0.match(/placeholder='([^']+)'/),f8=N8?N8[1]:I0;q.tables[j].push({key:I0,label:f8,type:m||"text"})}});let A=o.tableRow(D,!0);A=A.replace("</tr>",'<td class="row-action-cell"><button type="button" class="remove-row-btn" onclick="removeTableRow(this)" tabindex="-1"></button></td></tr>'),f(A)}else if(O)f(o.tableRow(D));else f(o.tableRow(D));return}else if(V){if(f("</tbody></table></div>"),M)f(`<button type="button" class="add-row-btn" onclick="addTableRow(this, '${M}')" data-i18n="add_row">+ </button>`),M=null;f("</div>"),V=!1,O=!1,B=""}let d=T.match(/^(#{1,6})\s+(.*)$/);if(d){let D=d[1]?d[1].length:1,L=d[2]||"";if(D===1)f(`<h1>${o.escapeHtml(L)}</h1>`),q.name=L;else if(D===2){if(H)f("</div>");let C=L.includes("(Config)")||L.includes("(Hidden)")||L.includes("(System)"),j="tab-"+(E.length+1);E.push({id:j,title:L,isSystem:C}),H=j;let A=!C&&E.filter((_)=>!_.isSystem).length===1?" active":"",v=C?' style="display:none !important;"':"";f(`<div id="${j}" class="tab-content${A}" data-tab-title="${o.escapeHtml(L)}"${v}>`)}else f(`<h${D}>${o.escapeHtml(L)}</h${D}>`);W=null}else if(w.startsWith("  - ")||w.startsWith("\t- ")){if(W){let D=T.replace(/^-\s*/,""),L=!1;if(D.startsWith("[x] "))L=!0,D=D.substring(4);f(o.radioOption(W.key,D,D,L))}}else if(T.startsWith("- [")){let D=T.match(/^-\s*\[([a-z]+):([^\]\s:\(\)]+)(?:\s*\((.*)\))?\]\s*(.*)$/);if(D){let[L,C,j,A,v]=D;W=null;let _=(v||"").trim();if(q.fields.push({key:j,label:_,type:C}),C==="radio")W={key:j,label:_,attrs:A||""},f(o.radioStart(j,_,A));else if(C==="text")f(o.text(j,_,A));else if(C==="number")f(o.number(j,_,A));else if(C==="date")f(o.date(j,_,A));else if(C==="textarea")f(o.textarea(j,_,A));else if(C==="search")f(o.search(j,_,A));else if(C==="calc")f(o.calc(j,_,A));else if(C==="datalist")f(o.renderInput(C,j,A));else if(C&&o[C])f(o[C](j,_,A));else console.warn(`Unknown type: ${C}`,Object.keys(o)),f(`<p style="color:red">Unknown type: ${C}</p>`)}}else if(T.startsWith("---")){if(!H)f("<hr>");W=null}else if(T.startsWith("<")){if(W)f("</div></div>"),W=null;f(k(T))}else if(T.length>0){if(W)f("</div></div>"),W=null;f(`<p>${o.escapeHtml(k(T))}</p>`)}else if(W)f("</div></div>"),W=null}),V){if(f("</tbody></table></div>"),M)f(`<button type="button" class="add-row-btn" onclick="addTableRow(this, '${M}')" data-i18n="add_row">+ </button>`),M=null;f("</div>")}if(W)f("</div></div>");if(H)f("</div>");let g=`
            <div style="flex:1"></div>
            <button class="btn-clear" onclick="window.clearData()" data-i18n="clear_btn">Clear</button>
            <button class="secondary" onclick="window.saveDraft()" data-i18n="work_save_btn">Save Progress</button>
            <button class="primary" onclick="window.signAndDownload()" data-i18n="sign_btn">Submit</button>
    `,y=`<div class="no-print form-toolbar" style="display: flex; gap: 10px; align-items: center; margin-top: 2rem; padding-top: 1rem; border-top: 1px solid #eee;">
            ${g}
        </div>`;if(E.length>0){let w='<div class="tabs-nav">',T=0;if(E.forEach((S,x)=>{if(S.isSystem)return;w+=`<button class="tab-btn${T===0?" active":""}" onclick="switchTab(this, '${S.id}')">${o.escapeHtml(S.title)}</button>`,T++}),w+=`<div class="no-print" style="display: flex; gap: 10px; align-items: center; flex-grow: 1;">
            ${g}
        </div>`,w+="</div>",I.includes("</h1>"))Z=I.replace("</h1>","</h1>"+w);else Z=w+I}else Z=I+y;if(X.length===1)q.aggSpec=X[0];else if(X.length>1)q.aggSpec=X;return{html:Z,jsonStructure:q}}var dJ=typeof window!=="undefined"&&window.__WEBA_BUILD_TIME__?window.__WEBA_BUILD_TIME__:typeof process!=="undefined"&&process.env&&process.env.BUILD_TIME?process.env.BUILD_TIME:"";function N4($){if(!$)return"Build: dev";return`Build: ${$.replace("T"," ").replace(".000Z","Z")}`}function ZX($,J){let Z=J.trim().replace(/^\$\./,"");if(!Z)return[];let q=Z.split("."),X=[$];for(let Q of q){let G=Q.match(/^(.*)\[(\d*)\]$/),Y=G?G[1]:Q,U=G?G[2]:null,z=G&&U==="",W=G&&U!==""&&U!==null?parseInt(U,10):null,M=[];for(let V of X){if(V===null||V===void 0)continue;let O=Y?V[Y]:V;if(z){if(Array.isArray(O))M.push(...O);continue}if(W!==null){if(Array.isArray(O)&&O[W]!==void 0)M.push(O[W]);continue}if(O!==void 0)M.push(O)}X=M}return X}function H4($,J,Z){if(!J){$.innerHTML="";return}let q="",X=J.dashboard?.cards||J.metrics?.map((G)=>({id:G.id,label:G.name,op:G.type,path:G.path}))||[];if(X.length>0){let G=X.map((Y)=>{let U=0,z=[];if(Z.forEach((W)=>{if(Y.path)z.push(...ZX(W.plain,Y.path))}),Y.op==="count")U=Z.length;else if(Y.op==="sum")U=z.reduce((W,M)=>W+(Number(M)||0),0);else if(Y.op==="avg")U=z.length?z.reduce((W,M)=>W+(Number(M)||0),0)/z.length:0;else if(Y.op==="boolean_count")U=z.filter((W)=>!!W).length;if(typeof U==="number"&&Y.format==="currency")U=new Intl.NumberFormat("ja-JP",{style:"currency",currency:"JPY"}).format(U);else if(typeof U==="number")U=U.toLocaleString();return`
        <div class="metric-card">
          <label>${Y.label}</label>
          <div class="value">${U}</div>
        </div>
      `}).join("");q+=`<div class="dashboard-grid">${G}</div>`}let Q=J.dashboard?.charts||[];if(Q.length>0){let G=Q.map((Y)=>{if(Y.type==="bar"){let U={};Z.forEach((V)=>{ZX(V.plain,Y.source).forEach((B)=>{if(Y.filter){if(B[Y.filter.path]!==Y.filter.value)return}let E=B[Y.x];if(E)U[E]=(U[E]||0)+1})});let z=Object.entries(U).sort((V,O)=>O[1]-V[1]),W=Math.max(...Object.values(U),1),M=z.map(([V,O])=>`
          <div class="chart-bar-row">
            <div class="chart-bar-label">${V}</div>
            <div class="chart-bar-track"><div class="chart-bar-fill" style="width: ${O/W*100}%"></div></div>
            <div class="chart-bar-value">${O}</div>
          </div>
        `).join("");return`
          <div class="chart-card">
            <h4>${Y.title}</h4>
            <div class="chart-bars">${M}</div>
          </div>
        `}return""}).join("");q+=`<div class="chart-grid">${G}</div>`}$.innerHTML=q}function B4($,J,Z){if(J.length===0){$.innerHTML=`<div class="agg-empty-state">
      <div class="icon">\uD83D\uDCC2</div>
      <p>No records found. Please upload HTML files and click "Run Aggregation".</p>
    </div>`;return}let q=Z.map((Q)=>`<th>${Q}</th>`).join(""),X=J.map((Q,G)=>{let Y=Z.map((U)=>`<td>${Q[U]??""}</td>`).join("");return`<tr onclick="window.showRecordDetail(${G})">${Y}</tr>`}).join("");$.innerHTML=`
    <div class="agg-section-header">
      <h3>\uD83D\uDCCB Extracted Records</h3>
      <span class="count-badge">${J.length} records</span>
    </div>
    <div class="agg-table-container">
      <table class="agg-table">
        <thead><tr>${q}</tr></thead>
        <tbody>${X}</tbody>
      </table>
    </div>
  `,window._aggRows=J}var lJ=null,cJ=null;function R4(){let $=document.getElementById("weba-source-markdown");if(!$)return null;return $.textContent||null}function C4(){if(lJ&&cJ)return{html:lJ,structure:cJ};let $=R4();if(!$)return null;let J=JX($);return lJ=J.html,cJ=J.jsonStructure,{html:J.html,structure:J.jsonStructure}}function qX($,J){if(!J)return;let Z=J.trim().replace(/^\$\./,"");if(!Z)return;let q=Z.split("."),X=$;for(let Q of q){if(X===null||X===void 0)return;let G=Q.match(/^(.*)\[(\d+)\]$/);if(G){let Y=G[1],U=parseInt(G[2],10),z=Y?X[Y]:X;X=Array.isArray(z)?z[U]:void 0;continue}X=X[Q]}return X}function XX($,J){if($ instanceof HTMLInputElement&&$.type==="checkbox"){$.checked=!!J;return}let Z=J===null||J===void 0?"":String(J);$.value=Z}function F4($,J){let Z=Array.isArray(J?.fields)?J.fields:[],q=new Set(Z.map((Y)=>Y.key)),X=new Set(Object.keys(J?.tables||{})),Q="",G=!1;for(let Y in $){if(Y.startsWith("@")||Y.startsWith("_")||q.has(Y)||X.has(Y))continue;if(!G)Q+='<div class="detail-group-header">Extra Information</div>',G=!0;Q+=`
      <div class="detail-row">
        <div class="detail-key">${Y}</div>
        <div class="detail-val-box"><pre class="val-json">${JSON.stringify($[Y],null,2)}</pre></div>
      </div>
    `}return Q}function j4($,J){let Z=J||{};$.querySelectorAll("input[data-json-path], textarea[data-json-path], select[data-json-path]").forEach((q)=>{let X=q.dataset.jsonPath||"",Q=qX(Z,X);XX(q,Q)}),$.querySelectorAll("input[type='radio']").forEach((q)=>{let X=q.name;if(!X)return;let Q=qX(Z,X);if(Q!==void 0)q.checked=String(Q)===q.value}),$.querySelectorAll(".data-table.dynamic").forEach((q)=>{let X=q.getAttribute("data-table-key")||"";if(!X)return;let Q=Array.isArray(Z[X])?Z[X]:[],G=q.querySelector("tbody"),Y=G?.querySelector("tr.template-row");if(!G||!Y)return;Y.style.display="none",Q.forEach((U,z)=>{let W=Y.cloneNode(!0);W.classList.remove("template-row"),W.style.display="",W.querySelectorAll("input, textarea, select").forEach((M)=>{let V=M.dataset.baseKey||M.dataset.jsonPath;if(!V)return;XX(M,U?.[V])}),W.querySelectorAll(".auto-num").forEach((M)=>{if(!M.value)M.value=String(z+1)}),W.querySelectorAll(".remove-row-btn").forEach((M)=>{M.style.display="none"}),G.appendChild(W)})}),$.querySelectorAll("input, textarea, select").forEach((q)=>{q.disabled=!0,q.classList.add("readonly")}),$.querySelectorAll(".add-row-btn").forEach((q)=>{q.style.display="none"})}function T4($){let J=window._aggRows;if(!J||!J[$])return;let Z=J[$],q=document.getElementById("weba-agg-detail");if(!q)return;let X=Z._raw||{},Q="",G=C4(),Y="",U=document.getElementById("weba-structure"),z=[],W=null;if(U)try{let H=JSON.parse(U.textContent);z=H.fields||[],W=H}catch{}let M=(H)=>{if(H===null||H===void 0)return'<span class="val-null">N/A</span>';if(typeof H==="boolean")return`<span class="val-bool ${H}">${H?"Yes":"No"}</span>`;if(Array.isArray(H))return`<div class="val-array">${H.map((I)=>`<div class="array-item">${typeof I==="object"?JSON.stringify(I):I}</div>`).join("")}</div>`;if(typeof H==="object")return`<pre class="val-json">${JSON.stringify(H,null,2)}</pre>`;return`<span class="val-text">${H}</span>`};if(G)Y=`
      <div class="detail-form-preview" id="weba-agg-form-preview">
        ${G.html}
      </div>
      ${F4(X,G.structure||W||{})}
    `;else if(z.length>0){z.forEach((N)=>{if(N.type==="calc")return;let F=X[N.key];if(F!==void 0)Q+=`
          <div class="detail-row">
            <div class="detail-key">${N.label||N.key}</div>
            <div class="detail-val-box">${M(F)}</div>
          </div>
        `});let H=new Set(z.map((N)=>N.key)),I=!1;for(let N in X){if(N.startsWith("@")||N.startsWith("_")||H.has(N))continue;if(!I)Q+='<div class="detail-group-header">Extra Information</div>',I=!0;Q+=`
        <div class="detail-row">
          <div class="detail-key">${N}</div>
          <div class="detail-val-box">${M(X[N])}</div>
        </div>
      `}}else for(let H in X){if(H.startsWith("@")||H.startsWith("_"))continue;Q+=`
        <div class="detail-row">
          <div class="detail-key">${H}</div>
          <div class="detail-val-box">${M(X[H])}</div>
        </div>
      `}q.innerHTML=`
    <div class="detail-overlay" id="weba-detail-overlay">
      <div class="detail-modal">
        <div class="detail-modal-header">
          <div class="header-info">
            <span class="file-icon">\uD83D\uDCC4</span>
            <div class="text">
              <h3>Record Details</h3>
              <p>${Z._filename||"Standalone Record"}</p>
            </div>
          </div>
          <button class="close-btn" id="weba-detail-close"></button>
        </div>
        <div class="detail-modal-body">
          ${Y||`<div class="form-view">${Q}</div>`}
          <details class="raw-data-section">
            <summary>View Raw Source Data (JSON)</summary>
            <pre>${JSON.stringify(X,null,2)}</pre>
            ${Z._sig?`<h4>Signature</h4><pre>${JSON.stringify(Z._sig,null,2)}</pre>`:""}
          </details>
        </div>
      </div>
    </div>
  `,document.body.style.overflow="hidden";let V=document.getElementById("weba-detail-overlay"),O=document.getElementById("weba-detail-close"),B=()=>{if(q)q.innerHTML="";document.body.style.overflow=""};V?.addEventListener("click",(H)=>{if(H.stopPropagation(),H.target===V)B()}),O?.addEventListener("click",(H)=>{H.stopPropagation(),B()});let E=document.getElementById("weba-agg-form-preview");if(E)j4(E,X)}window.showRecordDetail=T4;function L4(){let $=document.getElementById("weba-l2-keys");if(!$)return null;try{return JSON.parse($.textContent)}catch{return null}}function I4(){let $=document.getElementById("weba-agg-spec");if(!$)return null;try{return JSON.parse($.textContent)}catch{return null}}async function w4($,J){let Z=nZ($);if(Z){if(!J)return{source:"l2",plain:null};try{let X=null;if(J.recipient_x25519_private)X=G0(J.recipient_x25519_private);if(!X&&J.org_root_key);if(X){let Q=await x$(Z,X);return{source:"l2",plain:Q.layer2_plain,sig:Q.layer2_sig}}}catch(X){console.warn("L2 decryption failed",X)}}let q=iZ($);if(q)return{source:"jsonld",plain:q.credentialSubject?.answers||q};return{source:"unknown",plain:null}}function QX(){let $=document.getElementById("aggregator-root");if(!$)return;$.innerHTML=`
    <div class="agg-layout">
      <aside class="agg-sidebar">
        <div class="agg-brand">
          <div class="agg-brand-main">
            <div class="brand-logo">Agg</div>
            <h1>Web/A Aggregator</h1>
          </div>
          <div class="agg-build-stamp" id="weba-agg-build"></div>
        </div>

        <div class="agg-config-card">
          <div class="card-header">1. Data Source</div>
          <div class="agg-form-field">
            <label>Upload Submitted Forms</label>
            <div class="btn-grid">
              <button id="weba-agg-file-trigger" class="agg-btn-secondary">\uD83D\uDCC4 Select Files</button>
              <button id="weba-agg-dir-trigger" class="agg-btn-secondary">\uD83D\uDCC1 Select Folder</button>
            </div>
            <input id="weba-agg-files" type="file" accept=".html" multiple style="display:none;" />
            <input id="weba-agg-dirs" type="file" webkitdirectory directory style="display:none;" />
            <p class="field-hint">Select files or an entire folder of HTML forms.</p>
          </div>

          <div class="agg-form-field">
            <label>Decryption Method</label>
            <div id="weba-agg-key-status" class="agg-status-chip">No keys detected</div>
            <div class="btn-group">
              <button id="weba-agg-passkey" class="agg-btn-small outline">\uD83D\uDD11 Use Passkey</button>
            </div>
            <p class="field-hint">Encryption is used for Layer 2 security.</p>
          </div>

          <div class="agg-form-field-row">
            <input id="weba-agg-include-json" type="checkbox" />
            <label for="weba-agg-include-json">Include JSON column in table</label>
          </div>
        </div>

        <div class="agg-actions-card">
          <button id="weba-agg-run" class="agg-btn-primary"> Run Aggregation</button>
          <div class="btn-grid">
            <button id="weba-agg-download" class="agg-btn-secondary" disabled>\uD83D\uDCE5 CSV</button>
            <button id="weba-agg-download-jsonl" class="agg-btn-secondary" disabled>\uD83D\uDCE5 JSONL</button>
          </div>
          <button id="weba-agg-clear" class="agg-btn-text">\uD83D\uDDD1 Clear Data</button>
          <div id="weba-agg-status" class="agg-status-message">Ready.</div>
        </div>
      </aside>

      <main class="agg-main">
        <div id="weba-agg-results" class="agg-results is-hidden">
          <div id="weba-agg-dashboard" class="agg-dashboard"></div>
          <div id="weba-agg-output" class="agg-output"></div>
        </div>
      </main>
    </div>

    <div id="weba-agg-detail"></div>

    <style>
      :root {
        --agg-primary: #2563eb;
        --agg-bg: #f8fafc;
        --agg-card-bg: #ffffff;
        --agg-text: #1e293b;
        --agg-text-dim: #64748b;
        --agg-border: #e2e8f0;
      }

      .agg-layout { display: flex; min-height: 80vh; gap: 24px; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; color: var(--agg-text); }
      .agg-sidebar { width: 320px; flex-shrink: 0; display: flex; flex-direction: column; gap: 20px; }
      .agg-main { flex: 1; display: flex; flex-direction: column; gap: 24px; }

      .agg-brand { padding: 12px 0; display: flex; align-items: center; justify-content: space-between; gap: 12px; }
      .agg-brand-main { display: flex; align-items: center; gap: 12px; }
      .brand-logo { background: var(--agg-primary); color: white; width: 40px; height: 40px; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 0.8rem; }
      .agg-brand h1 { font-size: 1.25rem; font-weight: 700; margin: 0; }
      .agg-build-stamp { font-size: 0.65rem; color: var(--agg-text-dim); padding: 2px 8px; border-radius: 999px; border: 1px solid var(--agg-border); background: #f1f5f9; white-space: nowrap; }

      .agg-config-card, .agg-actions-card { background: var(--agg-card-bg); border: 1px solid var(--agg-border); border-radius: 12px; padding: 20px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
      .card-header { font-size: 0.85rem; font-weight: 600; text-transform: uppercase; color: var(--agg-text-dim); margin-bottom: 16px; border-bottom: 1px solid var(--agg-border); padding-bottom: 8px; }

      .agg-form-field { margin-bottom: 16px; }
      .agg-form-field label { display: block; font-size: 0.9rem; font-weight: 600; margin-bottom: 6px; }
      .agg-form-field input[type="file"] { width: 100%; font-size: 0.85rem; }
      .field-hint { font-size: 0.75rem; color: var(--agg-text-dim); margin: 4px 0 0; }

      .agg-form-field-row { display: flex; align-items: center; gap: 8px; margin-top: 12px; }
      .agg-form-field-row label { font-size: 0.85rem; cursor: pointer; }

      .agg-status-chip { background: #f1f5f9; padding: 4px 10px; border-radius: 20px; font-size: 0.75rem; color: var(--agg-text-dim); display: inline-block; margin-bottom: 8px; }
      .agg-status-chip.ready { background: #dcfce7; color: #166534; }

      .btn-group { display: flex; gap: 8px; }
      .btn-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
      
      .agg-btn-primary { background: var(--agg-primary); color: white; border: none; padding: 12px; border-radius: 8px; font-weight: 600; cursor: pointer; width: 100%; margin-bottom: 12px; transition: opacity 0.2s; }
      .agg-btn-primary:active { opacity: 0.8; }
      
      .agg-btn-secondary { background: white; border: 1px solid var(--agg-border); color: var(--agg-text); padding: 8px; border-radius: 8px; font-size: 0.85rem; cursor: pointer; }
      .agg-btn-secondary:disabled { opacity: 0.5; cursor: not-allowed; }
      
      .agg-btn-small { padding: 4px 12px; border-radius: 6px; font-size: 0.8rem; cursor: pointer; }
      .agg-btn-small.outline { background: white; border: 1px solid var(--agg-primary); color: var(--agg-primary); }

      .agg-btn-text { background: none; border: none; color: #ef4444; font-size: 0.85rem; padding: 8px; cursor: pointer; width: 100%; margin-top: 12px; }

      .agg-status-message { font-size: 0.85rem; color: var(--agg-text-dim); text-align: center; margin-top: 12px; padding-top: 12px; border-top: 1px solid var(--agg-border); }

      .agg-results.is-hidden { display: none; }

      /* Dashboard */
      .dashboard-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 16px; }
      .metric-card { background: white; border: 1px solid var(--agg-border); border-radius: 12px; padding: 16px; display: flex; flex-direction: column; gap: 4px; border-left: 4px solid var(--agg-primary); }
      .metric-card label { font-size: 0.75rem; color: var(--agg-text-dim); font-weight: 600; text-transform: uppercase; }
      .metric-card .value { font-size: 1.5rem; font-weight: 700; color: var(--agg-text); }

      /* Charts */
      .chart-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(360px, 1fr)); gap: 20px; margin-top: 24px; }
      .chart-card { background: white; border: 1px solid var(--agg-border); border-radius: 12px; padding: 20px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
      .chart-card h4 { margin: 0 0 16px 0; font-size: 0.95rem; font-weight: 700; color: var(--agg-text); border-bottom: 2px solid #f1f5f9; padding-bottom: 10px; }
      .chart-bars { display: flex; flex-direction: column; gap: 12px; }
      .chart-bar-row { display: flex; align-items: center; gap: 12px; font-size: 0.85rem; }
      .chart-bar-label { width: 120px; text-overflow: ellipsis; overflow: hidden; white-space: nowrap; font-weight: 500; }
      .chart-bar-track { flex: 1; height: 12px; background: #f1f5f9; border-radius: 6px; overflow: hidden; }
      .chart-bar-fill { height: 100%; background: var(--agg-primary); border-radius: 6px; }
      .chart-bar-value { width: 30px; text-align: right; font-weight: 700; color: var(--agg-text-dim); }

      /* Results Styling */
      .agg-section-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
      .count-badge { background: var(--agg-primary); color: white; padding: 2px 8px; border-radius: 12px; font-size: 0.75rem; }

      .agg-table-container { background: white; border: 1px solid var(--agg-border); border-radius: 12px; overflow: auto; box-shadow: 0 1px 3px rgba(0,0,0,0.05); max-height: 500px; }
      .agg-table { width: 100%; border-collapse: collapse; font-size: 0.9rem; text-align: left; }
      .agg-table th { background: #f8fafc; padding: 12px; border-bottom: 1px solid var(--agg-border); font-weight: 600; color: var(--agg-text-dim); position: sticky; top: 0; }
      .agg-table td { padding: 12px; border-bottom: 1px solid var(--agg-border); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 200px; }
      .agg-table tr:hover { background: #f1f5f9; cursor: pointer; }

      .agg-empty-state { text-align: center; padding: 48px; color: var(--agg-text-dim); background: white; border: 2px dashed var(--agg-border); border-radius: 12px; }
      .agg-empty-state .icon { font-size: 2rem; margin-bottom: 12px; }

      /* Detail Modal Overhaul */
      .detail-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(15, 23, 42, 0.75); backdrop-filter: blur(4px); display: flex; align-items: flex-end; justify-content: center; z-index: 10000; }
      @media (min-width: 768px) { .detail-overlay { align-items: center; } }

      .detail-modal { background: white; width: 100%; max-width: 720px; border-radius: 20px 20px 0 0; display: flex; flex-direction: column; max-height: 94vh; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25); animation: slideUp 0.3s ease-out; }
      @media (min-width: 768px) { .detail-modal { border-radius: 16px; max-height: 85vh; } }

      @keyframes slideUp { from { transform: translateY(100px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

      .detail-modal-header { padding: 16px 24px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center; flex-shrink: 0; }
      .header-info { display: flex; gap: 12px; align-items: center; }
      .file-icon { font-size: 1.5rem; }
      .header-info h3 { margin: 0; font-size: 1.1rem; }
      .header-info p { margin: 0; font-size: 0.8rem; color: var(--agg-text-dim); }
      .close-btn { border: none; background: #f1f5f9; width: 32px; height: 32px; border-radius: 50%; font-size: 1rem; cursor: pointer; color: #64748b; }

      .detail-modal-body { padding: 24px; overflow-y: auto; flex: 1; }
      
      .form-view { display: flex; flex-direction: column; gap: 16px; }
      .detail-group-header { font-size: 0.8rem; font-weight: 700; color: var(--agg-primary); text-transform: uppercase; background: #eff6ff; padding: 4px 12px; border-radius: 4px; margin-top: 12px; }
      
      .detail-row { display: grid; grid-template-columns: 140px 1fr; gap: 16px; border-bottom: 1px solid #f1f5f9; padding-bottom: 12px; align-items: flex-start; }
      .detail-key { font-size: 0.85rem; font-weight: 600; color: #64748b; padding-top: 2px; }
      
      .val-null { color: #cbd5e1; font-family: monospace; }
      .val-bool.true { color: #16a34a; font-weight: bold; }
      .val-bool.false { color: #dc2626; font-weight: bold; }
      .val-text { line-height: 1.5; color: #0f172a; }
      .val-json { font-size: 0.8rem; background: #f8fafc; padding: 8px; border-radius: 6px; border: 1px solid #e2e8f0; margin: 0; }
      
      .raw-data-section { margin-top: 32px; border-top: 1px solid #e2e8f0; padding-top: 20px; }
      .raw-data-section summary { font-size: 0.85rem; font-weight: 600; cursor: pointer; color: var(--agg-text-dim); }
      .raw-data-section pre { margin-top: 12px; font-size: 0.75rem; background: #1e293b; color: #e2e8f0; padding: 12px; border-radius: 8px; overflow-x: auto; }

      .detail-form-preview { background: #ffffff; border: 1px solid #e2e8f0; border-radius: 12px; padding: 16px; }
      .detail-form-preview .form-row { margin-bottom: 16px; }
      .detail-form-preview .form-label { font-weight: 600; margin-bottom: 6px; display: block; }
      .detail-form-preview .form-input { width: 100%; padding: 8px 10px; border: 1px solid #cbd5f5; border-radius: 6px; background: #f8fafc; }
      .detail-form-preview .form-input.readonly { color: #0f172a; }
      .detail-form-preview .table-wrapper { overflow-x: auto; }
      .detail-form-preview table { border-collapse: collapse; width: 100%; font-size: 0.9rem; }
      .detail-form-preview th, .detail-form-preview td { border: 1px solid #e2e8f0; padding: 8px; text-align: left; }
      .detail-form-preview .remove-row-btn { display: none; }
      .detail-form-preview .tabs-nav { display: none; }
      .detail-form-preview .tab-content { display: block; }
      .detail-form-preview .form-toolbar { display: none; }
      .detail-form-preview .no-print { display: none; }
    </style>
  `;let J=$.querySelector("#weba-agg-files"),Z=$.querySelector("#weba-agg-dirs"),q=$.querySelector("#weba-agg-file-trigger"),X=$.querySelector("#weba-agg-dir-trigger"),Q=$.querySelector("#weba-agg-status"),G=$.querySelector("#weba-agg-output"),Y=$.querySelector("#weba-agg-dashboard"),U=$.querySelector("#weba-agg-results"),z=$.querySelector("#weba-agg-include-json"),W=$.querySelector("#weba-agg-run"),M=$.querySelector("#weba-agg-download"),V=$.querySelector("#weba-agg-download-jsonl"),O=$.querySelector("#weba-agg-key-status"),B=$.querySelector("#weba-agg-passkey"),E=$.querySelector("#weba-agg-clear"),H=$.querySelector("#weba-agg-build"),I="",N="",F=[],f=null,k=L4(),g=I4();if(O)O.textContent=k?.recipient_kid?`Loaded (${k.recipient_kid})`:k?"Loaded":"No keys detected",O.classList.toggle("ready",!!k);if(g?.export?.jsonl===!1&&V)V.disabled=!0;if(H)H.textContent=N4(dJ),H.title=dJ?`Built at ${dJ}`:"Build time not available";let y=(T)=>{if(!U)return;U.classList.toggle("is-hidden",!T)};B?.addEventListener("click",async()=>{try{if(!S0.getPublicKey()){if(!await S0.register())return}alert("Please authenticate with your Passkey to decrypt.");let T=new Uint8Array(32),S=await S0.derivePrf(T);if(!S)throw new Error("PRF not supported or enabled on this key, or authentication failed.");if(f={recipient_x25519_private:N0(vZ(S).privateKey)},B.textContent=" Passkey Active",B.disabled=!0,O)O.textContent="Passkey Enabled",O.classList.add("ready");if(J?.files&&J.files.length>0||Z?.files&&Z.files.length>0)w()}catch(T){console.error(T),alert("Passkey error: "+T.message)}}),q?.addEventListener("click",()=>J?.click()),X?.addEventListener("click",()=>Z?.click()),J?.addEventListener("change",()=>w()),Z?.addEventListener("change",()=>w());let w=async()=>{let T=J?.files?Array.from(J.files):[],S=Z?.files?Array.from(Z.files):[],x=[...T,...S].filter((m)=>m.name.toLowerCase().endsWith(".html")&&!m.name.startsWith("."));if(!(x.length>0)){if(Q)Q.textContent="Select HTML files first.";y(!1);return}if(Q)Q.textContent="Processing...";if(M)M.disabled=!0;if(V)V.disabled=!0;y(!0);let D=$.querySelector(".agg-brand h1");F=[];let L=[],C=new Set(["_filename"]),j=0,A=0,v=f||k;if(D)D.innerHTML='Web/A Aggregator <span style="font-size:0.75rem; background:#10b981; color:white; padding:2px 8px; border-radius:4px; margin-left:8px; vertical-align:middle;">REAL DATA</span>';console.log(`Running aggregation on ${x.length} files...`);for(let m of x)try{let p=await m.text(),U0=await w4(p,v);if(U0.source!=="unknown"&&U0.plain){F.push({filename:m.name,plain:U0.plain,sig:U0.sig});let i0=rZ({plain:U0.plain,filename:m.name,includeJson:!!z?.checked,sig:U0.sig,omitKey:(I0)=>I0.startsWith("@")});i0.keys.forEach((I0)=>C.add(I0)),L.push({...i0.row,_raw:U0.plain,_sig:U0.sig}),j+=1}else console.warn(`Could not extract from ${m.name}`),A+=1}catch(p){console.error(`Error processing ${m.name}`,p),A+=1}let _=Array.from(C).sort((m,p)=>{if(m==="_filename")return-1;if(p==="_filename")return 1;return m.localeCompare(p)});if(I=sZ(L,_),M)M.disabled=L.length===0;let h=g?.export?.jsonl!==!1;if(N=F.map((m)=>JSON.stringify({_filename:m.filename,_l2_sig:m.sig??null,...m.plain})).join(`
`),V)V.disabled=F.length===0||!h;if(Q)Q.textContent=`Completed. Processed ${j} entries. Errors: ${A}.`;if(Y)H4(Y,g,F);if(G)B4(G,L,_)};E?.addEventListener("click",()=>{if(F=[],I="",N="",J)J.value="";if(Z)Z.value="";if(Q)Q.textContent="Data cleared.";if(M)M.disabled=!0;if(V)V.disabled=!0;if(Y)Y.innerHTML="";if(G)G.innerHTML="";y(!1),window._aggRows=[]}),W?.addEventListener("click",()=>{w().catch((T)=>{if(Q)Q.textContent="Failed to aggregate.";console.error(T)})}),M?.addEventListener("click",()=>{if(!I)return;let T=new Blob([I],{type:"text/csv;charset=utf-8"}),S=URL.createObjectURL(T),x=document.createElement("a");x.href=S,x.download="weba-aggregated.csv",x.click(),URL.revokeObjectURL(S)}),V?.addEventListener("click",()=>{if(!N)return;let T=new Blob([N],{type:"application/x-jsonlines;charset=utf-8"}),S=URL.createObjectURL(T),x=document.createElement("a");x.href=S,x.download="weba-aggregated.jsonl",x.click(),URL.revokeObjectURL(S)})}function GX(){console.log("Web/A Runtime Booting...");let $=new l$,J=new PJ,Z=new AJ($,J),q=window,X=document.getElementById("weba-structure");if(X?.textContent)try{q.generatedJsonStructure=JSON.parse(X.textContent)}catch(Y){console.warn("Failed to parse weba structure JSON",Y)}let Q=yZ();if(Q)q.webaL2Config=Q;q.saveDraft=()=>J.saveDraft(),q.submitDocument=()=>J.submitDocument(),q.signAndDownload=()=>J.signAndDownload(),q.clearData=()=>J.clearData(),q.removeTableRow=(Y)=>Z.removeTableRow(Y),q.addTableRow=(Y,U)=>Z.addTableRow(Y,U),q.switchTab=(Y,U)=>Z.switchTab(Y,U),q.recalculate=()=>$.recalculate(),q.escapeHtml=(Y)=>{if(!Y)return"";let U={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return Y.toString().replace(/[&<>"']/g,(z)=>U[z]||z)},J.restoreFromLS(),Z.applyI18n(),Z.initTables(),$.recalculate(),pZ(),dZ(),QX();let G;document.addEventListener("input",(Y)=>{let U=Y.target;if(Y.isTrusted)U.dataset.dirty="true";let z=U.dataset.baseKey||U.dataset.jsonPath;if(z)(U.closest("tr")||document).querySelectorAll(`[data-copy-from="${z}"]`).forEach((V)=>{if(!V.dataset.dirty){if(V.value!==U.value)V.value=U.value,V.dispatchEvent(new Event("input"))}});$.recalculate(),J.updateJsonLd(),clearTimeout(G),G=setTimeout(()=>J.saveToLS(),1000)}),console.log("Web/A Runtime Ready.")}class iJ{suggestionsVisible=!1;activeSearchInput=null;globalBox=null;constructor(){}init(){console.log("Initializing Search Engine (Bundle)...");let $=window;if($.generatedJsonStructure&&$.generatedJsonStructure.masterData){let J=Object.keys($.generatedJsonStructure.masterData);console.log("Master Data Keys available:",J.join(", "))}this.setupEventDelegation()}normalize($){if(!$)return"";let J=$.toString().toLowerCase();return J=J.replace(/[---]/g,(Z)=>{return String.fromCharCode(Z.charCodeAt(0)-65248)}),J=J.replace(/[-]/g,(Z)=>String.fromCharCode(Z.charCodeAt(0)-65248)),J.trim()}clean($){if(!$)return"";let J=this.normalize($);return J=J.replace(/(|||||npo||)/g,""),J=J.replace(/(\(\)|\(\)|\(\))/g,""),J.trim()}toIndex($){let J=parseInt($||"",10);return Number.isFinite(J)?J-1:-1}getGlobalBox(){if(!this.globalBox){if(this.globalBox=document.getElementById("web-a-search-suggestions"),!this.globalBox)this.globalBox=document.createElement("div"),this.globalBox.id="web-a-search-suggestions",this.globalBox.className="search-suggestions",Object.assign(this.globalBox.style,{display:"none",position:"absolute",background:"white",border:"1px solid #ccc",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",zIndex:"9999",maxHeight:"200px",overflowY:"auto",borderRadius:"4px"}),document.body.appendChild(this.globalBox)}return this.globalBox}hideSuggestions(){let $=this.getGlobalBox();if($)$.style.display="none";this.suggestionsVisible=!1,this.activeSearchInput=null}setupEventDelegation(){document.addEventListener("click",($)=>{if(this.suggestionsVisible&&!$.target.closest("#web-a-search-suggestions")&&$.target!==this.activeSearchInput)this.hideSuggestions()}),document.addEventListener("scroll",()=>{if(this.suggestionsVisible)this.hideSuggestions()},!0),document.body.addEventListener("input",($)=>{if($.target.classList.contains("search-input"))this.handleSearchInput($.target)}),document.body.addEventListener("click",($)=>{if($.target.classList.contains("suggestion-item"))this.handleSelection($.target)})}handleSearchInput($){this.activeSearchInput=$;let J=window,Z=$.dataset.masterSrc,q=$.dataset.suggestSource;if(!Z&&!q)return;let X=this.toIndex($.dataset.masterLabelIndex),Q=this.toIndex($.dataset.masterValueIndex),G=$.value;if(!G){this.hideSuggestions();return}let Y=[],U=this.normalize(G);if(q==="column"){let z=$.dataset.baseKey,W=$.closest("table");if(W&&z){let M=new Set;W.querySelectorAll(`[data-base-key="${z}"]`).forEach((V)=>{if(V===$)return;let O=V.value;if(O&&this.normalize(O).includes(U)){if(!M.has(O))M.add(O),Y.push({val:O,row:[O],label:O,score:10})}})}}else if(Z){let z=J.generatedJsonStructure.masterData;if(!z||!z[Z])return;z[Z].forEach((M,V)=>{if(V===0)return;if(M.some((B)=>this.normalize(B||"").includes(U))){let B=X>=0?M[X]||"":"",E=Q>=0?M[Q]||"":"",H=Q>=0?E:X>=0?B:M[1]||M[0]||"";Y.push({val:H,row:M,label:B,score:10,idx:V})}})}this.renderSuggestions($,Y,X)}renderSuggestions($,J,Z){if(J.length===0){this.hideSuggestions();return}let q=window,X=J.slice(0,10),Q="";X.forEach((W)=>{let M=q.escapeHtml(JSON.stringify(W.row)),V=Z>=0?W.label||W.row.join(" : "):W.row.join(" : ");Q+=`<div class="suggestion-item" data-val="${q.escapeHtml(W.val)}" data-row="${M}" style="padding:8px; cursor:pointer; border-bottom:1px solid #eee; font-size:14px; color:#333;">${q.escapeHtml(V)}</div>`});let G=this.getGlobalBox();G.innerHTML=Q;let Y=$.getBoundingClientRect(),U=window.scrollY||document.documentElement.scrollTop,z=window.scrollX||document.documentElement.scrollLeft;G.style.width=Math.max(Y.width,200)+"px",G.style.left=Y.left+z+"px",G.style.top=Y.bottom+U+"px",G.querySelectorAll(".suggestion-item").forEach((W)=>{W.onmouseenter=()=>W.style.background="#f0f8ff",W.onmouseleave=()=>W.style.background="white"}),G.style.display="block",this.suggestionsVisible=!0}handleSelection($){if(!this.activeSearchInput)return;let J=window,Z=this.activeSearchInput,q=$.dataset.val||"",X=$.dataset.row||"[]";try{let Q=JSON.parse(X),G=Z.dataset.masterSrc,Y=G?J.generatedJsonStructure.masterData[G][0]:[],U=!1;if(Y.length>0&&Q.length>0){let z=Z.closest("tr");if(z){let W=Array.from(z.querySelectorAll("input, select, textarea"));Y.forEach((M,V)=>{if(!M)return;let O=Q[V];this.fillField(W,M,O,Z,()=>{U=!0})})}}if(!U)Z.value=q,Z.dispatchEvent(new Event("input",{bubbles:!0}))}catch(Q){console.error(Q)}this.hideSuggestions()}fillField($,J,Z,q,X){let Q=this.normalize(J),G=$.find((Y)=>{let U=Y.dataset.baseKey||Y.dataset.jsonPath,z=this.normalize(Y.getAttribute("placeholder")||"");return U&&this.normalize(U)===Q||z===Q});if(G){if(G.value=Z||"",G.dispatchEvent(new Event("input",{bubbles:!0})),G===q)X()}}}var P4=BigInt(0),a8=BigInt(1),A4=BigInt(2),E4=BigInt(7),f4=BigInt(256),S4=BigInt(113),WX=[],zX=[],MX=[];for(let $=0,J=a8,Z=1,q=0;$<24;$++){[Z,q]=[q,(2*Z+3*q)%5],WX.push(2*(5*q+Z)),zX.push(($+1)*($+2)/2%64);let X=P4;for(let Q=0;Q<7;Q++)if(J=(J<<a8^(J>>E4)*S4)%f4,J&A4)X^=a8<<(a8<<BigInt(Q))-a8;MX.push(X)}var DX=Y$(MX,!0),x4=DX[0],v4=DX[1],YX=($,J,Z)=>Z>32?N9($,J,Z):K9($,J,Z),UX=($,J,Z)=>Z>32?H9($,J,Z):O9($,J,Z);function k4($,J=24){let Z=new Uint32Array(10);for(let q=24-J;q<24;q++){for(let G=0;G<10;G++)Z[G]=$[G]^$[G+10]^$[G+20]^$[G+30]^$[G+40];for(let G=0;G<10;G+=2){let Y=(G+8)%10,U=(G+2)%10,z=Z[U],W=Z[U+1],M=YX(z,W,1)^Z[Y],V=UX(z,W,1)^Z[Y+1];for(let O=0;O<50;O+=10)$[G+O]^=M,$[G+O+1]^=V}let X=$[2],Q=$[3];for(let G=0;G<24;G++){let Y=zX[G],U=YX(X,Q,Y),z=UX(X,Q,Y),W=WX[G];X=$[W],Q=$[W+1],$[W]=U,$[W+1]=z}for(let G=0;G<50;G+=10){for(let Y=0;Y<10;Y++)Z[Y]=$[G+Y];for(let Y=0;Y<10;Y++)$[G+Y]^=~Z[(Y+2)%10]&Z[(Y+4)%10]}$[0]^=x4[q],$[1]^=v4[q]}B0(Z)}class b${state;pos=0;posOut=0;finished=!1;state32;destroyed=!1;blockLen;suffix;outputLen;enableXOF=!1;rounds;constructor($,J,Z,q=!1,X=24){if(this.blockLen=$,this.suffix=J,this.outputLen=Z,this.enableXOF=q,this.rounds=X,T0(Z,"outputLen"),!(0<$&&$<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=q$(this.state)}clone(){return this._cloneInto()}keccak(){c$(this.state32),k4(this.state32,this.rounds),c$(this.state32),this.posOut=0,this.pos=0}update($){b0(this),l($);let{blockLen:J,state:Z}=this,q=$.length;for(let X=0;X<q;){let Q=Math.min(J-this.pos,q-X);for(let G=0;G<Q;G++)Z[this.pos++]^=$[X++];if(this.pos===J)this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:$,suffix:J,pos:Z,blockLen:q}=this;if($[Z]^=J,(J&128)!==0&&Z===q-1)this.keccak();$[q-1]^=128,this.keccak()}writeInto($){b0(this,!1),l($),this.finish();let J=this.state,{blockLen:Z}=this;for(let q=0,X=$.length;q<X;){if(this.posOut>=Z)this.keccak();let Q=Math.min(Z-this.posOut,X-q);$.set(J.subarray(this.posOut,this.posOut+Q),q),this.posOut+=Q,q+=Q}return $}xofInto($){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto($)}xof($){return T0($),this.xofInto(new Uint8Array($))}digestInto($){if(Z$($,this),this.finished)throw new Error("digest() was already called");return this.writeInto($),this.destroy(),$}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,B0(this.state)}_cloneInto($){let{blockLen:J,suffix:Z,outputLen:q,rounds:X,enableXOF:Q}=this;return $||=new b$(J,Z,q,Q,X),$.state32.set(this.state32),$.pos=this.pos,$.posOut=this.posOut,$.finished=this.finished,$.rounds=X,$.suffix=Z,$.outputLen=q,$.enableXOF=Q,$.destroyed=this.destroyed,$}}var VX=($,J,Z,q={})=>R8(()=>new b$(J,$,Z),q);var KX=VX(6,136,32,o0(8));var OX=VX(6,72,64,o0(10));var NX=($,J,Z,q={})=>R8((X={})=>new b$(J,$,X.dkLen===void 0?Z:X.dkLen,!0),q),HX=NX(31,168,16,o0(11)),h$=NX(31,136,32,o0(12));function nJ($){if(!Number.isSafeInteger($)||$<0||$>4294967295)throw new Error("wrong u32 integer:"+$);return $}function RX($){return nJ($),($&$-1)===0&&$!==0}function oJ($,J){nJ($);let Z=0;for(let q=0;q<J;q++,$>>>=1)Z=Z<<1|$&1;return Z}function CX($){return nJ($),31-Math.clz32($)}function BX($){let J=$.length;if(J<2||!RX(J))throw new Error("n must be a power of 2 and greater than 1. Got "+J);let Z=CX(J);for(let q=0;q<J;q++){let X=oJ(q,Z);if(q<X){let Q=$[q];$[q]=$[X],$[X]=Q}}return $}var rJ=($,J)=>{let{N:Z,roots:q,dit:X,invertButterflies:Q=!1,skipStages:G=0,brp:Y=!0}=J,U=CX(Z);if(!RX(Z))throw new Error("FFT: Polynomial size should be power of two");let z=X!==Q;return(W)=>{if(W.length!==Z)throw new Error("FFT: wrong Polynomial length");if(X&&Y)BX(W);for(let M=0,V=1;M<U-G;M++){let O=X?M+1+G:U-M,B=1<<O,E=B>>1,H=Z>>O;for(let I=0;I<Z;I+=B)for(let N=0,F=V++;N<E;N++){let f=Q?X?Z-F:F:N*H,k=I+N,g=I+N+E,y=q[f],w=W[g],T=W[k];if(z){let S=$.mul(w,y);W[k]=$.add(T,S),W[g]=$.sub(T,S)}else if(Q)W[k]=$.add(w,T),W[g]=$.mul($.sub(w,T),y);else W[k]=$.add(T,w),W[g]=$.mul($.sub(T,w),y)}}if(!X&&Y)BX(W);return W}};/*! noble-post-quantum - MIT License (c) 2024 Paul Miller (paulmillr.com) */var sJ=Q8;function u$($,J){if($.length!==J.length)return!1;let Z=0;for(let q=0;q<$.length;q++)Z|=$[q]^J[q];return Z===0}function FX($){return Uint8Array.from($)}function t8($,...J){let Z=(X)=>typeof X==="number"?X:X.bytesLen,q=J.reduce((X,Q)=>X+Z(Q),0);return{bytesLen:q,encode:(X)=>{let Q=new Uint8Array(q);for(let G=0,Y=0;G<J.length;G++){let U=J[G],z=Z(U),W=typeof U==="number"?X[G]:U.encode(X[G]);if(l(W,z,$),Q.set(W,Y),typeof U!=="number")W.fill(0);Y+=z}return Q},decode:(X)=>{l(X,q,$);let Q=[];for(let G of J){let Y=Z(G),U=X.subarray(0,Y);Q.push(typeof G==="number"?U:G.decode(U)),X=X.subarray(Y)}return Q}}}function p$($,J){let Z=J*$.bytesLen;return{bytesLen:Z,encode:(q)=>{if(q.length!==J)throw new Error(`vecCoder.encode: wrong length=${q.length}. Expected: ${J}`);let X=new Uint8Array(Z);for(let Q=0,G=0;Q<q.length;Q++){let Y=$.encode(q[Q]);X.set(Y,G),Y.fill(0),G+=Y.length}return X},decode:(q)=>{l(q,Z);let X=[];for(let Q=0;Q<q.length;Q+=$.bytesLen)X.push($.decode(q.subarray(Q,Q+$.bytesLen)));return X}}}function E0(...$){for(let J of $)if(Array.isArray(J))for(let Z of J)Z.fill(0);else J.fill(0)}function aJ($){return(1<<$)-1}var n7=Uint8Array.of();/*! noble-post-quantum - MIT License (c) 2024 Paul Miller (paulmillr.com) */var jX=($)=>{let{newPoly:J,N:Z,Q:q,F:X,ROOT_OF_UNITY:Q,brvBits:G,isKyber:Y}=$,U=(N,F=q)=>{let f=N%F|0;return(f>=0?f|0:F+f|0)|0},z=(N,F=q)=>{let f=U(N,F)|0;return(f>F>>1?f-F|0:f)|0};function W(){let N=J(Z);for(let F=0;F<Z;F++){let f=oJ(F,G),k=BigInt(Q)**BigInt(f)%BigInt(q);N[F]=Number(k)|0}return N}let M=W(),V={add:(N,F)=>U((N|0)+(F|0))|0,sub:(N,F)=>U((N|0)-(F|0))|0,mul:(N,F)=>U((N|0)*(F|0))|0,inv:(N)=>{throw new Error("not implemented")}},O={N:Z,roots:M,invertButterflies:!0,skipStages:Y?1:0,brp:!1},B=rJ(V,{dit:!1,...O}),E=rJ(V,{dit:!0,...O});return{mod:U,smod:z,nttZetas:M,NTT:{encode:(N)=>{return B(N)},decode:(N)=>{E(N);for(let F=0;F<N.length;F++)N[F]=U(X*N[F]);return N}},bitsCoder:(N,F)=>{let f=aJ(N),k=N*(Z/8);return{bytesLen:k,encode:(g)=>{let y=new Uint8Array(k);for(let w=0,T=0,S=0,x=0;w<g.length;w++){T|=(F.encode(g[w])&f)<<S,S+=N;for(;S>=8;S-=8,T>>=8)y[x++]=T&aJ(S)}return y},decode:(g)=>{let y=J(Z);for(let w=0,T=0,S=0,x=0;w<g.length;w++){T|=g[w]<<S,S+=8;for(;S>=N;S-=N,T>>=N)y[x++]=F.decode(T&f)}return y}}}}},_4=($)=>(J,Z)=>{if(!Z)Z=$.blockLen;let q=new Uint8Array(J.length+2);q.set(J);let X=J.length,Q=new Uint8Array(Z),G=$.create({}),Y=0,U=0;return{stats:()=>({calls:Y,xofs:U}),get:(z,W)=>{return q[X+0]=z,q[X+1]=W,G.destroy(),G=$.create({}).update(q),Y++,()=>{return U++,G.xofInto(Q)}},clean:()=>{G.destroy(),E0(Q,q)}}},TX=_4(HX);/*! noble-post-quantum - MIT License (c) 2024 Paul Miller (paulmillr.com) */var V0=256,c0=3329,g4=3303,m4=17,{mod:J$,nttZetas:y4,NTT:K8,bitsCoder:b4}=jX({N:V0,Q:c0,F:g4,ROOT_OF_UNITY:m4,newPoly:($)=>new Uint16Array($),brvBits:7,isKyber:!0}),tJ={512:{N:V0,Q:c0,K:2,ETA1:3,ETA2:2,du:10,dv:4,RBGstrength:128},768:{N:V0,Q:c0,K:3,ETA1:2,ETA2:2,du:10,dv:4,RBGstrength:192},1024:{N:V0,Q:c0,K:4,ETA1:2,ETA2:2,du:11,dv:5,RBGstrength:256}},h4=($)=>{if($>=12)return{encode:(Z)=>Z,decode:(Z)=>Z};let J=2**($-1);return{encode:(Z)=>((Z<<$)+c0/2)/c0,decode:(Z)=>Z*c0+J>>>$}},e8=($)=>b4($,h4($));function O8($,J){for(let Z=0;Z<V0;Z++)$[Z]=J$($[Z]+J[Z])}function u4($,J){for(let Z=0;Z<V0;Z++)$[Z]=J$($[Z]-J[Z])}function p4($,J,Z,q,X){let Q=J$(J*q*X+$*Z),G=J$($*q+J*Z);return{c0:Q,c1:G}}function d$($,J){for(let Z=0;Z<V0/2;Z++){let q=y4[64+(Z>>1)];if(Z&1)q=-q;let{c0:X,c1:Q}=p4($[2*Z+0],$[2*Z+1],J[2*Z+0],J[2*Z+1],q);$[2*Z+0]=X,$[2*Z+1]=Q}return $}function LX($){let J=new Uint16Array(V0);for(let Z=0;Z<V0;){let q=$();if(q.length%3)throw new Error("SampleNTT: unaligned block");for(let X=0;Z<V0&&X+3<=q.length;X+=3){let Q=(q[X+0]>>0|q[X+1]<<8)&4095,G=(q[X+1]>>4|q[X+2]<<4)&4095;if(Q<c0)J[Z++]=Q;if(Z<V0&&G<c0)J[Z++]=G}}return J}function $$($,J,Z,q){let X=$(q*V0/4,J,Z),Q=new Uint16Array(V0),G=q$(X),Y=0;for(let U=0,z=0,W=0,M=0;U<G.length;U++){let V=G[U];for(let O=0;O<32;O++)if(W+=V&1,V>>=1,Y+=1,Y===q)M=W,W=0;else if(Y===2*q)Q[z++]=J$(M-W),W=0,Y=0}if(Y)throw new Error(`sampleCBD: leftover bits: ${Y}`);return Q}var d4=($)=>{let{K:J,PRF:Z,XOF:q,HASH512:X,ETA1:Q,ETA2:G,du:Y,dv:U}=$,z=e8(1),W=e8(U),M=e8(Y),V=t8("publicKey",p$(e8(12),J),32),O=p$(e8(12),J),B=t8("ciphertext",p$(M,J),W),E=t8("seed",32,32);return{secretCoder:O,lengths:{secretKey:O.bytesLen,publicKey:V.bytesLen,cipherText:B.bytesLen},keygen:(H)=>{l(H,32,"seed");let I=new Uint8Array(33);I.set(H),I[32]=J;let N=X(I),[F,f]=E.decode(N),k=[],g=[];for(let T=0;T<J;T++)k.push(K8.encode($$(Z,f,T,Q)));let y=q(F);for(let T=0;T<J;T++){let S=K8.encode($$(Z,f,J+T,Q));for(let x=0;x<J;x++){let d=LX(y.get(x,T));O8(S,d$(d,k[x]))}g.push(S)}y.clean();let w={publicKey:V.encode([g,F]),secretKey:O.encode(k)};return E0(F,f,k,g,I,N),w},encrypt:(H,I,N)=>{let[F,f]=V.decode(H),k=[];for(let x=0;x<J;x++)k.push(K8.encode($$(Z,N,x,Q)));let g=q(f),y=new Uint16Array(V0),w=[];for(let x=0;x<J;x++){let d=$$(Z,N,J+x,G),D=new Uint16Array(V0);for(let L=0;L<J;L++){let C=LX(g.get(x,L));O8(D,d$(C,k[L]))}O8(d,K8.decode(D)),w.push(d),O8(y,d$(F[x],k[x])),E0(D)}g.clean();let T=$$(Z,N,2*J,G);O8(T,K8.decode(y));let S=z.decode(I);return O8(S,T),E0(F,k,y,T),B.encode([w,S])},decrypt:(H,I)=>{let[N,F]=B.decode(H),f=O.decode(I),k=new Uint16Array(V0);for(let g=0;g<J;g++)O8(k,d$(f[g],K8.encode(N[g])));return u4(F,K8.decode(k)),E0(k,f,N),z.encode(F)}}};function eJ($){let J=d4($),{HASH256:Z,HASH512:q,KDF:X}=$,{secretCoder:Q,lengths:G}=J,Y=t8("secretKey",G.secretKey,G.publicKey,32,32),U=32,z=64;return{info:{type:"ml-kem"},lengths:{...G,seed:64,msg:32,msgRand:32,secretKey:Y.bytesLen},keygen:(W=sJ(64))=>{l(W,64,"seed");let{publicKey:M,secretKey:V}=J.keygen(W.subarray(0,32)),O=Z(M),B=Y.encode([V,M,O,W.subarray(32)]);return E0(V,O),{publicKey:M,secretKey:B}},getPublicKey:(W)=>{let[M,V,O,B]=Y.decode(W);return Uint8Array.from(V)},encapsulate:(W,M=sJ(32))=>{l(W,G.publicKey,"publicKey"),l(M,32,"message");let V=W.subarray(0,384*$.K),O=Q.encode(Q.decode(FX(V)));if(!u$(O,V))throw E0(O),new Error("ML-KEM.encapsulate: wrong publicKey modulus");E0(O);let B=q.create().update(M).update(Z(W)).digest(),E=J.encrypt(W,M,B.subarray(32,64));return E0(B.subarray(32)),{cipherText:E,sharedSecret:B.subarray(0,32)}},decapsulate:(W,M)=>{l(M,Y.bytesLen,"secretKey"),l(W,G.cipherText,"cipherText");let V=Y.bytesLen-96,O=V+32,B=Z(M.subarray(V/2,O));if(!u$(B,M.subarray(O,O+32)))throw new Error("invalid secretKey: hash check failed");let[E,H,I,N]=Y.decode(M),F=J.decrypt(W,E),f=q.create().update(F).update(I).digest(),k=f.subarray(0,32),g=J.encrypt(H,F,f.subarray(32,64)),y=u$(W,g),w=X.create({dkLen:32}).update(N).update(W).digest();return E0(F,g,!y?k:w),y?k:w}}}function l4($,J,Z){return h$.create({dkLen:$}).update(J).update(new Uint8Array([Z])).digest()}var $9={HASH256:KX,HASH512:OX,KDF:h$,XOF:TX,PRF:l4},XY=eJ({...$9,...tJ[512]}),J9=eJ({...$9,...tJ[768]}),QY=eJ({...$9,...tJ[1024]});function IX(){return{kemId:"ML-KEM-768",encapsulate:($)=>{let{cipherText:J,sharedSecret:Z}=J9.encapsulate($);return{sharedSecret:Z,encapsulation:J}},decapsulate:($,J)=>{return J9.decapsulate(J,$)}}}function wX($){globalThis.webaPqcKem=$}wX(IX());var PX=new iJ;window.GlobalSearch=PX;GX();PX.init();
